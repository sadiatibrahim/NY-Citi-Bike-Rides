[0m21:38:26.144927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6f969ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6cfbe5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6cfbe530>]}


============================== 21:38:26.151316 | f12b03aa-cda2-4ea2-8b94-5a49ae27da41 ==============================
[0m21:38:26.151316 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:38:26.167085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:38:26.177391 [info ] [MainThread]: dbt version: 1.7.4
[0m21:38:26.193197 [info ] [MainThread]: python version: 3.10.14
[0m21:38:26.197278 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:38:26.201298 [info ] [MainThread]: os info: Linux-5.15.60-x86_64-with-glibc2.36
[0m21:38:29.116163 [info ] [MainThread]: Using profiles dir at /home/src/default_repo/dbt/dbt_citi_bikes
[0m21:38:29.120674 [info ] [MainThread]: Using profiles.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/profiles.yml
[0m21:38:29.125057 [info ] [MainThread]: Using dbt_project.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/dbt_project.yml
[0m21:38:29.139183 [info ] [MainThread]: adapter type: bigquery
[0m21:38:29.144037 [info ] [MainThread]: adapter version: 1.7.2
[0m21:38:29.148049 [info ] [MainThread]: Configuration:
[0m21:38:29.151694 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:38:29.155135 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m21:38:29.161441 [info ] [MainThread]: Required dependencies:
[0m21:38:29.166204 [debug] [MainThread]: Executing "git --help"
[0m21:38:29.178054 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:38:29.178841 [debug] [MainThread]: STDERR: "b''"
[0m21:38:29.184519 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:38:29.189269 [info ] [MainThread]: Connection:
[0m21:38:29.192991 [info ] [MainThread]:   method: service-account
[0m21:38:29.196439 [info ] [MainThread]:   database: virtual-aileron-412616
[0m21:38:29.200413 [info ] [MainThread]:   execution_project: virtual-aileron-412616
[0m21:38:29.206670 [info ] [MainThread]:   schema: nyc_citi_bike_rides
[0m21:38:29.210369 [info ] [MainThread]:   location: None
[0m21:38:29.214468 [info ] [MainThread]:   priority: None
[0m21:38:29.218513 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:38:29.221989 [info ] [MainThread]:   impersonate_service_account: None
[0m21:38:29.225410 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:38:29.228879 [info ] [MainThread]:   job_retries: 1
[0m21:38:29.232585 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:38:29.235922 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:38:29.239218 [info ] [MainThread]:   keyfile: $
[0m21:38:29.242860 [info ] [MainThread]:   timeout_seconds: None
[0m21:38:29.246885 [info ] [MainThread]:   refresh_token: None
[0m21:38:29.250593 [info ] [MainThread]:   client_id: None
[0m21:38:29.254358 [info ] [MainThread]:   token_uri: None
[0m21:38:29.257921 [info ] [MainThread]:   dataproc_region: None
[0m21:38:29.261739 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:38:29.265619 [info ] [MainThread]:   gcs_bucket: None
[0m21:38:29.270028 [info ] [MainThread]:   dataproc_batch: None
[0m21:38:29.274139 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:38:29.278548 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:38:29.282699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:29.288031 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '$''
[0m21:38:29.291800 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:38:29.296118 [info ] [MainThread]: [31m2 checks failed:[0m
[0m21:38:29.299464 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/src/default_repo/dbt/dbt_citi_bikes/dbt_project.yml> not found

[0m21:38:29.302936 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '$'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:38:29.306535 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 3.3115516, "process_user_time": 4.941669, "process_kernel_time": 0.693212, "process_mem_max_rss": "217504", "process_out_blocks": "416", "command_success": false, "process_in_blocks": "0"}
[0m21:38:29.310232 [debug] [MainThread]: Command `dbt debug` failed at 21:38:29.309953 after 3.32 seconds
[0m21:38:29.313878 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:38:29.317356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6f969ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6cfbe410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc582366b0>]}
[0m21:38:29.321196 [debug] [MainThread]: Flushing usage events
[0m21:40:49.913090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f632797ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f632517a4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f632517a440>]}


============================== 21:40:49.916926 | 4d87ab43-1fe7-4acf-954c-5dcb7758c4c9 ==============================
[0m21:40:49.916926 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:40:49.954697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:40:49.970397 [info ] [MainThread]: dbt version: 1.7.4
[0m21:40:49.980924 [info ] [MainThread]: python version: 3.10.14
[0m21:40:49.993279 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:40:49.997626 [info ] [MainThread]: os info: Linux-5.15.60-x86_64-with-glibc2.36
[0m21:40:51.747627 [info ] [MainThread]: Using profiles dir at /home/src/default_repo/dbt/dbt_citi_bikes
[0m21:40:51.751836 [info ] [MainThread]: Using profiles.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/profiles.yml
[0m21:40:51.755831 [info ] [MainThread]: Using dbt_project.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/dbt_project.yml
[0m21:40:51.760737 [info ] [MainThread]: adapter type: bigquery
[0m21:40:51.764179 [info ] [MainThread]: adapter version: 1.7.2
[0m21:40:51.771034 [info ] [MainThread]: Configuration:
[0m21:40:51.774637 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:40:51.778083 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m21:40:51.782238 [info ] [MainThread]: Required dependencies:
[0m21:40:51.785628 [debug] [MainThread]: Executing "git --help"
[0m21:40:51.796350 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:40:51.797068 [debug] [MainThread]: STDERR: "b''"
[0m21:40:51.801663 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:40:51.805147 [info ] [MainThread]: Connection:
[0m21:40:51.808759 [info ] [MainThread]:   method: service-account
[0m21:40:51.812162 [info ] [MainThread]:   database: virtual-aileron-412616
[0m21:40:51.815993 [info ] [MainThread]:   execution_project: virtual-aileron-412616
[0m21:40:51.819244 [info ] [MainThread]:   schema: nyc_citi_bike_rides
[0m21:40:51.822730 [info ] [MainThread]:   location: None
[0m21:40:51.826242 [info ] [MainThread]:   priority: None
[0m21:40:51.829687 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:40:51.833198 [info ] [MainThread]:   impersonate_service_account: None
[0m21:40:51.836807 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:40:51.840403 [info ] [MainThread]:   job_retries: 1
[0m21:40:51.848586 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:40:51.852838 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:40:51.856854 [info ] [MainThread]:   keyfile: $
[0m21:40:51.860364 [info ] [MainThread]:   timeout_seconds: None
[0m21:40:51.863939 [info ] [MainThread]:   refresh_token: None
[0m21:40:51.867601 [info ] [MainThread]:   client_id: None
[0m21:40:51.873718 [info ] [MainThread]:   token_uri: None
[0m21:40:51.880196 [info ] [MainThread]:   dataproc_region: None
[0m21:40:51.883655 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:40:51.886981 [info ] [MainThread]:   gcs_bucket: None
[0m21:40:51.890684 [info ] [MainThread]:   dataproc_batch: None
[0m21:40:51.894172 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:40:51.897743 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:40:51.901151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:51.904711 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '$''
[0m21:40:51.908513 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:40:51.912040 [info ] [MainThread]: [31m2 checks failed:[0m
[0m21:40:51.915321 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  dbt_project.yml does not parse to a dictionary


[0m21:40:51.918791 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '$'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:40:51.922705 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.0863922, "process_user_time": 4.778838, "process_kernel_time": 0.628899, "process_mem_max_rss": "217264", "process_out_blocks": "408", "command_success": false, "process_in_blocks": "0"}
[0m21:40:51.926560 [debug] [MainThread]: Command `dbt debug` failed at 21:40:51.926316 after 2.09 seconds
[0m21:40:51.929869 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:40:51.933928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f632797ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f631038a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f631038a2f0>]}
[0m21:40:51.937498 [debug] [MainThread]: Flushing usage events
[0m21:42:01.142474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca3bb3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca1206500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca12064a0>]}


============================== 21:42:01.146690 | 9f3d7bad-bb8e-4326-b809-4ede67db75e4 ==============================
[0m21:42:01.146690 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:42:01.150559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m21:42:01.155353 [error] [MainThread]: Encountered an error:
'NoneType' object is not subscriptable
[0m21:42:01.168418 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 515, in init
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/init.py", line 317, in run
    profile_name = self.get_profile_name_from_current_project()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/init.py", line 142, in get_profile_name_from_current_project
    return dbt_project["profile"]
TypeError: 'NoneType' object is not subscriptable

[0m21:42:01.173436 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 0.103450865, "process_user_time": 3.074088, "process_kernel_time": 0.214567, "process_mem_max_rss": "101880", "process_out_blocks": "40", "command_success": false, "process_in_blocks": "0"}
[0m21:42:01.177486 [debug] [MainThread]: Command `dbt init` failed at 21:42:01.177200 after 0.11 seconds
[0m21:42:01.181268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca3bb3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca12070a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca12068c0>]}
[0m21:42:01.185222 [debug] [MainThread]: Flushing usage events
[0m21:42:27.298948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe404fded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe3db5e5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe3db5e560>]}


============================== 21:42:27.302629 | cce3e355-af5f-4bc4-a83a-00cb9c71725b ==============================
[0m21:42:27.302629 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:42:27.307055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:42:27.310601 [info ] [MainThread]: dbt version: 1.7.4
[0m21:42:27.326483 [info ] [MainThread]: python version: 3.10.14
[0m21:42:27.347139 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:42:27.359610 [info ] [MainThread]: os info: Linux-5.15.60-x86_64-with-glibc2.36
[0m21:42:29.175267 [info ] [MainThread]: Using profiles dir at /home/src/default_repo/dbt/dbt_citi_bikes
[0m21:42:29.176039 [info ] [MainThread]: Using profiles.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/profiles.yml
[0m21:42:29.180752 [info ] [MainThread]: Using dbt_project.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/dbt_project.yml
[0m21:42:29.186711 [info ] [MainThread]: adapter type: bigquery
[0m21:42:29.191051 [info ] [MainThread]: adapter version: 1.7.2
[0m21:42:29.195936 [info ] [MainThread]: Configuration:
[0m21:42:29.199881 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:42:29.203324 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m21:42:29.207282 [info ] [MainThread]: Required dependencies:
[0m21:42:29.211154 [debug] [MainThread]: Executing "git --help"
[0m21:42:29.223997 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:42:29.224887 [debug] [MainThread]: STDERR: "b''"
[0m21:42:29.229271 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:42:29.233252 [info ] [MainThread]: Connection:
[0m21:42:29.237173 [info ] [MainThread]:   method: service-account
[0m21:42:29.241099 [info ] [MainThread]:   database: virtual-aileron-412616
[0m21:42:29.244903 [info ] [MainThread]:   execution_project: virtual-aileron-412616
[0m21:42:29.248400 [info ] [MainThread]:   schema: nyc_citi_bike_rides
[0m21:42:29.252480 [info ] [MainThread]:   location: None
[0m21:42:29.256496 [info ] [MainThread]:   priority: None
[0m21:42:29.260531 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:42:29.264865 [info ] [MainThread]:   impersonate_service_account: None
[0m21:42:29.269273 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:42:29.273799 [info ] [MainThread]:   job_retries: 1
[0m21:42:29.277854 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:42:29.281743 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:42:29.291115 [info ] [MainThread]:   keyfile: $
[0m21:42:29.295105 [info ] [MainThread]:   timeout_seconds: None
[0m21:42:29.298813 [info ] [MainThread]:   refresh_token: None
[0m21:42:29.302360 [info ] [MainThread]:   client_id: None
[0m21:42:29.306135 [info ] [MainThread]:   token_uri: None
[0m21:42:29.310252 [info ] [MainThread]:   dataproc_region: None
[0m21:42:29.314175 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:42:29.318000 [info ] [MainThread]:   gcs_bucket: None
[0m21:42:29.321601 [info ] [MainThread]:   dataproc_batch: None
[0m21:42:29.325569 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:42:29.329762 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:42:29.333446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:42:29.337479 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '$''
[0m21:42:29.341789 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:42:29.345776 [info ] [MainThread]: [31m2 checks failed:[0m
[0m21:42:29.349468 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  dbt_project.yml does not parse to a dictionary


[0m21:42:29.353663 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '$'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:42:29.358698 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.1291523, "process_user_time": 4.867627, "process_kernel_time": 0.622086, "process_mem_max_rss": "217712", "process_out_blocks": "416", "command_success": false, "process_in_blocks": "0"}
[0m21:42:29.363305 [debug] [MainThread]: Command `dbt debug` failed at 21:42:29.363033 after 2.13 seconds
[0m21:42:29.368962 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:42:29.372895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe404fded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe3dcc7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe28dd1210>]}
[0m21:42:29.377334 [debug] [MainThread]: Flushing usage events
[0m21:45:49.936195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1f3aded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1cbaa5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1cbaa590>]}


============================== 21:45:49.945173 | 2a111fd7-cc1e-4e60-b557-655b45886574 ==============================
[0m21:45:49.945173 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:45:49.984885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:50.024480 [info ] [MainThread]: dbt version: 1.7.4
[0m21:45:50.040326 [info ] [MainThread]: python version: 3.10.14
[0m21:45:50.049219 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:45:50.053241 [info ] [MainThread]: os info: Linux-5.15.60-x86_64-with-glibc2.36
[0m21:45:51.989939 [info ] [MainThread]: Using profiles dir at /home/src/default_repo/dbt/dbt_citi_bikes
[0m21:45:51.998362 [info ] [MainThread]: Using profiles.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/profiles.yml
[0m21:45:52.002859 [info ] [MainThread]: Using dbt_project.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/dbt_project.yml
[0m21:45:52.007136 [info ] [MainThread]: adapter type: bigquery
[0m21:45:52.010730 [info ] [MainThread]: adapter version: 1.7.2
[0m21:45:52.133199 [info ] [MainThread]: Configuration:
[0m21:45:52.137887 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:45:52.141326 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:45:52.145167 [info ] [MainThread]: Required dependencies:
[0m21:45:52.148607 [debug] [MainThread]: Executing "git --help"
[0m21:45:52.157999 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:45:52.158676 [debug] [MainThread]: STDERR: "b''"
[0m21:45:52.162788 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:45:52.166481 [info ] [MainThread]: Connection:
[0m21:45:52.170279 [info ] [MainThread]:   method: service-account
[0m21:45:52.174390 [info ] [MainThread]:   database: virtual-aileron-412616
[0m21:45:52.178086 [info ] [MainThread]:   execution_project: virtual-aileron-412616
[0m21:45:52.181587 [info ] [MainThread]:   schema: nyc_citi_bike_rides
[0m21:45:52.184866 [info ] [MainThread]:   location: None
[0m21:45:52.188705 [info ] [MainThread]:   priority: None
[0m21:45:52.192118 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:45:52.195351 [info ] [MainThread]:   impersonate_service_account: None
[0m21:45:52.198513 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:45:52.201961 [info ] [MainThread]:   job_retries: 1
[0m21:45:52.205280 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:45:52.208644 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:45:52.212138 [info ] [MainThread]:   keyfile: $
[0m21:45:52.215543 [info ] [MainThread]:   timeout_seconds: None
[0m21:45:52.218895 [info ] [MainThread]:   refresh_token: None
[0m21:45:52.222261 [info ] [MainThread]:   client_id: None
[0m21:45:52.225644 [info ] [MainThread]:   token_uri: None
[0m21:45:52.229169 [info ] [MainThread]:   dataproc_region: None
[0m21:45:52.232649 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:45:52.236063 [info ] [MainThread]:   gcs_bucket: None
[0m21:45:52.239839 [info ] [MainThread]:   dataproc_batch: None
[0m21:45:52.243719 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:45:52.247636 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:45:52.251473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:52.255171 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '$''
[0m21:45:52.259000 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:45:52.262930 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:45:52.266595 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '$'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:45:52.270812 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.4355998, "process_user_time": 5.086528, "process_kernel_time": 0.664346, "process_mem_max_rss": "218320", "process_out_blocks": "408", "command_success": false, "process_in_blocks": "0"}
[0m21:45:52.274799 [debug] [MainThread]: Command `dbt debug` failed at 21:45:52.274534 after 2.44 seconds
[0m21:45:52.278330 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:45:52.281955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1f3aded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1cba9930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1cb52410>]}
[0m21:45:52.285763 [debug] [MainThread]: Flushing usage events
[0m21:53:33.168407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72da839ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d80365c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d8036560>]}


============================== 21:53:33.172228 | 2d425ed3-8e4d-45e1-9b11-e7e2bf18088c ==============================
[0m21:53:33.172228 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:53:33.190122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:53:33.203178 [info ] [MainThread]: dbt version: 1.7.4
[0m21:53:33.207367 [info ] [MainThread]: python version: 3.10.14
[0m21:53:33.210997 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:53:33.214506 [info ] [MainThread]: os info: Linux-5.15.60-x86_64-with-glibc2.36
[0m21:53:35.004346 [info ] [MainThread]: Using profiles dir at /home/src/default_repo/dbt/dbt_citi_bikes
[0m21:53:35.005088 [info ] [MainThread]: Using profiles.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/profiles.yml
[0m21:53:35.009409 [info ] [MainThread]: Using dbt_project.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/dbt_project.yml
[0m21:53:35.033122 [info ] [MainThread]: adapter type: bigquery
[0m21:53:35.058250 [info ] [MainThread]: adapter version: 1.7.2
[0m21:53:35.182789 [info ] [MainThread]: Configuration:
[0m21:53:35.187463 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:53:35.192446 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:53:35.196095 [info ] [MainThread]: Required dependencies:
[0m21:53:35.202601 [debug] [MainThread]: Executing "git --help"
[0m21:53:35.212132 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:53:35.212882 [debug] [MainThread]: STDERR: "b''"
[0m21:53:35.216991 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:53:35.220516 [info ] [MainThread]: Connection:
[0m21:53:35.223875 [info ] [MainThread]:   method: service-account
[0m21:53:35.227220 [info ] [MainThread]:   database: virtual-aileron-412616
[0m21:53:35.230521 [info ] [MainThread]:   execution_project: virtual-aileron-412616
[0m21:53:35.233956 [info ] [MainThread]:   schema: nyc_citi_bike_rides
[0m21:53:35.237453 [info ] [MainThread]:   location: None
[0m21:53:35.240717 [info ] [MainThread]:   priority: None
[0m21:53:35.243802 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:53:35.247470 [info ] [MainThread]:   impersonate_service_account: None
[0m21:53:35.250890 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:53:35.254546 [info ] [MainThread]:   job_retries: 1
[0m21:53:35.257792 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:53:35.261295 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:53:35.265150 [info ] [MainThread]:   keyfile: /secrets/credentials/mage_credentials
[0m21:53:35.268607 [info ] [MainThread]:   timeout_seconds: None
[0m21:53:35.272010 [info ] [MainThread]:   refresh_token: None
[0m21:53:35.275396 [info ] [MainThread]:   client_id: None
[0m21:53:35.278398 [info ] [MainThread]:   token_uri: None
[0m21:53:35.281654 [info ] [MainThread]:   dataproc_region: None
[0m21:53:35.285224 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:53:35.288624 [info ] [MainThread]:   gcs_bucket: None
[0m21:53:35.291900 [info ] [MainThread]:   dataproc_batch: None
[0m21:53:35.295374 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:53:35.299176 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:53:35.302363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:35.621551 [debug] [MainThread]: On debug: select 1 as id
[0m21:53:36.825372 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:d38e6e16-d034-42bf-bc81-49343386e74e&page=queryresults
[0m21:53:37.345461 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:53:37.350414 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:53:37.354268 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.2612953, "process_user_time": 5.325593, "process_kernel_time": 0.641043, "process_mem_max_rss": "222864", "process_out_blocks": "408", "process_in_blocks": "0"}
[0m21:53:37.358699 [debug] [MainThread]: Command `dbt debug` succeeded at 21:53:37.358223 after 4.27 seconds
[0m21:53:37.362540 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:53:37.366161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72da839ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72d7fa2f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72bf64b100>]}
[0m21:53:37.369996 [debug] [MainThread]: Flushing usage events
[0m17:07:56.963192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbacfd1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa7ce5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa7ce590>]}


============================== 17:07:56.967253 | 1b30819c-b58c-4655-be63-7dcad1d8cc8e ==============================
[0m17:07:56.967253 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:07:56.972141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:56.976033 [info ] [MainThread]: dbt version: 1.7.4
[0m17:07:56.979963 [info ] [MainThread]: python version: 3.10.14
[0m17:07:56.986805 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:07:56.990465 [info ] [MainThread]: os info: Linux-5.15.60-x86_64-with-glibc2.36
[0m17:07:59.859889 [info ] [MainThread]: Using profiles dir at /home/src/default_repo/dbt/dbt_citi_bikes
[0m17:07:59.860688 [info ] [MainThread]: Using profiles.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/profiles.yml
[0m17:07:59.864740 [info ] [MainThread]: Using dbt_project.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/dbt_project.yml
[0m17:07:59.874869 [info ] [MainThread]: adapter type: bigquery
[0m17:07:59.878693 [info ] [MainThread]: adapter version: 1.7.2
[0m17:08:00.009074 [info ] [MainThread]: Configuration:
[0m17:08:00.013606 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:08:00.017300 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:08:00.020646 [info ] [MainThread]: Required dependencies:
[0m17:08:00.024398 [debug] [MainThread]: Executing "git --help"
[0m17:08:00.034675 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:08:00.035442 [debug] [MainThread]: STDERR: "b''"
[0m17:08:00.039430 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:08:00.043461 [info ] [MainThread]: Connection:
[0m17:08:00.047285 [info ] [MainThread]:   method: service-account
[0m17:08:00.050581 [info ] [MainThread]:   database: virtual-aileron-412616
[0m17:08:00.053936 [info ] [MainThread]:   execution_project: virtual-aileron-412616
[0m17:08:00.057939 [info ] [MainThread]:   schema: nyc_citi_bike_rides
[0m17:08:00.062060 [info ] [MainThread]:   location: None
[0m17:08:00.065502 [info ] [MainThread]:   priority: None
[0m17:08:00.069336 [info ] [MainThread]:   maximum_bytes_billed: None
[0m17:08:00.072745 [info ] [MainThread]:   impersonate_service_account: None
[0m17:08:00.076302 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m17:08:00.080130 [info ] [MainThread]:   job_retries: 1
[0m17:08:00.083578 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m17:08:00.087053 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m17:08:00.091458 [info ] [MainThread]:   keyfile: /secrets/credentials/mage_credentials
[0m17:08:00.094935 [info ] [MainThread]:   timeout_seconds: None
[0m17:08:00.098637 [info ] [MainThread]:   refresh_token: None
[0m17:08:00.103416 [info ] [MainThread]:   client_id: None
[0m17:08:00.107028 [info ] [MainThread]:   token_uri: None
[0m17:08:00.111837 [info ] [MainThread]:   dataproc_region: None
[0m17:08:00.115594 [info ] [MainThread]:   dataproc_cluster_name: None
[0m17:08:00.119285 [info ] [MainThread]:   gcs_bucket: None
[0m17:08:00.122733 [info ] [MainThread]:   dataproc_batch: None
[0m17:08:00.126157 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m17:08:00.129625 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m17:08:00.132775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:00.363205 [debug] [MainThread]: On debug: select 1 as id
[0m17:08:00.851130 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:fc4c8d9a-aeac-468e-807d-eb5e6e84e133&page=queryresults
[0m17:08:01.269400 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:08:01.274023 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:08:01.278345 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.4053516, "process_user_time": 5.247114, "process_kernel_time": 0.806621, "process_mem_max_rss": "222692", "process_in_blocks": "32", "process_out_blocks": "408"}
[0m17:08:01.282570 [debug] [MainThread]: Command `dbt debug` succeeded at 17:08:01.282277 after 4.41 seconds
[0m17:08:01.286671 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:08:01.295822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbacfd1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa736f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb91ef7760>]}
[0m17:08:01.300894 [debug] [MainThread]: Flushing usage events
[0m18:21:39.909972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f2e21ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f0472650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f04725f0>]}


============================== 18:21:39.913904 | 4d4e719d-cf22-4301-bd88-6b9c71cb89f2 ==============================
[0m18:21:39.913904 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:21:39.953597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:21:42.085737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d4e719d-cf22-4301-bd88-6b9c71cb89f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f05dbca0>]}
[0m18:21:42.228632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d4e719d-cf22-4301-bd88-6b9c71cb89f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7cd4580>]}
[0m18:21:42.234556 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:21:42.239956 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:21:42.244362 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.4101946, "process_user_time": 5.271574, "process_kernel_time": 0.651314, "process_mem_max_rss": "219872", "process_out_blocks": "64", "command_success": false, "process_in_blocks": "0"}
[0m18:21:42.248782 [debug] [MainThread]: Command `dbt compile` failed at 18:21:42.248481 after 2.41 seconds
[0m18:21:42.252706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f2e21ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7590460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d7590bb0>]}
[0m18:21:42.256432 [debug] [MainThread]: Flushing usage events
[0m18:21:57.635588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c9419ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c6c1a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c6c1a470>]}


============================== 18:21:57.640435 | d1185746-6578-4903-9975-5246db8a7087 ==============================
[0m18:21:57.640435 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:21:57.645582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:21:57.860366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1185746-6578-4903-9975-5246db8a7087', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c6bc2f50>]}
[0m18:21:57.866256 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l0b_c3nt'
[0m18:21:57.870019 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:21:57.976067 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:21:57.982800 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:21:58.039134 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:21:58.056508 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m18:21:58.128795 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m18:21:58.164219 [info ] [MainThread]: Updating lock file in file path: /home/src/default_repo/dbt/dbt_citi_bikes/package-lock.yml
[0m18:21:58.175704 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-dwgg7zqx'
[0m18:21:58.186667 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:22:02.002910 [info ] [MainThread]: Installed from version 1.1.1
[0m18:22:02.007527 [info ] [MainThread]: Up to date!
[0m18:22:02.011859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd1185746-6578-4903-9975-5246db8a7087', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c6a86740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c6a86860>]}
[0m18:22:02.016222 [info ] [MainThread]: Installing dbt-labs/codegen
[0m18:22:03.579329 [info ] [MainThread]: Installed from version 0.12.1
[0m18:22:03.583222 [info ] [MainThread]: Up to date!
[0m18:22:03.587125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd1185746-6578-4903-9975-5246db8a7087', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c6a86740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c6bc3f10>]}
[0m18:22:03.595960 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.0342207, "process_user_time": 3.919119, "process_kernel_time": 0.380213, "process_mem_max_rss": "105788", "process_out_blocks": "2840", "process_in_blocks": "0"}
[0m18:22:03.600078 [debug] [MainThread]: Command `dbt deps` succeeded at 18:22:03.599804 after 6.04 seconds
[0m18:22:03.603870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c9419ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c6a84160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42c6a84220>]}
[0m18:22:03.607656 [debug] [MainThread]: Flushing usage events
[0m18:22:19.131138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea6021ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea36766b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea3676650>]}


============================== 18:22:19.134859 | 5d624ce8-f0c2-4f63-9789-0947a7e55f59 ==============================
[0m18:22:19.134859 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:22:19.140503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:22:21.147209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d624ce8-f0c2-4f63-9789-0947a7e55f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea3822a70>]}
[0m18:22:21.288741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d624ce8-f0c2-4f63-9789-0947a7e55f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a7b2dd0>]}
[0m18:22:21.295188 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:22:21.353073 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:22:21.364779 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:22:21.369268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d624ce8-f0c2-4f63-9789-0947a7e55f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a6aa530>]}
[0m18:22:24.058006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d624ce8-f0c2-4f63-9789-0947a7e55f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a37c0d0>]}
[0m18:22:24.136868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d624ce8-f0c2-4f63-9789-0947a7e55f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a511ff0>]}
[0m18:22:24.140650 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 583 macros, 0 groups, 0 semantic models
[0m18:22:24.144443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d624ce8-f0c2-4f63-9789-0947a7e55f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a2b9810>]}
[0m18:22:24.150363 [info ] [MainThread]: 
[0m18:22:24.155027 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:22:24.159832 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616_nyc_citi_bike_rides'
[0m18:22:24.163921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:24.681145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d624ce8-f0c2-4f63-9789-0947a7e55f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a49f880>]}
[0m18:22:24.686231 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:22:24.690037 [info ] [MainThread]: 
[0m18:22:24.696749 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_rides
[0m18:22:24.701499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.taxi_rides_ny.stg_rides)
[0m18:22:24.705411 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_rides
[0m18:22:24.725153 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (compile): 18:22:24.709118 => 18:22:24.724651
[0m18:22:24.741817 [debug] [Thread-1 (]: Compilation Error in model stg_rides (models/staging/stg_rides.sql)
  'dbt_safe_cast' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:22:24.746386 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_rides
[0m18:22:24.750290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:24.754155 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_rides' was properly closed.
[0m18:22:24.757630 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model stg_rides (models/staging/stg_rides.sql)
    'dbt_safe_cast' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:22:24.761303 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 5.7062917, "process_user_time": 7.470424, "process_kernel_time": 0.778676, "process_mem_max_rss": "238332", "process_out_blocks": "2648", "command_success": false, "process_in_blocks": "0"}
[0m18:22:24.765079 [debug] [MainThread]: Command `dbt compile` failed at 18:22:24.764793 after 5.71 seconds
[0m18:22:24.773454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ea6021ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a7fe830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a389270>]}
[0m18:22:24.777384 [debug] [MainThread]: Flushing usage events
[0m18:28:03.255583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19488d78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19460be5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19460be560>]}


============================== 18:28:03.259570 | 2241afee-9265-4e8b-8b7e-40db4e4ec581 ==============================
[0m18:28:03.259570 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:28:03.273875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:28:05.223709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2241afee-9265-4e8b-8b7e-40db4e4ec581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f194602b970>]}
[0m18:28:05.363888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2241afee-9265-4e8b-8b7e-40db4e4ec581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19310c6c50>]}
[0m18:28:05.368955 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:28:05.406318 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:28:05.644765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:05.649767 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models/staging/stg_rides.sql
[0m18:28:05.905472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2241afee-9265-4e8b-8b7e-40db4e4ec581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1930a204f0>]}
[0m18:28:05.968166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2241afee-9265-4e8b-8b7e-40db4e4ec581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1946a596f0>]}
[0m18:28:05.972312 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 583 macros, 0 groups, 0 semantic models
[0m18:28:05.976475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2241afee-9265-4e8b-8b7e-40db4e4ec581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1946a59630>]}
[0m18:28:05.981569 [info ] [MainThread]: 
[0m18:28:05.985928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:28:05.991135 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616_nyc_citi_bike_rides'
[0m18:28:05.995044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:06.503379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2241afee-9265-4e8b-8b7e-40db4e4ec581', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1946a594b0>]}
[0m18:28:06.507967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:28:06.511569 [info ] [MainThread]: 
[0m18:28:06.518290 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_rides
[0m18:28:06.522531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.taxi_rides_ny.stg_rides)
[0m18:28:06.528215 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_rides
[0m18:28:06.539594 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (compile): 18:28:06.531783 => 18:28:06.539125
[0m18:28:06.546726 [debug] [Thread-1 (]: Compilation Error in model stg_rides (models/staging/stg_rides.sql)
  'get_ride_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:28:06.552383 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_rides
[0m18:28:06.556501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:06.560121 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_rides' was properly closed.
[0m18:28:06.564286 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model stg_rides (models/staging/stg_rides.sql)
    'get_ride_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:28:06.568292 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 3.385884, "process_user_time": 5.632689, "process_kernel_time": 0.631249, "process_mem_max_rss": "235940", "process_out_blocks": "2648", "command_success": false, "process_in_blocks": "0"}
[0m18:28:06.572163 [debug] [MainThread]: Command `dbt compile` failed at 18:28:06.571882 after 3.39 seconds
[0m18:28:06.575943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19488d78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1946a597b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1931139e40>]}
[0m18:28:06.579851 [debug] [MainThread]: Flushing usage events
[0m18:30:31.957386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330aa61ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3308262740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33082626e0>]}


============================== 18:30:31.961038 | cdf49cdb-d6e8-457d-a3f6-23571f2ece09 ==============================
[0m18:30:31.961038 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:30:31.977877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m18:30:33.847439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdf49cdb-d6e8-457d-a3f6-23571f2ece09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33081cb9a0>]}
[0m18:30:33.981878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdf49cdb-d6e8-457d-a3f6-23571f2ece09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ef9d4670>]}
[0m18:30:33.987366 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:30:34.021668 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:30:34.214746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m18:30:34.218859 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://macros/get_ride_type.sql
[0m18:30:34.222234 [debug] [MainThread]: Partial parsing: added file: taxi_rides_ny://macros/get_member_type.sql
[0m18:30:34.270494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdf49cdb-d6e8-457d-a3f6-23571f2ece09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3308c080d0>]}
[0m18:30:34.333405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdf49cdb-d6e8-457d-a3f6-23571f2ece09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3308d9acb0>]}
[0m18:30:34.337296 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m18:30:34.342061 [info ] [MainThread]: 
[0m18:30:34.346306 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:30:34.350992 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m18:30:34.354551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:35.082495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m18:30:35.087197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:35.439108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf49cdb-d6e8-457d-a3f6-23571f2ece09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3308d9b940>]}
[0m18:30:35.443802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:30:35.447586 [info ] [MainThread]: 
[0m18:30:35.453783 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_rides
[0m18:30:35.457940 [info ] [Thread-1 (]: 1 of 1 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m18:30:35.462156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.taxi_rides_ny.stg_rides)
[0m18:30:35.466106 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_rides
[0m18:30:35.489188 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_rides"
[0m18:30:35.516785 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (compile): 18:30:35.469545 => 18:30:35.516184
[0m18:30:35.520726 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_rides
[0m18:30:35.567561 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_rides"
[0m18:30:35.596082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:35.649387 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as { { config(materialized='view') }}

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from { { source('staging', 'rides') }}
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM { { source('staging', 'citi_bikes') }})
)

select

    safe_cast(ride_id as INT64)
 as ride_id,
case 
    safe_cast(rideable_type as String)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
cast(start_station_id as float) as start_station_id,
cast(end_station_id as float) as end_station_id,
cast(started_at as timestamp) as started_at,
cast(ended_at as timestamp) as ended_at,
case 
    safe_cast(member_casual as String)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type
cast(date_part as date) as date_part


from bike_rides

where id = 1


dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m18:30:35.996987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:610b2884-b066-44b7-ae5f-02f53c9ecdff&page=queryresults
[0m18:30:36.002286 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "{" at [6:6]')
[0m18:30:36.551553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:0110fac0-71d2-42ab-a27b-a19004993698&page=queryresults
[0m18:30:36.556459 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:0110fac0-71d2-42ab-a27b-a19004993698&page=queryresults
[0m18:30:36.561200 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (execute): 18:30:35.524070 => 18:30:36.560786
[0m18:30:36.582551 [debug] [Thread-1 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [6:6]
  compiled Code at target/run/taxi_rides_ny/models/staging/stg_rides.sql
[0m18:30:36.587301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf49cdb-d6e8-457d-a3f6-23571f2ece09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3308c0bcd0>]}
[0m18:30:36.591719 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 1.13s]
[0m18:30:36.595946 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_rides
[0m18:30:36.601874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:36.605680 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_rides' was properly closed.
[0m18:30:36.609422 [info ] [MainThread]: 
[0m18:30:36.613035 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m18:30:36.617285 [debug] [MainThread]: Command end result
[0m18:30:36.672198 [info ] [MainThread]: 
[0m18:30:36.676708 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:30:36.680379 [info ] [MainThread]: 
[0m18:30:36.684130 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [6:6]
  compiled Code at target/run/taxi_rides_ny/models/staging/stg_rides.sql
[0m18:30:36.687763 [info ] [MainThread]: 
[0m18:30:36.691781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:30:36.695803 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.808459, "process_user_time": 5.49766, "process_kernel_time": 0.672521, "process_mem_max_rss": "237284", "process_in_blocks": "16", "process_out_blocks": "4056", "command_success": false}
[0m18:30:36.699910 [debug] [MainThread]: Command `dbt build` failed at 18:30:36.699646 after 4.81 seconds
[0m18:30:36.703718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330aa61ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33081cb370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3308c73c70>]}
[0m18:30:36.707721 [debug] [MainThread]: Flushing usage events
[0m18:32:41.529181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc06d9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbdeda650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbdeda5f0>]}


============================== 18:32:41.533174 | 433ff86b-bb68-465d-b87e-69cf257a5bc4 ==============================
[0m18:32:41.533174 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:32:41.537610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:32:43.517345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '433ff86b-bb68-465d-b87e-69cf257a5bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbde43ca0>]}
[0m18:32:43.656512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '433ff86b-bb68-465d-b87e-69cf257a5bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa95d4580>]}
[0m18:32:43.667475 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:32:43.704233 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:32:43.913420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:32:43.930848 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models/staging/stg_rides.sql
[0m18:32:44.181488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '433ff86b-bb68-465d-b87e-69cf257a5bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa8819720>]}
[0m18:32:44.242768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '433ff86b-bb68-465d-b87e-69cf257a5bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbe93d000>]}
[0m18:32:44.246897 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m18:32:44.252236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '433ff86b-bb68-465d-b87e-69cf257a5bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbe93cf70>]}
[0m18:32:44.257346 [info ] [MainThread]: 
[0m18:32:44.261765 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:32:44.273544 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616_nyc_citi_bike_rides'
[0m18:32:44.277720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:44.758057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '433ff86b-bb68-465d-b87e-69cf257a5bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fbea31690>]}
[0m18:32:44.763613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:32:44.768207 [info ] [MainThread]: 
[0m18:32:44.776364 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_rides
[0m18:32:44.781936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.taxi_rides_ny.stg_rides)
[0m18:32:44.785771 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_rides
[0m18:32:44.798323 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_rides"
[0m18:32:44.812476 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (compile): 18:32:44.789646 => 18:32:44.811680
[0m18:32:44.817244 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_rides
[0m18:32:44.821431 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (execute): 18:32:44.820999 => 18:32:44.821025
[0m18:32:44.826287 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_rides
[0m18:32:44.831776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:44.836190 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_rides' was properly closed.
[0m18:32:44.840902 [debug] [MainThread]: Command end result
[0m18:32:44.898660 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.443643, "process_user_time": 5.5156, "process_kernel_time": 0.730006, "process_mem_max_rss": "237720", "process_out_blocks": "3872", "process_in_blocks": "0"}
[0m18:32:44.903239 [debug] [MainThread]: Command `dbt compile` succeeded at 18:32:44.902728 after 3.45 seconds
[0m18:32:44.907157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fc06d9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa91115a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fa8fa3700>]}
[0m18:32:44.911151 [debug] [MainThread]: Flushing usage events
[0m18:32:56.204287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91522e9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914faea710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914faea6b0>]}


============================== 18:32:56.208034 | 055838a1-6fff-494b-8111-2d4c24f4c0b2 ==============================
[0m18:32:56.208034 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:32:56.212677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:32:58.006831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '055838a1-6fff-494b-8111-2d4c24f4c0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9136d21540>]}
[0m18:32:58.146279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '055838a1-6fff-494b-8111-2d4c24f4c0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9136c19b40>]}
[0m18:32:58.151532 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:32:58.188785 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:32:58.369422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:58.373698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:58.386005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '055838a1-6fff-494b-8111-2d4c24f4c0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91506600d0>]}
[0m18:32:58.447565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '055838a1-6fff-494b-8111-2d4c24f4c0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9150631d50>]}
[0m18:32:58.451218 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m18:32:58.455812 [info ] [MainThread]: 
[0m18:32:58.460438 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:32:58.464964 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m18:32:58.468615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:59.097516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m18:32:59.102058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:59.432252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055838a1-6fff-494b-8111-2d4c24f4c0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9150630c10>]}
[0m18:32:59.437206 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:32:59.441173 [info ] [MainThread]: 
[0m18:32:59.448192 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_rides
[0m18:32:59.452515 [info ] [Thread-1 (]: 1 of 1 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m18:32:59.457117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.taxi_rides_ny.stg_rides)
[0m18:32:59.461379 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_rides
[0m18:32:59.480431 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_rides"
[0m18:32:59.495818 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (compile): 18:32:59.464922 => 18:32:59.495308
[0m18:32:59.499735 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_rides
[0m18:32:59.555783 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_rides"
[0m18:32:59.572185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:59.627458 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM { { source('staging', 'citi_bikes') }})
)

select

    safe_cast(ride_id as INT64)
 as ride_id,
case 
    safe_cast(rideable_type as String)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
cast(start_station_id as float) as start_station_id,
cast(end_station_id as float) as end_station_id,
cast(started_at as timestamp) as started_at,
cast(ended_at as timestamp) as ended_at,
case 
    safe_cast(member_casual as String)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type
cast(date_part as date) as date_part


from bike_rides

where id = 1


dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m18:32:59.958641 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:dd67f949-dc0c-4697-b430-794b7f5e7942&page=queryresults
[0m18:32:59.964131 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "{" at [13:75]')
[0m18:33:01.023545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:6d1664c6-a0db-49e6-bbc6-cd813edaab9e&page=queryresults
[0m18:33:01.028169 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:6d1664c6-a0db-49e6-bbc6-cd813edaab9e&page=queryresults
[0m18:33:01.032522 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (execute): 18:32:59.503986 => 18:33:01.032055
[0m18:33:01.041615 [debug] [Thread-1 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [13:75]
  compiled Code at target/run/taxi_rides_ny/models/staging/stg_rides.sql
[0m18:33:01.046030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055838a1-6fff-494b-8111-2d4c24f4c0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91506300d0>]}
[0m18:33:01.050463 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 1.59s]
[0m18:33:01.054816 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_rides
[0m18:33:01.061045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:01.065117 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_rides' was properly closed.
[0m18:33:01.069349 [info ] [MainThread]: 
[0m18:33:01.073158 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m18:33:01.077575 [debug] [MainThread]: Command end result
[0m18:33:01.134383 [info ] [MainThread]: 
[0m18:33:01.138196 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:33:01.141495 [info ] [MainThread]: 
[0m18:33:01.145169 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [13:75]
  compiled Code at target/run/taxi_rides_ny/models/staging/stg_rides.sql
[0m18:33:01.148670 [info ] [MainThread]: 
[0m18:33:01.152263 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:33:01.155557 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 5.023509, "process_user_time": 5.569325, "process_kernel_time": 0.60668, "process_mem_max_rss": "237580", "process_out_blocks": "2832", "command_success": false, "process_in_blocks": "0"}
[0m18:33:01.159068 [debug] [MainThread]: Command `dbt build` failed at 18:33:01.158779 after 5.03 seconds
[0m18:33:01.162315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91522e9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9136b1a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9136b1bbe0>]}
[0m18:33:01.165518 [debug] [MainThread]: Flushing usage events
[0m18:36:32.735409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83b1a61ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83af0b2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83af0b26b0>]}


============================== 18:36:32.739151 | b3ad873f-77d1-4cee-904a-a415ae7ea75e ==============================
[0m18:36:32.739151 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:36:32.749798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:36:34.803085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3ad873f-77d1-4cee-904a-a415ae7ea75e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839633d540>]}
[0m18:36:34.949923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3ad873f-77d1-4cee-904a-a415ae7ea75e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839623db40>]}
[0m18:36:34.956137 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:36:35.002490 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:36:35.232889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:36:35.237927 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://macros/get_ride_type.sql
[0m18:36:35.501093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3ad873f-77d1-4cee-904a-a415ae7ea75e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8395bf1f60>]}
[0m18:36:35.572160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3ad873f-77d1-4cee-904a-a415ae7ea75e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8395bb1270>]}
[0m18:36:35.576522 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m18:36:35.581805 [info ] [MainThread]: 
[0m18:36:35.586656 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:36:35.591947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m18:36:35.597234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:36.188456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m18:36:36.193047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:36.567777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ad873f-77d1-4cee-904a-a415ae7ea75e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83afc55420>]}
[0m18:36:36.572807 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:36.576794 [info ] [MainThread]: 
[0m18:36:36.584657 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_rides
[0m18:36:36.589445 [info ] [Thread-1 (]: 1 of 1 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m18:36:36.593912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.taxi_rides_ny.stg_rides)
[0m18:36:36.597656 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_rides
[0m18:36:36.610225 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_rides"
[0m18:36:36.622064 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (compile): 18:36:36.601053 => 18:36:36.621556
[0m18:36:36.625752 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_rides
[0m18:36:36.671459 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_rides"
[0m18:36:36.686186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:36.739516 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM { { source('staging', 'citi_bikes') }})
)

select

    safe_cast(ride_id as INT64)
 as ride_id,
case 
    safe_cast(rideable_type as string)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
cast(start_station_id as float) as start_station_id,
cast(end_station_id as float) as end_station_id,
cast(started_at as timestamp) as started_at,
cast(ended_at as timestamp) as ended_at,
case 
    safe_cast(member_casual as String)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type
cast(date_part as date) as date_part


from bike_rides

where id = 1


dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m18:36:37.121858 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:bdc6e71a-9ba0-49ea-bb3b-f5ae2f97c650&page=queryresults
[0m18:36:37.129774 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "{" at [13:75]')
[0m18:36:37.435706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:4520bccc-2910-4856-b358-bd06d2508555&page=queryresults
[0m18:36:37.440415 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:4520bccc-2910-4856-b358-bd06d2508555&page=queryresults
[0m18:36:37.445533 [debug] [Thread-1 (]: Timing info for model.taxi_rides_ny.stg_rides (execute): 18:36:36.629023 => 18:36:37.444732
[0m18:36:37.454790 [debug] [Thread-1 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [13:75]
  compiled Code at target/run/taxi_rides_ny/models/staging/stg_rides.sql
[0m18:36:37.458974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ad873f-77d1-4cee-904a-a415ae7ea75e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8395bf2740>]}
[0m18:36:37.463394 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 0.87s]
[0m18:36:37.467685 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_rides
[0m18:36:37.474575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:37.478812 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_rides' was properly closed.
[0m18:36:37.482787 [info ] [MainThread]: 
[0m18:36:37.486359 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m18:36:37.490640 [debug] [MainThread]: Command end result
[0m18:36:37.559249 [info ] [MainThread]: 
[0m18:36:37.563018 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:36:37.566540 [info ] [MainThread]: 
[0m18:36:37.570059 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [13:75]
  compiled Code at target/run/taxi_rides_ny/models/staging/stg_rides.sql
[0m18:36:37.573936 [info ] [MainThread]: 
[0m18:36:37.577504 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:36:37.581177 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.916858, "process_user_time": 6.004393, "process_kernel_time": 0.7572, "process_mem_max_rss": "242152", "process_out_blocks": "4048", "command_success": false, "process_in_blocks": "0"}
[0m18:36:37.584922 [debug] [MainThread]: Command `dbt build` failed at 18:36:37.584689 after 4.92 seconds
[0m18:36:37.588565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83b1a61ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839623e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839623e6e0>]}
[0m18:36:37.591929 [debug] [MainThread]: Flushing usage events
[0m18:41:16.358312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd982d95ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9803ea650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9803ea5f0>]}


============================== 18:41:16.362354 | b7d056aa-f480-490c-b719-121d56bff939 ==============================
[0m18:41:16.362354 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:41:16.366653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m18:41:18.313524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7d056aa-f480-490c-b719-121d56bff939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98054f9a0>]}
[0m18:41:18.447970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7d056aa-f480-490c-b719-121d56bff939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd967505a80>]}
[0m18:41:18.453231 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:41:18.492556 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:41:18.524053 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:41:18.528573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7d056aa-f480-490c-b719-121d56bff939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9675f7f40>]}
[0m18:41:20.893913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7d056aa-f480-490c-b719-121d56bff939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9675f75e0>]}
[0m18:41:20.952084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7d056aa-f480-490c-b719-121d56bff939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9675f5060>]}
[0m18:41:20.955665 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m18:41:20.960638 [info ] [MainThread]: 
[0m18:41:20.964694 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:41:20.969998 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m18:41:20.973702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:21.632331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m18:41:21.636338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:22.002593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7d056aa-f480-490c-b719-121d56bff939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9675f5f30>]}
[0m18:41:22.007741 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:41:22.011931 [info ] [MainThread]: 
[0m18:41:22.019488 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m18:41:22.023780 [info ] [Thread-1 (]: 1 of 1 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m18:41:22.028063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_rides)
[0m18:41:22.031641 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m18:41:22.049943 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m18:41:22.074396 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 18:41:22.034785 => 18:41:22.073861
[0m18:41:22.078156 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m18:41:22.125813 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m18:41:22.150335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:22.210301 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM { { source('staging', 'citi_bikes') }})
)

select

    safe_cast(ride_id as string)
 as ride_id,
case 
    safe_cast(rideable_type as string)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
cast(start_station_id as float) as start_station_id,
cast(end_station_id as float) as end_station_id,
cast(started_at as timestamp) as started_at,
cast(ended_at as timestamp) as ended_at,
case 
    safe_cast(member_casual as string)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type
cast(date_part as date) as date_part


from bike_rides

where id = 1


dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m18:41:22.536034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:3cf1cc5d-739d-4137-948b-ddbd4a44f08c&page=queryresults
[0m18:41:22.540936 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "{" at [13:75]')
[0m18:41:23.136386 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:b4de1f54-7fa7-454b-87f6-c44702dc7aad&page=queryresults
[0m18:41:23.141239 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:b4de1f54-7fa7-454b-87f6-c44702dc7aad&page=queryresults
[0m18:41:23.145609 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 18:41:22.081642 => 18:41:23.145154
[0m18:41:23.155478 [debug] [Thread-1 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [13:75]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m18:41:23.160037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d056aa-f480-490c-b719-121d56bff939', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd966eb0e50>]}
[0m18:41:23.164660 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 1.13s]
[0m18:41:23.168878 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m18:41:23.175246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:23.178978 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m18:41:23.182552 [info ] [MainThread]: 
[0m18:41:23.186130 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m18:41:23.190349 [debug] [MainThread]: Command end result
[0m18:41:23.262537 [info ] [MainThread]: 
[0m18:41:23.266284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:41:23.272478 [info ] [MainThread]: 
[0m18:41:23.277317 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [13:75]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m18:41:23.281358 [info ] [MainThread]: 
[0m18:41:23.285809 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:41:23.291090 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 7.012064, "process_user_time": 7.838915, "process_kernel_time": 0.579765, "process_mem_max_rss": "241340", "process_out_blocks": "4048", "command_success": false, "process_in_blocks": "0"}
[0m18:41:23.294900 [debug] [MainThread]: Command `dbt build` failed at 18:41:23.294591 after 7.02 seconds
[0m18:41:23.300243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd982d95ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd966ecab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9675f5060>]}
[0m18:41:23.303972 [debug] [MainThread]: Flushing usage events
[0m18:43:58.590509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc65eadded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc65c132710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc65c1326b0>]}


============================== 18:43:58.594532 | b7193606-bb03-4b04-929e-cfb2dd60648e ==============================
[0m18:43:58.594532 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:43:58.602638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m18:44:01.238826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7193606-bb03-4b04-929e-cfb2dd60648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6434f1540>]}
[0m18:44:01.404674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7193606-bb03-4b04-929e-cfb2dd60648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6433e84f0>]}
[0m18:44:01.414280 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:44:01.454819 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:44:01.816061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:44:01.823280 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m18:44:02.098618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7193606-bb03-4b04-929e-cfb2dd60648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc642bd9810>]}
[0m18:44:02.180157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7193606-bb03-4b04-929e-cfb2dd60648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc642b210c0>]}
[0m18:44:02.184485 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m18:44:02.191236 [info ] [MainThread]: 
[0m18:44:02.196289 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:44:02.203127 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m18:44:02.207409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:02.757837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m18:44:02.762657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:03.166380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7193606-bb03-4b04-929e-cfb2dd60648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc65cc9cfa0>]}
[0m18:44:03.172866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:44:03.179224 [info ] [MainThread]: 
[0m18:44:03.191828 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m18:44:03.200484 [info ] [Thread-1 (]: 1 of 1 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m18:44:03.205615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_rides)
[0m18:44:03.210344 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m18:44:03.223124 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m18:44:03.240059 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 18:44:03.214135 => 18:44:03.239506
[0m18:44:03.243847 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m18:44:03.294627 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m18:44:03.319724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:03.379269 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM { { source('staging', 'citi_bikes') }})
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  case 
    safe_cast(rideable_type as string)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
  cast(start_station_id as float) as start_station_id,
  cast(end_station_id as float) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  case 
    safe_cast(member_casual as string)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type,
  cast(date_part as date) as date_parts


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m18:44:03.740268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:932fe14f-aea3-491a-ae65-a51588360173&page=queryresults
[0m18:44:03.745188 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "{" at [13:75]')
[0m18:44:04.183853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:3ae0392f-3040-4210-a7a7-80e243d0c2b5&page=queryresults
[0m18:44:04.190225 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:3ae0392f-3040-4210-a7a7-80e243d0c2b5&page=queryresults
[0m18:44:04.194993 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 18:44:03.247473 => 18:44:04.194492
[0m18:44:04.209021 [debug] [Thread-1 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [13:75]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m18:44:04.213911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7193606-bb03-4b04-929e-cfb2dd60648e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc642bda8c0>]}
[0m18:44:04.218437 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 1.01s]
[0m18:44:04.223526 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m18:44:04.229952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:04.233931 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m18:44:04.238149 [info ] [MainThread]: 
[0m18:44:04.242212 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m18:44:04.246119 [debug] [MainThread]: Command end result
[0m18:44:04.313699 [info ] [MainThread]: 
[0m18:44:04.317814 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:44:04.324266 [info ] [MainThread]: 
[0m18:44:04.328561 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Unexpected "{" at [13:75]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m18:44:04.332182 [info ] [MainThread]: 
[0m18:44:04.335893 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:44:04.340477 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 5.8270154, "process_user_time": 6.509471, "process_kernel_time": 0.95994, "process_mem_max_rss": "241940", "process_out_blocks": "4048", "command_success": false, "process_in_blocks": "0"}
[0m18:44:04.344907 [debug] [MainThread]: Command `dbt build` failed at 18:44:04.344608 after 5.83 seconds
[0m18:44:04.348632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc65eadded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc64291b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc64291b6d0>]}
[0m18:44:04.352744 [debug] [MainThread]: Flushing usage events
[0m18:45:34.398057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65157cded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6512e22710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6512e226b0>]}


============================== 18:45:34.401976 | 4b3290d8-a883-4429-96ea-90e4d052ffc7 ==============================
[0m18:45:34.401976 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:45:34.414269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m18:45:36.368843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b3290d8-a883-4429-96ea-90e4d052ffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64fa095540>]}
[0m18:45:36.510030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b3290d8-a883-4429-96ea-90e4d052ffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f9f91b40>]}
[0m18:45:36.515043 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:45:36.557621 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:45:36.809087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:36.813539 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m18:45:37.071812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b3290d8-a883-4429-96ea-90e4d052ffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f996d810>]}
[0m18:45:37.138072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b3290d8-a883-4429-96ea-90e4d052ffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f98d10c0>]}
[0m18:45:37.141769 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m18:45:37.147011 [info ] [MainThread]: 
[0m18:45:37.151335 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:45:37.156330 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m18:45:37.160493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:37.684130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m18:45:37.689250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:38.047747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b3290d8-a883-4429-96ea-90e4d052ffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65139acfa0>]}
[0m18:45:38.053343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:38.057916 [info ] [MainThread]: 
[0m18:45:38.065024 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m18:45:38.070669 [info ] [Thread-1 (]: 1 of 1 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m18:45:38.075409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_rides)
[0m18:45:38.080546 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m18:45:38.093077 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m18:45:38.109020 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 18:45:38.084641 => 18:45:38.108470
[0m18:45:38.118897 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m18:45:38.166689 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m18:45:38.182669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:38.237483 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  case 
    safe_cast(rideable_type as string)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
  cast(start_station_id as float) as start_station_id,
  cast(end_station_id as float) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  case 
    safe_cast(member_casual as string)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type,
  cast(date_part as date) as date_parts


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m18:45:38.873663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:053efbbf-4ed1-4ed6-874b-bbb72109835d&page=queryresults
[0m18:45:39.181404 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Type not found: float at [27:28]')
[0m18:45:40.466799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:064f6be8-c4a8-4a48-806d-e4ecb71a2b31&page=queryresults
[0m18:45:40.743507 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:064f6be8-c4a8-4a48-806d-e4ecb71a2b31&page=queryresults
[0m18:45:40.749221 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 18:45:38.123265 => 18:45:40.748698
[0m18:45:40.757997 [debug] [Thread-1 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Type not found: float at [27:28]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m18:45:40.762322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b3290d8-a883-4429-96ea-90e4d052ffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f996e890>]}
[0m18:45:40.767050 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 2.69s]
[0m18:45:40.772263 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m18:45:40.778966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:40.783015 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m18:45:40.787209 [info ] [MainThread]: 
[0m18:45:40.791960 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m18:45:40.796696 [debug] [MainThread]: Command end result
[0m18:45:40.891702 [info ] [MainThread]: 
[0m18:45:40.896218 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:45:40.900549 [info ] [MainThread]: 
[0m18:45:40.905043 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Type not found: float at [27:28]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m18:45:40.909338 [info ] [MainThread]: 
[0m18:45:40.914548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:45:40.918807 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 6.593003, "process_user_time": 5.87032, "process_kernel_time": 0.76428, "process_mem_max_rss": "242180", "process_out_blocks": "4056", "command_success": false, "process_in_blocks": "0"}
[0m18:45:40.923407 [debug] [MainThread]: Command `dbt build` failed at 18:45:40.923143 after 6.60 seconds
[0m18:45:40.927571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65157cded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f97c7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64f97c7430>]}
[0m18:45:40.932417 [debug] [MainThread]: Flushing usage events
[0m18:49:27.377051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f4fc9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f27c6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f27c66b0>]}


============================== 18:49:27.381576 | 583ba357-7625-4e1f-8443-a14d2a45c064 ==============================
[0m18:49:27.381576 [info ] [MainThread]: Running with dbt=1.7.4
[0m18:49:27.392479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m18:49:29.373835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '583ba357-7625-4e1f-8443-a14d2a45c064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d9a21540>]}
[0m18:49:29.509432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '583ba357-7625-4e1f-8443-a14d2a45c064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d9919b40>]}
[0m18:49:29.514760 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m18:49:29.553557 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m18:49:29.811655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:49:29.816644 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m18:49:30.074680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '583ba357-7625-4e1f-8443-a14d2a45c064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d9119810>]}
[0m18:49:30.141113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '583ba357-7625-4e1f-8443-a14d2a45c064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f32390c0>]}
[0m18:49:30.145497 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m18:49:30.151102 [info ] [MainThread]: 
[0m18:49:30.156377 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:49:30.161198 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m18:49:30.165075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:30.702659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m18:49:30.707387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:31.083077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '583ba357-7625-4e1f-8443-a14d2a45c064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f332cfa0>]}
[0m18:49:31.088587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:31.093249 [info ] [MainThread]: 
[0m18:49:31.101145 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m18:49:31.105180 [info ] [Thread-1 (]: 1 of 1 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m18:49:31.109387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_rides)
[0m18:49:31.113171 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m18:49:31.125214 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m18:49:31.140086 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 18:49:31.116348 => 18:49:31.139098
[0m18:49:31.144833 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m18:49:31.194565 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m18:49:31.210067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:31.264848 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  case 
    safe_cast(rideable_type as string)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
  cast(start_station_id as float64) as start_station_id,
  cast(end_station_id as float64) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  case 
    safe_cast(member_casual as string)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type,
  cast(date_part as date) as date_parts


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m18:49:31.872228 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:110f78b9-36ce-4cd5-b40f-d7aae8bfe831&page=queryresults
[0m18:49:32.214552 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 18:49:31.148655 => 18:49:32.214203
[0m18:49:32.219888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583ba357-7625-4e1f-8443-a14d2a45c064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d916bbb0>]}
[0m18:49:32.224372 [info ] [Thread-1 (]: 1 of 1 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m18:49:32.228574 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m18:49:32.234458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:32.237994 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m18:49:32.241732 [info ] [MainThread]: 
[0m18:49:32.245614 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m18:49:32.249835 [debug] [MainThread]: Command end result
[0m18:49:32.315658 [info ] [MainThread]: 
[0m18:49:32.319224 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:32.322785 [info ] [MainThread]: 
[0m18:49:32.326508 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:49:32.330515 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.0256352, "process_user_time": 5.975132, "process_kernel_time": 0.703198, "process_mem_max_rss": "241948", "process_out_blocks": "4000", "process_in_blocks": "0"}
[0m18:49:32.334409 [debug] [MainThread]: Command `dbt build` succeeded at 18:49:32.334145 after 5.03 seconds
[0m18:49:32.337814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f4fc9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d9919b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d91628c0>]}
[0m18:49:32.341233 [debug] [MainThread]: Flushing usage events
[0m19:27:07.309826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9cf69ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9a5ba6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9a5ba680>]}


============================== 19:27:07.317018 | e23d5ad6-a168-48fa-a25a-7358e1a3a80e ==============================
[0m19:27:07.317018 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:27:07.325370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'fail_fast': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:09.458803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e23d5ad6-a168-48fa-a25a-7358e1a3a80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8181e080>]}
[0m19:27:09.603042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e23d5ad6-a168-48fa-a25a-7358e1a3a80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa817a9000>]}
[0m19:27:09.607938 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m19:27:09.650389 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:27:09.935096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:27:09.939873 [debug] [MainThread]: Partial parsing: added file: nyc_citi_bikes://models/staging/stg_dim_station.sql
[0m19:27:09.950576 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m19:27:10.215925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e23d5ad6-a168-48fa-a25a-7358e1a3a80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa810f5e70>]}
[0m19:27:10.279332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e23d5ad6-a168-48fa-a25a-7358e1a3a80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8108f910>]}
[0m19:27:10.283842 [info ] [MainThread]: Found 2 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m19:27:10.289008 [info ] [MainThread]: 
[0m19:27:10.293399 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:27:10.298424 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m19:27:10.301907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:11.014422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m19:27:11.022728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:11.401537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23d5ad6-a168-48fa-a25a-7358e1a3a80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9b138df0>]}
[0m19:27:11.410714 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:27:11.415343 [info ] [MainThread]: 
[0m19:27:11.423069 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m19:27:11.424049 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m19:27:11.427264 [info ] [Thread-1 (]: 1 of 2 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m19:27:11.437496 [info ] [Thread-2 (]: 2 of 2 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m19:27:11.442066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m19:27:11.447061 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m19:27:11.450843 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m19:27:11.454458 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m19:27:11.463211 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m19:27:11.475774 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m19:27:11.488608 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 19:27:11.457720 => 19:27:11.488084
[0m19:27:11.492947 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m19:27:11.494628 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 19:27:11.466598 => 19:27:11.494178
[0m19:27:11.517500 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m19:27:11.567952 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m19:27:11.570389 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m19:27:11.581908 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:27:11.586875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:11.644626 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  case 
    safe_cast(rideable_type as string)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
  cast(regexp_replace(start_station_id, '[^0-9]', '', 'g') as integer) as start_station_id,
  cast(regexp_replace(pk_column, '[^0-9]', '', 'g') as integer) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  case 
    safe_cast(member_casual as string)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type,
  cast(date_part as date) as date_parts


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m19:27:11.647444 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast(regexp_replace(start_station_id, '[^0-9]', '', 'g') as integer) 
cast("station_name" as string) as station_name,
cast("station_lat" as numeric) as station_lat,
cast("station_lng" as numeric) as station_lng

from stations;


[0m19:27:12.018343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:a237a061-e153-4188-aa53-ce0f823ddab3&page=queryresults
[0m19:27:12.023915 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CAST at [17:1]')
[0m19:27:12.335552 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:0b787b40-18db-4989-82ee-ba900484ed77&page=queryresults
[0m19:27:12.622393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:a14388f9-9cc3-4a7e-b751-8e7ba123a67d&page=queryresults
[0m19:27:12.626767 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for function REGEXP_REPLACE for argument types: STRING, STRING, STRING, STRING. Supported signatures: REGEXP_REPLACE(STRING, STRING, STRING); REGEXP_REPLACE(BYTES, BYTES, BYTES) at [27:8]')
[0m19:27:12.630054 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:a14388f9-9cc3-4a7e-b751-8e7ba123a67d&page=queryresults
[0m19:27:12.638290 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 19:27:11.496289 => 19:27:12.637812
[0m19:27:12.646439 [debug] [Thread-1 (]: Database Error in model stg_dim_station (models/staging/stg_dim_station.sql)
  Syntax error: Expected end of input but got keyword CAST at [17:1]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_dim_station.sql
[0m19:27:12.650320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e23d5ad6-a168-48fa-a25a-7358e1a3a80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9b139b70>]}
[0m19:27:12.654457 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model nyc_citi_bike_rides.stg_dim_station ....... [[31mERROR[0m in 1.21s]
[0m19:27:12.658673 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m19:27:13.328489 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:7c05f7a7-88d6-4aec-9e3b-8eccde26779c&page=queryresults
[0m19:27:13.620751 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:7c05f7a7-88d6-4aec-9e3b-8eccde26779c&page=queryresults
[0m19:27:13.625668 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 19:27:11.532523 => 19:27:13.625202
[0m19:27:13.634880 [debug] [Thread-2 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  No matching signature for function REGEXP_REPLACE for argument types: STRING, STRING, STRING, STRING. Supported signatures: REGEXP_REPLACE(STRING, STRING, STRING); REGEXP_REPLACE(BYTES, BYTES, BYTES) at [27:8]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m19:27:13.638695 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e23d5ad6-a168-48fa-a25a-7358e1a3a80e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9b1171f0>]}
[0m19:27:13.642495 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 2.19s]
[0m19:27:13.646201 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m19:27:13.651625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:13.654943 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m19:27:13.658161 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m19:27:13.661384 [info ] [MainThread]: 
[0m19:27:13.664803 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m19:27:13.669020 [debug] [MainThread]: Command end result
[0m19:27:13.732812 [info ] [MainThread]: 
[0m19:27:13.736613 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:27:13.740300 [info ] [MainThread]: 
[0m19:27:13.743682 [error] [MainThread]:   Database Error in model stg_dim_station (models/staging/stg_dim_station.sql)
  Syntax error: Expected end of input but got keyword CAST at [17:1]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_dim_station.sql
[0m19:27:13.746932 [info ] [MainThread]: 
[0m19:27:13.751064 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  No matching signature for function REGEXP_REPLACE for argument types: STRING, STRING, STRING, STRING. Supported signatures: REGEXP_REPLACE(STRING, STRING, STRING); REGEXP_REPLACE(BYTES, BYTES, BYTES) at [27:8]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m19:27:13.754665 [info ] [MainThread]: 
[0m19:27:13.758340 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:27:13.762338 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 6.5340757, "process_user_time": 6.331409, "process_kernel_time": 0.8184, "process_mem_max_rss": "243364", "process_out_blocks": "4296", "command_success": false, "process_in_blocks": "0"}
[0m19:27:13.766425 [debug] [MainThread]: Command `dbt build` failed at 19:27:13.766198 after 6.54 seconds
[0m19:27:13.770196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9cf69ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8108fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa817a9150>]}
[0m19:27:13.774658 [debug] [MainThread]: Flushing usage events
[0m19:33:33.662810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6d801ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6ae62710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6ae626b0>]}


============================== 19:33:33.666876 | fadd3785-b5fd-4d3f-bf73-dcd6cdeae6d4 ==============================
[0m19:33:33.666876 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:33:33.688340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:33:35.852626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fadd3785-b5fd-4d3f-bf73-dcd6cdeae6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd520e1540>]}
[0m19:33:36.007725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fadd3785-b5fd-4d3f-bf73-dcd6cdeae6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd51fe1b40>]}
[0m19:33:36.013181 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m19:33:36.051639 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:33:36.277471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:33:36.287581 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_dim_station.sql
[0m19:33:36.292181 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m19:33:36.561530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fadd3785-b5fd-4d3f-bf73-dcd6cdeae6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd51991cc0>]}
[0m19:33:36.626983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fadd3785-b5fd-4d3f-bf73-dcd6cdeae6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd519579a0>]}
[0m19:33:36.631172 [info ] [MainThread]: Found 2 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m19:33:36.636883 [info ] [MainThread]: 
[0m19:33:36.641732 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:33:36.647101 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m19:33:36.651383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:37.209812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m19:33:37.214248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:37.586830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fadd3785-b5fd-4d3f-bf73-dcd6cdeae6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6b9f50c0>]}
[0m19:33:37.592790 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:33:37.597068 [info ] [MainThread]: 
[0m19:33:37.604019 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m19:33:37.604919 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m19:33:37.608732 [info ] [Thread-1 (]: 1 of 2 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m19:33:37.613636 [info ] [Thread-2 (]: 2 of 2 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m19:33:37.618743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m19:33:37.624576 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m19:33:37.629203 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m19:33:37.633108 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m19:33:37.642898 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m19:33:37.654275 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m19:33:37.664068 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 19:33:37.637070 => 19:33:37.663553
[0m19:33:37.665453 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 19:33:37.645808 => 19:33:37.664996
[0m19:33:37.667675 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m19:33:37.674982 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m19:33:37.776490 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m19:33:37.772747 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m19:33:37.796348 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:33:37.798308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:33:37.860388 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as integer) as station_id, 
cast("station_name" as string) as station_name,
cast("station_lat" as numeric) as station_lat,
cast("station_lng" as numeric) as station_lng

from stations;


[0m19:33:37.876124 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  case 
    safe_cast(rideable_type as string)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
  cast(start_station_id as integer) as start_station_id,
  cast(end_station_id as integer) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  case 
    safe_cast(member_casual as string)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type,
  cast(date_part as date) as date_parts


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m19:33:38.568355 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:6ba9bef4-7f65-4492-9cb0-4d5c7d3fa508&page=queryresults
[0m19:33:38.598229 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:74bc9fb1-c9b7-412b-8585-3f179ccee471&page=queryresults
[0m19:33:38.961836 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 19:33:37.691046 => 19:33:38.961467
[0m19:33:38.966966 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fadd3785-b5fd-4d3f-bf73-dcd6cdeae6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6b9f6260>]}
[0m19:33:38.972756 [info ] [Thread-2 (]: 2 of 2 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m19:33:38.977412 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m19:33:39.011688 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 19:33:37.678815 => 19:33:39.008056
[0m19:33:39.016867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fadd3785-b5fd-4d3f-bf73-dcd6cdeae6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd5206f910>]}
[0m19:33:39.021424 [info ] [Thread-1 (]: 1 of 2 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m19:33:39.025553 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m19:33:39.032936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:39.037087 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m19:33:39.041105 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m19:33:39.044878 [info ] [MainThread]: 
[0m19:33:39.052692 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m19:33:39.057429 [debug] [MainThread]: Command end result
[0m19:33:39.117763 [info ] [MainThread]: 
[0m19:33:39.122010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:33:39.126063 [info ] [MainThread]: 
[0m19:33:39.130072 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:33:39.134146 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.545546, "process_user_time": 6.496639, "process_kernel_time": 0.819284, "process_mem_max_rss": "242220", "process_out_blocks": "4200", "process_in_blocks": "0"}
[0m19:33:39.138301 [debug] [MainThread]: Command `dbt build` succeeded at 19:33:39.137962 after 5.55 seconds
[0m19:33:39.142342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd6d801ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd51960250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd51957970>]}
[0m19:33:39.146368 [debug] [MainThread]: Flushing usage events
[0m19:36:11.495396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa221b39ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21f18e740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21f18e6e0>]}


============================== 19:36:11.499866 | 1e170eb3-d2e2-41a0-b292-28553017d65b ==============================
[0m19:36:11.499866 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:36:11.514620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m19:36:13.770272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e170eb3-d2e2-41a0-b292-28553017d65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21f2f39a0>]}
[0m19:36:13.924623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e170eb3-d2e2-41a0-b292-28553017d65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa206930670>]}
[0m19:36:13.930243 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m19:36:13.965636 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:36:14.241564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:36:14.245950 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m19:36:14.249985 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_dim_station.sql
[0m19:36:14.531206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e170eb3-d2e2-41a0-b292-28553017d65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa205cd9c90>]}
[0m19:36:14.621918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e170eb3-d2e2-41a0-b292-28553017d65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa205c39270>]}
[0m19:36:14.626702 [info ] [MainThread]: Found 2 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m19:36:14.632092 [info ] [MainThread]: 
[0m19:36:14.636760 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:36:14.641812 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m19:36:14.645960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:15.325094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m19:36:15.329683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:15.764695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e170eb3-d2e2-41a0-b292-28553017d65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21fd0d120>]}
[0m19:36:15.769939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:36:15.775091 [info ] [MainThread]: 
[0m19:36:15.786233 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m19:36:15.787133 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m19:36:15.790806 [info ] [Thread-1 (]: 1 of 2 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m19:36:15.795556 [info ] [Thread-2 (]: 2 of 2 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m19:36:15.800057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m19:36:15.805068 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m19:36:15.817334 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m19:36:15.822624 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m19:36:15.831912 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m19:36:15.843077 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m19:36:15.865599 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 19:36:15.826432 => 19:36:15.865017
[0m19:36:15.870877 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 19:36:15.835113 => 19:36:15.869914
[0m19:36:15.871979 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m19:36:15.876334 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m19:36:15.974320 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m19:36:15.971707 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m19:36:15.987699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:15.990316 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:36:16.054414 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as integer) as station_id, 
cast("station_name" as string) as station_name,
cast("station_lat" as numeric) as station_lat,
cast("station_lng" as numeric) as station_lng
cast("date_part" as date) as date_part

from stations;


[0m19:36:16.060890 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  case 
    safe_cast(rideable_type as string)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
  cast(start_station_id as integer) as start_station_id,
  cast(end_station_id as integer) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  case 
    safe_cast(member_casual as string)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type,
  cast(date_part as date) as date_part


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m19:36:16.468382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:60caab83-e382-4f7a-a912-3864f65a7776&page=queryresults
[0m19:36:16.473846 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CAST at [20:1]')
[0m19:36:16.741597 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:4dcbb8db-844b-4eaf-87d3-28807f5945f6&page=queryresults
[0m19:36:16.788674 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:9b14aaee-ea96-47e3-b620-fca0a115207d&page=queryresults
[0m19:36:16.797124 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:9b14aaee-ea96-47e3-b620-fca0a115207d&page=queryresults
[0m19:36:16.804611 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 19:36:15.879880 => 19:36:16.804004
[0m19:36:16.814735 [debug] [Thread-1 (]: Database Error in model stg_dim_station (models/staging/stg_dim_station.sql)
  Syntax error: Expected end of input but got keyword CAST at [20:1]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_dim_station.sql
[0m19:36:16.819389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e170eb3-d2e2-41a0-b292-28553017d65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21fcf3d90>]}
[0m19:36:16.824129 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model nyc_citi_bike_rides.stg_dim_station ....... [[31mERROR[0m in 1.02s]
[0m19:36:16.829074 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m19:36:17.103284 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 19:36:15.892478 => 19:36:17.102926
[0m19:36:17.108333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e170eb3-d2e2-41a0-b292-28553017d65b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21fcf34f0>]}
[0m19:36:17.113404 [info ] [Thread-2 (]: 2 of 2 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m19:36:17.117759 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m19:36:17.124401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:17.128074 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m19:36:17.131576 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m19:36:17.134757 [info ] [MainThread]: 
[0m19:36:17.138094 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m19:36:17.141957 [debug] [MainThread]: Command end result
[0m19:36:17.226813 [info ] [MainThread]: 
[0m19:36:17.230707 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:17.234443 [info ] [MainThread]: 
[0m19:36:17.237971 [error] [MainThread]:   Database Error in model stg_dim_station (models/staging/stg_dim_station.sql)
  Syntax error: Expected end of input but got keyword CAST at [20:1]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_dim_station.sql
[0m19:36:17.241762 [info ] [MainThread]: 
[0m19:36:17.245163 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:36:17.249130 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 5.833294, "process_user_time": 6.425588, "process_kernel_time": 0.772542, "process_mem_max_rss": "243228", "process_out_blocks": "4248", "command_success": false, "process_in_blocks": "0"}
[0m19:36:17.252980 [debug] [MainThread]: Command `dbt build` failed at 19:36:17.252739 after 5.84 seconds
[0m19:36:17.256563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa221b39ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa205c4d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa205367a90>]}
[0m19:36:17.260253 [debug] [MainThread]: Flushing usage events
[0m19:37:02.677387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90b295ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9088ea710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9088ea6b0>]}


============================== 19:37:02.681252 | 3a2df048-358d-4af1-a7a0-82b76015b64c ==============================
[0m19:37:02.681252 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:37:02.697356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:37:04.575023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a2df048-358d-4af1-a7a0-82b76015b64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8efcd9540>]}
[0m19:37:04.723721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a2df048-358d-4af1-a7a0-82b76015b64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8efbd1b40>]}
[0m19:37:04.728547 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m19:37:04.764625 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:37:04.988162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:04.992492 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_dim_station.sql
[0m19:37:05.229046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a2df048-358d-4af1-a7a0-82b76015b64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8ef3965f0>]}
[0m19:37:05.294208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a2df048-358d-4af1-a7a0-82b76015b64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90963a0b0>]}
[0m19:37:05.298394 [info ] [MainThread]: Found 2 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m19:37:05.303538 [info ] [MainThread]: 
[0m19:37:05.307919 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:37:05.312993 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m19:37:05.316598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:05.821850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m19:37:05.826255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:06.176612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2df048-358d-4af1-a7a0-82b76015b64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa909638d90>]}
[0m19:37:06.181830 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:37:06.185523 [info ] [MainThread]: 
[0m19:37:06.191369 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m19:37:06.192410 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m19:37:06.195311 [info ] [Thread-1 (]: 1 of 2 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m19:37:06.199788 [info ] [Thread-2 (]: 2 of 2 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m19:37:06.203941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m19:37:06.208705 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m19:37:06.212356 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m19:37:06.216213 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m19:37:06.225418 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m19:37:06.242410 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m19:37:06.266862 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 19:37:06.219620 => 19:37:06.266305
[0m19:37:06.268917 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 19:37:06.227752 => 19:37:06.268382
[0m19:37:06.270515 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m19:37:06.274235 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m19:37:06.330520 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m19:37:06.336764 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m19:37:06.346154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:06.347573 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:37:06.401513 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as integer) as station_id, 
cast("station_name" as string) as station_name,
cast("station_lat" as numeric) as station_lat,
cast("station_lng" as numeric) as station_lng,
cast("date_part" as date) as date_part

from stations;


[0m19:37:06.403722 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  case 
    safe_cast(rideable_type as string)
  
        when 'classic_bike' then 1
        when 'electric_bike' then 2
        else 0
    end as ride_type,
  cast(start_station_id as integer) as start_station_id,
  cast(end_station_id as integer) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  case 
    safe_cast(member_casual as string)
  
        when 'member' then 1
        when 'casual' then 2
        else 0
    end as member_type,
  cast(date_part as date) as date_part


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m19:37:06.954126 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:a12aa09c-1b7b-423f-812b-0c5b87a10487&page=queryresults
[0m19:37:07.055483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:ebcfb791-797b-4703-a158-1f156974d8fa&page=queryresults
[0m19:37:07.277206 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 19:37:06.303197 => 19:37:07.276869
[0m19:37:07.282230 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2df048-358d-4af1-a7a0-82b76015b64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8efa61f00>]}
[0m19:37:07.286151 [info ] [Thread-2 (]: 2 of 2 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m19:37:07.290396 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m19:37:07.770071 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 19:37:06.277923 => 19:37:07.769736
[0m19:37:07.775190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2df048-358d-4af1-a7a0-82b76015b64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eea53e20>]}
[0m19:37:07.779581 [info ] [Thread-1 (]: 1 of 2 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.57s]
[0m19:37:07.783705 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m19:37:07.789446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:07.793348 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m19:37:07.797449 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m19:37:07.801006 [info ] [MainThread]: 
[0m19:37:07.804867 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m19:37:07.809306 [debug] [MainThread]: Command end result
[0m19:37:07.871827 [info ] [MainThread]: 
[0m19:37:07.876251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:07.880046 [info ] [MainThread]: 
[0m19:37:07.884090 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:37:07.888223 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.283674, "process_user_time": 6.063168, "process_kernel_time": 0.719699, "process_mem_max_rss": "242288", "process_out_blocks": "4192", "process_in_blocks": "0"}
[0m19:37:07.892550 [debug] [MainThread]: Command `dbt build` succeeded at 19:37:07.892265 after 5.29 seconds
[0m19:37:07.897100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90b295ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8efbd1b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8eea147c0>]}
[0m19:37:07.901111 [debug] [MainThread]: Flushing usage events
[0m20:23:21.544608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dee86ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3debec2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3debec2620>]}


============================== 20:23:21.548436 | 85ef7c04-e3c2-4585-9f64-18a1e9bf753c ==============================
[0m20:23:21.548436 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:23:21.561216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:23:23.567673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85ef7c04-e3c2-4585-9f64-18a1e9bf753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd32cc760>]}
[0m20:23:23.707106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85ef7c04-e3c2-4585-9f64-18a1e9bf753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd31c6dd0>]}
[0m20:23:23.712641 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:23:23.751630 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:23:23.990360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m20:23:23.994699 [debug] [MainThread]: Partial parsing: added file: nyc_citi_bikes://models/core/fact_rides.sql
[0m20:23:23.998536 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://macros/get_ride_type.sql
[0m20:23:24.002575 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://macros/get_member_type.sql
[0m20:23:24.006323 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m20:23:24.263983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85ef7c04-e3c2-4585-9f64-18a1e9bf753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd29d6200>]}
[0m20:23:24.325772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85ef7c04-e3c2-4585-9f64-18a1e9bf753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd294bf40>]}
[0m20:23:24.329850 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:23:24.335155 [info ] [MainThread]: 
[0m20:23:24.339706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:23:24.344685 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:23:24.348753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:24.899081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:23:24.903483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:25.259573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85ef7c04-e3c2-4585-9f64-18a1e9bf753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd294aad0>]}
[0m20:23:25.264573 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:23:25.268708 [info ] [MainThread]: 
[0m20:23:25.275028 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:23:25.275815 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:23:25.278978 [info ] [Thread-1 (]: 1 of 2 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:23:25.282935 [info ] [Thread-2 (]: 2 of 2 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:23:25.287105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:23:25.291297 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:23:25.295216 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:23:25.299162 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:23:25.308645 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:23:25.319719 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:23:25.332802 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:23:25.302907 => 20:23:25.332190
[0m20:23:25.334786 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:23:25.311455 => 20:23:25.334256
[0m20:23:25.336346 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:23:25.340164 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:23:25.430986 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:23:25.427739 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:23:25.445395 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:23:25.446912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:25.498997 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as integer) as start_station_id,
  cast(end_station_id as integer) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type,
  cast(date_part as date) as date_part


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:23:25.501357 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as integer) as station_id, 
cast("station_name" as string) as station_name,
cast("station_lat" as numeric) as station_lat,
cast("station_lng" as numeric) as station_lng,
cast("date_part" as date) as date_part

from stations;


[0m20:23:25.948850 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:d4f6286f-0952-4368-9ef1-6a164a12815a&page=queryresults
[0m20:23:25.953861 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CASE at [21:3]')
[0m20:23:26.191113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:6085c375-604f-456f-8127-b220c139d07e&page=queryresults
[0m20:23:26.599541 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:23:25.343419 => 20:23:26.599176
[0m20:23:26.605237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ef7c04-e3c2-4585-9f64-18a1e9bf753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd2024820>]}
[0m20:23:26.609763 [info ] [Thread-1 (]: 1 of 2 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m20:23:26.614315 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:23:27.147278 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:6f01dc33-92b3-4c2f-a51a-bb015db6a7cd&page=queryresults
[0m20:23:27.152414 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:6f01dc33-92b3-4c2f-a51a-bb015db6a7cd&page=queryresults
[0m20:23:27.157340 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:23:25.350074 => 20:23:27.156907
[0m20:23:27.165778 [debug] [Thread-2 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected end of input but got keyword CASE at [21:3]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m20:23:27.170148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ef7c04-e3c2-4585-9f64-18a1e9bf753c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3decb08430>]}
[0m20:23:27.174870 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 1.88s]
[0m20:23:27.179195 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:23:27.185337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:27.189356 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:23:27.193181 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:23:27.196907 [info ] [MainThread]: 
[0m20:23:27.200427 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m20:23:27.204895 [debug] [MainThread]: Command end result
[0m20:23:27.260215 [info ] [MainThread]: 
[0m20:23:27.264463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:23:27.268021 [info ] [MainThread]: 
[0m20:23:27.271906 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected end of input but got keyword CASE at [21:3]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m20:23:27.275464 [info ] [MainThread]: 
[0m20:23:27.278873 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:23:27.282655 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 5.814894, "process_user_time": 6.26621, "process_kernel_time": 0.69579, "process_mem_max_rss": "242788", "process_out_blocks": "4272", "command_success": false, "process_in_blocks": "0"}
[0m20:23:27.286312 [debug] [MainThread]: Command `dbt build` failed at 20:23:27.286022 after 5.82 seconds
[0m20:23:27.289741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dee86ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dd29580a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3decae2c20>]}
[0m20:23:27.293248 [debug] [MainThread]: Flushing usage events
[0m20:25:32.417778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d75b9ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d731f2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d731f26e0>]}


============================== 20:25:32.421720 | 1a385c27-be00-4f76-8822-ec1592e78414 ==============================
[0m20:25:32.421720 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:25:32.431721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:25:34.346659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a385c27-be00-4f76-8822-ec1592e78414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d733579a0>]}
[0m20:25:34.487259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a385c27-be00-4f76-8822-ec1592e78414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d5a938670>]}
[0m20:25:34.492655 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:25:34.528178 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:25:34.710235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:34.714549 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m20:25:34.965001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a385c27-be00-4f76-8822-ec1592e78414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d59cf6140>]}
[0m20:25:35.031599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a385c27-be00-4f76-8822-ec1592e78414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d59c2da50>]}
[0m20:25:35.035158 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:25:35.039774 [info ] [MainThread]: 
[0m20:25:35.044493 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:25:35.049622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:25:35.053400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:35.570555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:25:35.575775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:35.940067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a385c27-be00-4f76-8822-ec1592e78414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d73d55a20>]}
[0m20:25:35.945082 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:35.948741 [info ] [MainThread]: 
[0m20:25:35.954699 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:25:35.955471 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:25:35.958696 [info ] [Thread-1 (]: 1 of 2 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:25:35.962091 [info ] [Thread-2 (]: 2 of 2 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:25:35.966235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:25:35.970603 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:25:35.974076 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:25:35.977438 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:25:35.986380 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:25:35.998873 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:25:36.007078 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:25:35.980566 => 20:25:36.006573
[0m20:25:36.010966 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:25:36.012149 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:25:35.990189 => 20:25:36.011679
[0m20:25:36.037516 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:25:36.093689 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:25:36.089574 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:25:36.106132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:36.109057 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:25:36.166223 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as integer) as station_id, 
cast("station_name" as string) as station_name,
cast("station_lat" as numeric) as station_lat,
cast("station_lng" as numeric) as station_lng,
cast("date_part" as date) as date_part

from stations;


[0m20:25:36.169017 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as integer) as start_station_id,
  cast(end_station_id as integer) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type,
  cast(date_part as date) as date_part


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:25:36.551627 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:88184430-f065-4a21-a364-73d788cc9bd6&page=queryresults
[0m20:25:36.556362 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CASE at [21:3]')
[0m20:25:36.821176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:61d64d2b-7967-47f6-a192-6720d11089c7&page=queryresults
[0m20:25:37.183844 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:25:36.014545 => 20:25:37.183478
[0m20:25:37.189536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a385c27-be00-4f76-8822-ec1592e78414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d73f37a00>]}
[0m20:25:37.193849 [info ] [Thread-1 (]: 1 of 2 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m20:25:37.198544 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:25:37.486912 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:584b6394-bcc8-4807-a9d3-1d7e883a2626&page=queryresults
[0m20:25:37.491712 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:584b6394-bcc8-4807-a9d3-1d7e883a2626&page=queryresults
[0m20:25:37.496019 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:25:36.053424 => 20:25:37.495588
[0m20:25:37.504958 [debug] [Thread-2 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected end of input but got keyword CASE at [21:3]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m20:25:37.509111 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a385c27-be00-4f76-8822-ec1592e78414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d73d55a20>]}
[0m20:25:37.513130 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 1.54s]
[0m20:25:37.517048 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:25:37.522602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:37.526366 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:25:37.529693 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:25:37.533280 [info ] [MainThread]: 
[0m20:25:37.536902 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m20:25:37.540989 [debug] [MainThread]: Command end result
[0m20:25:37.596454 [info ] [MainThread]: 
[0m20:25:37.600539 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:25:37.604125 [info ] [MainThread]: 
[0m20:25:37.607931 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected end of input but got keyword CASE at [21:3]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m20:25:37.612186 [info ] [MainThread]: 
[0m20:25:37.615757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:25:37.619370 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 5.2728214, "process_user_time": 6.181887, "process_kernel_time": 0.680611, "process_mem_max_rss": "242948", "process_out_blocks": "4248", "command_success": false, "process_in_blocks": "0"}
[0m20:25:37.623202 [debug] [MainThread]: Command `dbt build` failed at 20:25:37.622961 after 5.28 seconds
[0m20:25:37.626861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d75b9ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d73f36d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d73f36710>]}
[0m20:25:37.630629 [debug] [MainThread]: Flushing usage events
[0m20:26:55.392812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5477181ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54747e2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54747e25f0>]}


============================== 20:26:55.396777 | 94c4cb28-6998-423c-900e-f729e17aa636 ==============================
[0m20:26:55.396777 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:26:55.412021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:26:57.417608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94c4cb28-6998-423c-900e-f729e17aa636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f547494b9a0>]}
[0m20:26:57.552888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94c4cb28-6998-423c-900e-f729e17aa636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545b901a80>]}
[0m20:26:57.558062 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:26:57.594444 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:26:57.867915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:57.872090 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m20:26:58.131087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94c4cb28-6998-423c-900e-f729e17aa636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545b2da050>]}
[0m20:26:58.203908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94c4cb28-6998-423c-900e-f729e17aa636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545b205960>]}
[0m20:26:58.207984 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:26:58.213139 [info ] [MainThread]: 
[0m20:26:58.218131 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:26:58.226204 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:26:58.230541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:58.757444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:26:58.761224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:59.105177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94c4cb28-6998-423c-900e-f729e17aa636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54753497b0>]}
[0m20:26:59.112056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:26:59.116392 [info ] [MainThread]: 
[0m20:26:59.124880 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:26:59.125705 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:26:59.129032 [info ] [Thread-1 (]: 1 of 2 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:26:59.133418 [info ] [Thread-2 (]: 2 of 2 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:26:59.137825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:26:59.142156 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:26:59.146128 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:26:59.149451 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:26:59.158040 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:26:59.172163 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:26:59.181235 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:26:59.152556 => 20:26:59.180698
[0m20:26:59.182854 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:26:59.160982 => 20:26:59.182389
[0m20:26:59.186516 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:26:59.192420 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:26:59.267756 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:26:59.268772 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:26:59.281860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:59.282769 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:26:59.359909 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as integer) as station_id, 
cast("station_name" as string) as station_name,
cast("station_lat" as numeric) as station_lat,
cast("station_lng" as numeric) as station_lng,
cast("date_part" as date) as date_part

from stations;


[0m20:26:59.365852 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as integer) as start_station_id,
  cast(end_station_id as integer) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type,
  


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:26:59.733331 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:60278533-4d67-4bb5-96a2-0b5fe023a149&page=queryresults
[0m20:26:59.737661 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CASE at [21:3]')
[0m20:27:00.176852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:e1460699-a5c1-4184-b85c-b0190e5a0f40&page=queryresults
[0m20:27:00.286919 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:b36f1f0f-cafa-4405-974e-dab7bd408743&page=queryresults
[0m20:27:00.292340 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:b36f1f0f-cafa-4405-974e-dab7bd408743&page=queryresults
[0m20:27:00.297588 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:26:59.219750 => 20:27:00.297098
[0m20:27:00.312615 [debug] [Thread-2 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected end of input but got keyword CASE at [21:3]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m20:27:00.317603 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c4cb28-6998-423c-900e-f729e17aa636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f547532b2b0>]}
[0m20:27:00.322484 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 1.18s]
[0m20:27:00.327933 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:27:00.617590 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:26:59.195804 => 20:27:00.617227
[0m20:27:00.622642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c4cb28-6998-423c-900e-f729e17aa636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f547532bee0>]}
[0m20:27:00.627102 [info ] [Thread-1 (]: 1 of 2 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m20:27:00.631312 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:27:00.636923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:00.640675 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:27:00.644209 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:27:00.647896 [info ] [MainThread]: 
[0m20:27:00.651852 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m20:27:00.656540 [debug] [MainThread]: Command end result
[0m20:27:00.717129 [info ] [MainThread]: 
[0m20:27:00.722505 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:27:00.726575 [info ] [MainThread]: 
[0m20:27:00.730696 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected end of input but got keyword CASE at [21:3]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m20:27:00.734538 [info ] [MainThread]: 
[0m20:27:00.737851 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:27:00.742539 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 5.426039, "process_user_time": 6.504327, "process_kernel_time": 0.832846, "process_mem_max_rss": "242996", "process_out_blocks": "4248", "command_success": false, "process_in_blocks": "0"}
[0m20:27:00.748828 [debug] [MainThread]: Command `dbt build` failed at 20:27:00.748478 after 5.43 seconds
[0m20:27:00.752422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5477181ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545b901a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f547532a470>]}
[0m20:27:00.756434 [debug] [MainThread]: Flushing usage events
[0m20:29:06.199226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a61ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77c726e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae77c72680>]}


============================== 20:29:06.203046 | e23fc4b3-8afc-410f-be7b-2403e7a973bd ==============================
[0m20:29:06.203046 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:29:06.211283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:29:08.181751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e23fc4b3-8afc-410f-be7b-2403e7a973bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5eeaa080>]}
[0m20:29:08.335955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e23fc4b3-8afc-410f-be7b-2403e7a973bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5ee35000>]}
[0m20:29:08.341636 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:29:08.379762 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:29:08.645858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:29:08.650589 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m20:29:08.909948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e23fc4b3-8afc-410f-be7b-2403e7a973bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5e77a0e0>]}
[0m20:29:08.971024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e23fc4b3-8afc-410f-be7b-2403e7a973bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5e6a5a80>]}
[0m20:29:08.975263 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:29:08.980493 [info ] [MainThread]: 
[0m20:29:08.984961 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:29:08.990024 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:29:08.993904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:09.532325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:29:09.537040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:09.900703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e23fc4b3-8afc-410f-be7b-2403e7a973bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae78801990>]}
[0m20:29:09.905599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:29:09.909792 [info ] [MainThread]: 
[0m20:29:09.916306 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:29:09.917089 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:29:09.920050 [info ] [Thread-1 (]: 1 of 2 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:29:09.923677 [info ] [Thread-2 (]: 2 of 2 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:29:09.927751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:29:09.931886 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:29:09.935402 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:29:09.939253 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:29:09.948288 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:29:09.960631 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:29:09.973008 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:29:09.942673 => 20:29:09.972396
[0m20:29:09.974897 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:29:09.951547 => 20:29:09.974503
[0m20:29:09.976814 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:29:09.980662 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:29:10.054259 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:29:10.056701 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:29:10.070386 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:29:10.071271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:10.130005 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as integer) as start_station_id,
  cast(end_station_id as integer) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:29:10.131525 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as integer) as station_id, 
cast("station_name" as string) as station_name,
cast("station_lat" as numeric) as station_lat,
cast("station_lng" as numeric) as station_lng,
cast("date_part" as date) as date_part

from stations;


[0m20:29:10.516523 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:5810955f-644c-4bbf-beba-c19c527e185e&page=queryresults
[0m20:29:10.521740 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword CASE at [21:3]')
[0m20:29:10.899336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:6a34bcef-317d-4a3c-8413-54e9debb45f2&page=queryresults
[0m20:29:11.504424 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:29:09.984029 => 20:29:11.504035
[0m20:29:11.510000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e23fc4b3-8afc-410f-be7b-2403e7a973bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5e6172e0>]}
[0m20:29:11.514499 [info ] [Thread-1 (]: 1 of 2 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m20:29:11.519722 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:29:11.610812 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:d8f65121-bb57-4607-adbf-9cecbb57bb74&page=queryresults
[0m20:29:11.615780 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:d8f65121-bb57-4607-adbf-9cecbb57bb74&page=queryresults
[0m20:29:11.620949 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:29:10.007039 => 20:29:11.620472
[0m20:29:11.629092 [debug] [Thread-2 (]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected end of input but got keyword CASE at [21:3]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m20:29:11.633664 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e23fc4b3-8afc-410f-be7b-2403e7a973bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5e6757b0>]}
[0m20:29:11.638228 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 1.70s]
[0m20:29:11.642693 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:29:11.648688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:11.652440 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:29:11.656234 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:29:11.660100 [info ] [MainThread]: 
[0m20:29:11.664015 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m20:29:11.669201 [debug] [MainThread]: Command end result
[0m20:29:11.728949 [info ] [MainThread]: 
[0m20:29:11.733319 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:29:11.736920 [info ] [MainThread]: 
[0m20:29:11.740560 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected end of input but got keyword CASE at [21:3]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m20:29:11.744355 [info ] [MainThread]: 
[0m20:29:11.748064 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:29:11.751693 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 5.626444, "process_user_time": 6.18426, "process_kernel_time": 0.752796, "process_mem_max_rss": "242792", "process_out_blocks": "4240", "command_success": false, "process_in_blocks": "0"}
[0m20:29:11.755529 [debug] [MainThread]: Command `dbt build` failed at 20:29:11.755305 after 5.63 seconds
[0m20:29:11.759551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7a61ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5eead300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae5eca92a0>]}
[0m20:29:11.763332 [debug] [MainThread]: Flushing usage events
[0m20:30:13.325342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b19821ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b16e82740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b16e826e0>]}


============================== 20:30:13.329289 | 901ebf5b-0fc7-4019-beb1-a04b4345298e ==============================
[0m20:30:13.329289 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:30:13.341523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:30:15.319539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '901ebf5b-0fc7-4019-beb1-a04b4345298e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b16fe79a0>]}
[0m20:30:15.462055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '901ebf5b-0fc7-4019-beb1-a04b4345298e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afe61c670>]}
[0m20:30:15.467830 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:30:15.507066 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:30:15.764832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:30:15.768747 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m20:30:16.039900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '901ebf5b-0fc7-4019-beb1-a04b4345298e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afd9ae140>]}
[0m20:30:16.108156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '901ebf5b-0fc7-4019-beb1-a04b4345298e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afd8e5a50>]}
[0m20:30:16.113174 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:30:16.118098 [info ] [MainThread]: 
[0m20:30:16.122423 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:30:16.127269 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:30:16.131273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:16.720186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:30:16.725078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:17.084797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '901ebf5b-0fc7-4019-beb1-a04b4345298e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b17a29a20>]}
[0m20:30:17.090415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:30:17.094555 [info ] [MainThread]: 
[0m20:30:17.101754 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:30:17.102533 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:30:17.106316 [info ] [Thread-1 (]: 1 of 2 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:30:17.110541 [info ] [Thread-2 (]: 2 of 2 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:30:17.115290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:30:17.119717 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:30:17.124061 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:30:17.128241 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:30:17.137120 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:30:17.147849 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:30:17.157316 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:30:17.131531 => 20:30:17.156830
[0m20:30:17.160187 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:30:17.140131 => 20:30:17.159684
[0m20:30:17.161280 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:30:17.164994 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:30:17.231326 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:30:17.234719 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:30:17.243794 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:30:17.246157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:17.305286 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as integer) as start_station_id,
  cast(end_station_id as integer) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:30:17.308927 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as integer) as station_id, 
cast("station_name" as string) as station_name,
cast("station_lat" as numeric) as station_lat,
cast("station_lng" as numeric) as station_lng,
cast("date_part" as date) as date_part

from stations;


[0m20:30:17.947294 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:8a39d215-2ce8-407b-921f-4de56cf87b47&page=queryresults
[0m20:30:18.049048 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:9d465ea2-54a3-4583-8a82-9d2ef9c9a090&page=queryresults
[0m20:30:18.297592 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:30:17.190076 => 20:30:18.297246
[0m20:30:18.303133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '901ebf5b-0fc7-4019-beb1-a04b4345298e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b17a288b0>]}
[0m20:30:18.307724 [info ] [Thread-2 (]: 2 of 2 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m20:30:18.312126 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:30:18.354250 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:30:17.168829 => 20:30:18.353895
[0m20:30:18.359501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '901ebf5b-0fc7-4019-beb1-a04b4345298e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b17a0bac0>]}
[0m20:30:18.363972 [info ] [Thread-1 (]: 1 of 2 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m20:30:18.368317 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:30:18.374382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:18.378738 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:30:18.382807 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:30:18.386848 [info ] [MainThread]: 
[0m20:30:18.390784 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m20:30:18.401021 [debug] [MainThread]: Command end result
[0m20:30:18.461804 [info ] [MainThread]: 
[0m20:30:18.465719 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:18.469059 [info ] [MainThread]: 
[0m20:30:18.472651 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:30:18.476427 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.2331862, "process_user_time": 6.316399, "process_kernel_time": 0.704109, "process_mem_max_rss": "242328", "process_out_blocks": "4192", "process_in_blocks": "0"}
[0m20:30:18.480496 [debug] [MainThread]: Command `dbt build` succeeded at 20:30:18.480025 after 5.24 seconds
[0m20:30:18.484358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b19821ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afd964040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2afd8e59c0>]}
[0m20:30:18.488117 [debug] [MainThread]: Flushing usage events
[0m20:43:06.676099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3deab1ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de817e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de817e6b0>]}


============================== 20:43:06.681211 | a662697a-3b90-403c-8a0c-6fa509bcbe83 ==============================
[0m20:43:06.681211 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:43:06.697962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:08.716558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a662697a-3b90-403c-8a0c-6fa509bcbe83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcf309540>]}
[0m20:43:08.851371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a662697a-3b90-403c-8a0c-6fa509bcbe83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcf201b40>]}
[0m20:43:08.856837 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:43:08.893804 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:43:09.130079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:43:09.134351 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m20:43:09.137602 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_dim_station.sql
[0m20:43:09.140906 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/core/fact_rides.sql
[0m20:43:09.398387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a662697a-3b90-403c-8a0c-6fa509bcbe83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcebde170>]}
[0m20:43:09.462999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a662697a-3b90-403c-8a0c-6fa509bcbe83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dceb453c0>]}
[0m20:43:09.466980 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:43:09.472188 [info ] [MainThread]: 
[0m20:43:09.476540 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:43:09.482204 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:43:09.485931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:10.021362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:43:10.025891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:10.415592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a662697a-3b90-403c-8a0c-6fa509bcbe83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de8ce4100>]}
[0m20:43:10.420733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:43:10.424628 [info ] [MainThread]: 
[0m20:43:10.431111 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:43:10.431889 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:43:10.435102 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:43:10.439063 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:43:10.443255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:43:10.447685 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:43:10.451664 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:43:10.455269 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:43:10.464410 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:43:10.475299 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:43:10.485243 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:43:10.459010 => 20:43:10.484759
[0m20:43:10.487000 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:43:10.467394 => 20:43:10.486571
[0m20:43:10.488993 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:43:10.492799 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:43:10.588285 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:43:10.585965 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:43:10.600513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:10.602265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:43:10.656685 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m20:43:10.657686 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:43:11.341066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:3dda3f1f-0714-4323-9f17-71e4b723f189&page=queryresults
[0m20:43:11.357181 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:4e39cacc-2585-4a26-8ca0-f8bce0d7a046&page=queryresults
[0m20:43:11.714637 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:43:10.507940 => 20:43:11.714258
[0m20:43:11.718819 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:43:10.496357 => 20:43:11.718467
[0m20:43:11.720340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a662697a-3b90-403c-8a0c-6fa509bcbe83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcf291c00>]}
[0m20:43:11.725438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a662697a-3b90-403c-8a0c-6fa509bcbe83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3de8cc6d10>]}
[0m20:43:11.731397 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m20:43:11.734340 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m20:43:11.738575 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:43:11.743787 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:43:11.752481 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m20:43:11.756727 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m20:43:11.761438 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m20:43:11.765787 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m20:43:11.776093 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m20:43:11.793034 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 20:43:11.769562 => 20:43:11.792499
[0m20:43:11.797288 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m20:43:11.844813 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m20:43:11.862039 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:43:11.916095 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.start_station_name,
start_station.end_station_name,
start_station.start_location_id,
end_station.end_location_id

FROM rides 
INNER JOIN stations start_station ON rides.station_id = start_station.station_id
INNER JOIN stations end_station ON rides.station_id = end_station.station_id
    );
  
[0m20:43:12.260573 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:f8079e73-caeb-48cc-b592-3a1c4af1cfba&page=queryresults
[0m20:43:12.266289 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]')
[0m20:43:13.188418 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:f12df55e-b6c2-43fa-a580-cbfd055fbb5d&page=queryresults
[0m20:43:13.193631 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:f12df55e-b6c2-43fa-a580-cbfd055fbb5d&page=queryresults
[0m20:43:13.197948 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 20:43:11.801319 => 20:43:13.197493
[0m20:43:13.206688 [debug] [Thread-4 (]: Database Error in model fact_rides (models/core/fact_rides.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]
  compiled Code at target/run/nyc_citi_bikes/models/core/fact_rides.sql
[0m20:43:13.211106 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a662697a-3b90-403c-8a0c-6fa509bcbe83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcf293310>]}
[0m20:43:13.215326 [error] [Thread-4 (]: 3 of 3 ERROR creating sql table model nyc_citi_bike_rides.fact_rides ........... [[31mERROR[0m in 1.45s]
[0m20:43:13.219390 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m20:43:13.225567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:13.229278 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:43:13.232866 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:43:13.236575 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m20:43:13.240672 [info ] [MainThread]: 
[0m20:43:13.244135 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m20:43:13.248273 [debug] [MainThread]: Command end result
[0m20:43:13.310191 [info ] [MainThread]: 
[0m20:43:13.313976 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:43:13.317772 [info ] [MainThread]: 
[0m20:43:13.321472 [error] [MainThread]:   Database Error in model fact_rides (models/core/fact_rides.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [22:1]
  compiled Code at target/run/nyc_citi_bikes/models/core/fact_rides.sql
[0m20:43:13.325051 [info ] [MainThread]: 
[0m20:43:13.329560 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:43:13.333699 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 6.7372675, "process_user_time": 6.587516, "process_kernel_time": 0.836061, "process_mem_max_rss": "245492", "process_out_blocks": "4416", "command_success": false, "process_in_blocks": "0"}
[0m20:43:13.337455 [debug] [MainThread]: Command `dbt build` failed at 20:43:13.337229 after 6.74 seconds
[0m20:43:13.341042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3deab1ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dceb45330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dceb453c0>]}
[0m20:43:13.344526 [debug] [MainThread]: Flushing usage events
[0m20:44:10.679822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ef329ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ec97e740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ec97e6e0>]}


============================== 20:44:10.683968 | 6b8d9bde-f6c5-48db-b0de-4ea6e8ee30ff ==============================
[0m20:44:10.683968 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:44:10.700520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:12.930294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b8d9bde-f6c5-48db-b0de-4ea6e8ee30ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ecadf9a0>]}
[0m20:44:13.087222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b8d9bde-f6c5-48db-b0de-4ea6e8ee30ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d8114670>]}
[0m20:44:13.093190 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:44:13.139201 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:44:13.528964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:44:13.533678 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/core/fact_rides.sql
[0m20:44:13.810115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b8d9bde-f6c5-48db-b0de-4ea6e8ee30ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d33d40d0>]}
[0m20:44:13.891256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b8d9bde-f6c5-48db-b0de-4ea6e8ee30ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ed506740>]}
[0m20:44:13.896448 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:44:13.903960 [info ] [MainThread]: 
[0m20:44:13.910747 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:44:13.923974 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:44:13.930179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:14.460841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:44:14.469505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:14.844036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b8d9bde-f6c5-48db-b0de-4ea6e8ee30ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ee4fc820>]}
[0m20:44:14.849621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:44:14.854165 [info ] [MainThread]: 
[0m20:44:14.861647 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:44:14.862866 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:44:14.866283 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:44:14.870949 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:44:14.876405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:44:14.883660 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:44:14.888554 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:44:14.893518 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:44:14.903827 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:44:14.928743 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:44:14.937890 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:44:14.897607 => 20:44:14.937278
[0m20:44:14.941899 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:44:14.906575 => 20:44:14.941140
[0m20:44:14.942850 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:44:14.946708 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:44:15.029635 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:44:15.030874 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:44:15.041806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:15.047377 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:44:15.134620 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m20:44:15.137944 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:44:15.686960 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:ee11f669-dc51-4a6d-af29-a2ba8c044597&page=queryresults
[0m20:44:15.743939 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:b9191a52-2621-406f-a17a-700b655357a9&page=queryresults
[0m20:44:16.087699 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:44:14.949967 => 20:44:16.087262
[0m20:44:16.093486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8d9bde-f6c5-48db-b0de-4ea6e8ee30ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d2a946d0>]}
[0m20:44:16.098002 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m20:44:16.104452 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:44:16.150462 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:44:14.968926 => 20:44:16.150092
[0m20:44:16.158408 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8d9bde-f6c5-48db-b0de-4ea6e8ee30ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ee4fc820>]}
[0m20:44:16.162686 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m20:44:16.167459 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:44:16.172800 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m20:44:16.176961 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m20:44:16.182086 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m20:44:16.186184 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m20:44:16.196353 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m20:44:16.209672 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 20:44:16.189911 => 20:44:16.209133
[0m20:44:16.213632 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m20:44:16.266629 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m20:44:16.285159 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:44:16.370125 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.start_station_name,
start_station.end_station_name,
start_station.start_location_id,
end_station.end_location_id

FROM rides 
INNER JOIN stations start_station ON rides.station_id = start_station.station_id
INNER JOIN stations end_station ON rides.station_id = end_station.station_id
    );
  
[0m20:44:17.070439 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:87f04cfa-dfc9-4f2c-aeb8-a202fa97c9f0&page=queryresults
[0m20:44:17.345274 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name station_id not found inside rides at [41:44]')
[0m20:44:18.245753 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:63d85efb-103c-49d6-805f-d52d048caa42&page=queryresults
[0m20:44:18.529495 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:63d85efb-103c-49d6-805f-d52d048caa42&page=queryresults
[0m20:44:18.534777 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 20:44:16.217154 => 20:44:18.534285
[0m20:44:18.543733 [debug] [Thread-4 (]: Database Error in model fact_rides (models/core/fact_rides.sql)
  Name station_id not found inside rides at [41:44]
  compiled Code at target/run/nyc_citi_bikes/models/core/fact_rides.sql
[0m20:44:18.547942 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8d9bde-f6c5-48db-b0de-4ea6e8ee30ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d2a9cdc0>]}
[0m20:44:18.552723 [error] [Thread-4 (]: 3 of 3 ERROR creating sql table model nyc_citi_bike_rides.fact_rides ........... [[31mERROR[0m in 2.37s]
[0m20:44:18.557221 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m20:44:18.563571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:18.567741 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:44:18.571721 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:44:18.575997 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m20:44:18.579880 [info ] [MainThread]: 
[0m20:44:18.583909 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m20:44:18.588728 [debug] [MainThread]: Command end result
[0m20:44:18.671737 [info ] [MainThread]: 
[0m20:44:18.675752 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:44:18.679647 [info ] [MainThread]: 
[0m20:44:18.683604 [error] [MainThread]:   Database Error in model fact_rides (models/core/fact_rides.sql)
  Name station_id not found inside rides at [41:44]
  compiled Code at target/run/nyc_citi_bikes/models/core/fact_rides.sql
[0m20:44:18.687070 [info ] [MainThread]: 
[0m20:44:18.690749 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:44:18.694452 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.095247, "process_user_time": 7.365429, "process_kernel_time": 0.837444, "process_mem_max_rss": "245748", "process_out_blocks": "4400", "command_success": false, "process_in_blocks": "0"}
[0m20:44:18.698284 [debug] [MainThread]: Command `dbt build` failed at 20:44:18.697956 after 8.10 seconds
[0m20:44:18.702390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ef329ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d3912020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93ed4e7370>]}
[0m20:44:18.706563 [debug] [MainThread]: Flushing usage events
[0m20:46:29.924293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1774ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14db26e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d14db2680>]}


============================== 20:46:29.927991 | 13648ef3-28e4-401c-a866-0aad40dd8b6b ==============================
[0m20:46:29.927991 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:46:29.940154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:46:31.849474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13648ef3-28e4-401c-a866-0aad40dd8b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfbf3e080>]}
[0m20:46:31.987377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13648ef3-28e4-401c-a866-0aad40dd8b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfbec5000>]}
[0m20:46:31.992718 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:46:32.035111 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:46:32.287011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:32.291610 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/core/fact_rides.sql
[0m20:46:32.532540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13648ef3-28e4-401c-a866-0aad40dd8b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfb7d00d0>]}
[0m20:46:32.600041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13648ef3-28e4-401c-a866-0aad40dd8b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1594a410>]}
[0m20:46:32.604101 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:46:32.609384 [info ] [MainThread]: 
[0m20:46:32.613963 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:46:32.619384 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:46:32.623582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:33.129088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:46:33.133334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:33.685967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13648ef3-28e4-401c-a866-0aad40dd8b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d15948070>]}
[0m20:46:33.691028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:33.695117 [info ] [MainThread]: 
[0m20:46:33.701339 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:46:33.702368 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:46:33.705308 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:46:33.709296 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:46:33.713616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:46:33.718323 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:46:33.723174 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:46:33.727142 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:46:33.736710 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:46:33.754028 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:46:33.772658 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:46:33.730722 => 20:46:33.772023
[0m20:46:33.773575 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:46:33.739326 => 20:46:33.773100
[0m20:46:33.776804 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:46:33.780864 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:46:33.839609 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:46:33.843496 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:46:33.856675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:33.858908 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:46:33.912469 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m20:46:33.918357 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:46:34.438496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:967353aa-3362-4bb4-b6be-b196f944e693&page=queryresults
[0m20:46:34.497724 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:0da9a1f4-5400-4313-bd69-5a4ade57e7e5&page=queryresults
[0m20:46:34.773679 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:46:33.784464 => 20:46:34.773267
[0m20:46:34.779078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13648ef3-28e4-401c-a866-0aad40dd8b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfaeb85e0>]}
[0m20:46:34.783812 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m20:46:34.788414 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:46:34.818629 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:46:33.808820 => 20:46:34.818273
[0m20:46:34.823632 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13648ef3-28e4-401c-a866-0aad40dd8b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfaeb85e0>]}
[0m20:46:34.828776 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m20:46:34.833264 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:46:34.838036 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m20:46:34.842289 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m20:46:34.846930 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m20:46:34.850611 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m20:46:34.859543 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m20:46:34.872459 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 20:46:34.853843 => 20:46:34.871570
[0m20:46:34.876758 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m20:46:34.924383 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m20:46:34.938255 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:46:34.991659 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.start_station_name,
start_station.end_station_name,
start_station.start_location_id,
end_station.end_location_id

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m20:46:35.627929 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:b1e28e04-f4a3-4b96-9d70-b31cc208700d&page=queryresults
[0m20:46:35.903122 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name start_station_name not found inside start_station at [35:15]')
[0m20:46:37.108534 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:e179dab2-990f-4499-a0f2-10d24b5961e6&page=queryresults
[0m20:46:37.390071 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:e179dab2-990f-4499-a0f2-10d24b5961e6&page=queryresults
[0m20:46:37.394982 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 20:46:34.880960 => 20:46:37.394454
[0m20:46:37.403378 [debug] [Thread-4 (]: Database Error in model fact_rides (models/core/fact_rides.sql)
  Name start_station_name not found inside start_station at [35:15]
  compiled Code at target/run/nyc_citi_bikes/models/core/fact_rides.sql
[0m20:46:37.407726 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13648ef3-28e4-401c-a866-0aad40dd8b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfaedf5e0>]}
[0m20:46:37.412043 [error] [Thread-4 (]: 3 of 3 ERROR creating sql table model nyc_citi_bike_rides.fact_rides ........... [[31mERROR[0m in 2.56s]
[0m20:46:37.416711 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m20:46:37.422247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:37.426215 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:46:37.429816 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:46:37.433105 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m20:46:37.436773 [info ] [MainThread]: 
[0m20:46:37.440316 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.82 seconds (4.82s).
[0m20:46:37.444851 [debug] [MainThread]: Command end result
[0m20:46:37.512092 [info ] [MainThread]: 
[0m20:46:37.515723 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:46:37.519302 [info ] [MainThread]: 
[0m20:46:37.522893 [error] [MainThread]:   Database Error in model fact_rides (models/core/fact_rides.sql)
  Name start_station_name not found inside start_station at [35:15]
  compiled Code at target/run/nyc_citi_bikes/models/core/fact_rides.sql
[0m20:46:37.526349 [info ] [MainThread]: 
[0m20:46:37.529732 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:46:37.533326 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 7.6808023, "process_user_time": 6.559073, "process_kernel_time": 0.743686, "process_mem_max_rss": "245716", "process_out_blocks": "4400", "command_success": false, "process_in_blocks": "0"}
[0m20:46:37.536721 [debug] [MainThread]: Command `dbt build` failed at 20:46:37.536464 after 7.68 seconds
[0m20:46:37.540029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1774ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfbec5000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1592ada0>]}
[0m20:46:37.543562 [debug] [MainThread]: Flushing usage events
[0m20:50:13.183467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253691ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2533f7e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2533f7e6b0>]}


============================== 20:50:13.187401 | b840553d-e62a-40ed-8dd2-c7f7cd63ff3a ==============================
[0m20:50:13.187401 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:50:13.200561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'debug': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:15.120734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b840553d-e62a-40ed-8dd2-c7f7cd63ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b105540>]}
[0m20:50:15.254586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b840553d-e62a-40ed-8dd2-c7f7cd63ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b1fdb40>]}
[0m20:50:15.260391 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:50:15.299714 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:50:15.562862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:50:15.567691 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/core/fact_rides.sql
[0m20:50:15.822360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b840553d-e62a-40ed-8dd2-c7f7cd63ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a9cc0d0>]}
[0m20:50:15.883660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b840553d-e62a-40ed-8dd2-c7f7cd63ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2534ae2710>]}
[0m20:50:15.888265 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:50:15.893954 [info ] [MainThread]: 
[0m20:50:15.898752 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:50:15.903880 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:50:15.908485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:16.433819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:50:16.438268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:16.782160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b840553d-e62a-40ed-8dd2-c7f7cd63ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2534ae0130>]}
[0m20:50:16.787053 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:16.790895 [info ] [MainThread]: 
[0m20:50:16.797203 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:50:16.798277 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:50:16.801390 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:50:16.805766 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:50:16.810056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:50:16.814345 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:50:16.817947 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:50:16.821301 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:50:16.830341 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:50:16.848386 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:50:16.869337 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:50:16.824802 => 20:50:16.868795
[0m20:50:16.871083 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:50:16.833166 => 20:50:16.870636
[0m20:50:16.873517 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:50:16.877622 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:50:16.947369 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:50:16.950754 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:50:16.963610 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:50:16.965345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:17.017782 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:50:17.023471 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m20:50:17.558553 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:2417f9ed-960f-4a2d-b099-10e7e135a727&page=queryresults
[0m20:50:17.567600 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:24e0bd81-d419-4cd2-baec-c2688dd83924&page=queryresults
[0m20:50:17.904483 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:50:16.881163 => 20:50:17.904065
[0m20:50:17.910129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b840553d-e62a-40ed-8dd2-c7f7cd63ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a16fdc0>]}
[0m20:50:17.915025 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m20:50:17.919507 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:50:17.980631 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:50:16.900370 => 20:50:17.980271
[0m20:50:17.989154 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b840553d-e62a-40ed-8dd2-c7f7cd63ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a9db9d0>]}
[0m20:50:17.994133 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m20:50:17.999506 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:50:18.004908 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m20:50:18.009627 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m20:50:18.014962 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m20:50:18.022846 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m20:50:18.032665 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m20:50:18.044169 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 20:50:18.026928 => 20:50:18.043642
[0m20:50:18.047822 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m20:50:18.097014 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m20:50:18.108848 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:18.162816 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,
start_station.station_id as start_station_id,
end_station.station_id as end_station_id

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m20:50:18.751767 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:196a29c6-7b26-453f-9425-3ed2baa6f362&page=queryresults
[0m20:50:19.004291 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('CREATE TABLE has columns with duplicate name start_station_id at [16:1]')
[0m20:50:19.607899 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:30183f2b-96b4-4d2d-a35d-62034e4e17bb&page=queryresults
[0m20:50:19.909208 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:30183f2b-96b4-4d2d-a35d-62034e4e17bb&page=queryresults
[0m20:50:19.914565 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 20:50:18.051404 => 20:50:19.914009
[0m20:50:19.923509 [debug] [Thread-4 (]: Database Error in model fact_rides (models/core/fact_rides.sql)
  CREATE TABLE has columns with duplicate name start_station_id at [16:1]
  compiled Code at target/run/nyc_citi_bikes/models/core/fact_rides.sql
[0m20:50:19.928157 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b840553d-e62a-40ed-8dd2-c7f7cd63ff3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a196ce0>]}
[0m20:50:19.932701 [error] [Thread-4 (]: 3 of 3 ERROR creating sql table model nyc_citi_bike_rides.fact_rides ........... [[31mERROR[0m in 1.91s]
[0m20:50:19.937093 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m20:50:19.943802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:19.948374 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:50:19.952143 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:50:19.955992 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m20:50:19.959829 [info ] [MainThread]: 
[0m20:50:19.964080 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m20:50:19.969169 [debug] [MainThread]: Command end result
[0m20:50:20.037604 [info ] [MainThread]: 
[0m20:50:20.041201 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:50:20.044885 [info ] [MainThread]: 
[0m20:50:20.048688 [error] [MainThread]:   Database Error in model fact_rides (models/core/fact_rides.sql)
  CREATE TABLE has columns with duplicate name start_station_id at [16:1]
  compiled Code at target/run/nyc_citi_bikes/models/core/fact_rides.sql
[0m20:50:20.052856 [info ] [MainThread]: 
[0m20:50:20.056677 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:50:20.060606 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 6.95704, "process_user_time": 6.643902, "process_kernel_time": 0.704718, "process_mem_max_rss": "245808", "process_out_blocks": "4400", "command_success": false, "process_in_blocks": "0"}
[0m20:50:20.064345 [debug] [MainThread]: Command `dbt build` failed at 20:50:20.063948 after 6.96 seconds
[0m20:50:20.068415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f253691ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b1fdb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b08f910>]}
[0m20:50:20.072059 [debug] [MainThread]: Flushing usage events
[0m20:52:08.313372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4217431ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4214a86740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4214a866e0>]}


============================== 20:52:08.317075 | 9d1f4aea-b1f1-4a16-99c3-4f2f8a98457a ==============================
[0m20:52:08.317075 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:52:08.329606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m20:52:10.308726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d1f4aea-b1f1-4a16-99c3-4f2f8a98457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4214be79a0>]}
[0m20:52:10.451527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d1f4aea-b1f1-4a16-99c3-4f2f8a98457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42001f0670>]}
[0m20:52:10.456448 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:52:10.497554 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:52:10.773595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:52:10.784680 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/core/fact_rides.sql
[0m20:52:11.039800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d1f4aea-b1f1-4a16-99c3-4f2f8a98457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41fb4a80d0>]}
[0m20:52:11.104153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d1f4aea-b1f1-4a16-99c3-4f2f8a98457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42155e2740>]}
[0m20:52:11.108616 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:52:11.114350 [info ] [MainThread]: 
[0m20:52:11.119024 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:52:11.124329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:52:11.128223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:11.630367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:52:11.635266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:11.966864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d1f4aea-b1f1-4a16-99c3-4f2f8a98457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42155e0160>]}
[0m20:52:11.972641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:52:11.976859 [info ] [MainThread]: 
[0m20:52:11.983549 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:52:11.984610 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:52:11.988292 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:52:11.992317 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:52:11.996743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:52:12.001318 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:52:12.011790 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:52:12.016436 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:52:12.026069 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:52:12.043945 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:52:12.059945 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:52:12.028428 => 20:52:12.059394
[0m20:52:12.060935 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:52:12.020056 => 20:52:12.060410
[0m20:52:12.063681 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:52:12.066780 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:52:12.121140 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:52:12.127272 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:52:12.152530 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:52:12.153468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:12.210473 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:52:12.214956 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m20:52:12.824303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:90916291-5f89-40ec-9235-a91025727e16&page=queryresults
[0m20:52:12.831728 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:88e5dbae-89c8-43f0-ae91-a0384b47a8c8&page=queryresults
[0m20:52:13.181356 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:52:12.093151 => 20:52:13.181016
[0m20:52:13.183130 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:52:12.069779 => 20:52:13.182781
[0m20:52:13.186854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1f4aea-b1f1-4a16-99c3-4f2f8a98457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41fad090c0>]}
[0m20:52:13.191751 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1f4aea-b1f1-4a16-99c3-4f2f8a98457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41fbded3c0>]}
[0m20:52:13.195996 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m20:52:13.200604 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m20:52:13.203666 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:52:13.207790 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:52:13.215981 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m20:52:13.220018 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m20:52:13.224750 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m20:52:13.228268 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m20:52:13.237073 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m20:52:13.260015 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 20:52:13.231499 => 20:52:13.259472
[0m20:52:13.264124 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m20:52:13.314579 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m20:52:13.325891 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:52:13.379295 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m20:52:13.949223 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:4595e6ef-5e2a-434d-9ab0-1c688c1836c6&page=queryresults
[0m20:52:17.245990 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 20:52:13.267659 => 20:52:17.245643
[0m20:52:17.251089 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1f4aea-b1f1-4a16-99c3-4f2f8a98457a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42155e0f70>]}
[0m20:52:17.255133 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 156.5 MiB processed)[0m in 4.03s]
[0m20:52:17.259206 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m20:52:17.264566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:17.267874 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:52:17.271234 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:52:17.274605 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m20:52:17.277965 [info ] [MainThread]: 
[0m20:52:17.281237 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.16 seconds (6.16s).
[0m20:52:17.285263 [debug] [MainThread]: Command end result
[0m20:52:17.348391 [info ] [MainThread]: 
[0m20:52:17.352143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:52:17.355816 [info ] [MainThread]: 
[0m20:52:17.359163 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:52:17.362778 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.121735, "process_user_time": 6.548837, "process_kernel_time": 0.723583, "process_mem_max_rss": "244792", "process_out_blocks": "4344", "process_in_blocks": "0"}
[0m20:52:17.366532 [debug] [MainThread]: Command `dbt build` succeeded at 20:52:17.366237 after 9.13 seconds
[0m20:52:17.369966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4217431ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42001f0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41fbcaba60>]}
[0m20:52:17.373809 [debug] [MainThread]: Flushing usage events
[0m20:54:54.815190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb323359ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3209ba5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3209ba560>]}


============================== 20:54:54.819979 | 6edc07b7-97e2-4cb3-8c62-f01ddedb50c8 ==============================
[0m20:54:54.819979 [info ] [MainThread]: Running with dbt=1.7.4
[0m20:54:54.848567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:54:57.028020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6edc07b7-97e2-4cb3-8c62-f01ddedb50c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb320b23970>]}
[0m20:54:57.174329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6edc07b7-97e2-4cb3-8c62-f01ddedb50c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb307baac50>]}
[0m20:54:57.179585 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m20:54:57.218962 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m20:54:57.472745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:54:57.477024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:54:57.490595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6edc07b7-97e2-4cb3-8c62-f01ddedb50c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3215800d0>]}
[0m20:54:57.609094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6edc07b7-97e2-4cb3-8c62-f01ddedb50c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32153e230>]}
[0m20:54:57.613403 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m20:54:57.617271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6edc07b7-97e2-4cb3-8c62-f01ddedb50c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32153e680>]}
[0m20:54:57.622294 [info ] [MainThread]: 
[0m20:54:57.626685 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:54:57.632255 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m20:54:57.636296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:58.137575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m20:54:58.142184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:58.519020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6edc07b7-97e2-4cb3-8c62-f01ddedb50c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32153d930>]}
[0m20:54:58.524420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:54:58.528881 [info ] [MainThread]: 
[0m20:54:58.536397 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m20:54:58.537548 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m20:54:58.540996 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m20:54:58.545098 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m20:54:58.549198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m20:54:58.553855 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m20:54:58.557815 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m20:54:58.561486 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m20:54:58.572008 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:54:58.598291 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m20:54:58.624007 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 20:54:58.564910 => 20:54:58.623453
[0m20:54:58.625692 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 20:54:58.581834 => 20:54:58.625256
[0m20:54:58.627788 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m20:54:58.631715 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m20:54:58.730567 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m20:54:58.731383 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m20:54:58.745138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:58.746977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:54:58.817461 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m20:54:58.822253 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1


-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
-- 

--   limit 100

-- ;


[0m20:54:59.487582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:aa179656-4952-4a65-bf23-5aac4554b01f&page=queryresults
[0m20:54:59.671257 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:3ae0d591-a078-41e5-bfb0-6f4b541f36ee&page=queryresults
[0m20:54:59.805099 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 20:54:58.635398 => 20:54:59.804740
[0m20:54:59.810917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6edc07b7-97e2-4cb3-8c62-f01ddedb50c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb321523790>]}
[0m20:54:59.815589 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m20:54:59.820489 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m20:54:59.995810 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 20:54:58.641451 => 20:54:59.995465
[0m20:55:00.001104 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6edc07b7-97e2-4cb3-8c62-f01ddedb50c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3215228c0>]}
[0m20:55:00.005938 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m20:55:00.011447 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m20:55:00.016764 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m20:55:00.021368 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m20:55:00.026607 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m20:55:00.030802 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m20:55:00.040822 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m20:55:00.053896 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 20:55:00.034782 => 20:55:00.053369
[0m20:55:00.058427 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m20:55:00.078561 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:55:00.480623 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m20:55:00.497281 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m20:55:01.055328 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:ba444697-f584-4f98-8fa8-1defcce4c5de&page=queryresults
[0m20:55:04.346178 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 20:55:00.062260 => 20:55:04.345803
[0m20:55:04.351432 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6edc07b7-97e2-4cb3-8c62-f01ddedb50c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb307497cd0>]}
[0m20:55:04.355860 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 156.5 MiB processed)[0m in 4.33s]
[0m20:55:04.360350 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m20:55:04.366443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:04.371557 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m20:55:04.375908 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m20:55:04.380307 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m20:55:04.384600 [info ] [MainThread]: 
[0m20:55:04.388752 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m20:55:04.394807 [debug] [MainThread]: Command end result
[0m20:55:04.464125 [info ] [MainThread]: 
[0m20:55:04.467802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:04.471601 [info ] [MainThread]: 
[0m20:55:04.475387 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:55:04.484404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.739816, "process_user_time": 6.52266, "process_kernel_time": 0.744633, "process_mem_max_rss": "241400", "process_out_blocks": "3136", "process_in_blocks": "0"}
[0m20:55:04.489051 [debug] [MainThread]: Command `dbt run` succeeded at 20:55:04.488734 after 9.75 seconds
[0m20:55:04.493054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb323359ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32096b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb307a1e980>]}
[0m20:55:04.497248 [debug] [MainThread]: Flushing usage events
[0m21:01:04.481790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b53291ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b508e2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b508e25f0>]}


============================== 21:01:04.485489 | 8a3ef751-ac56-4ab0-b3b5-0789dacb981a ==============================
[0m21:01:04.485489 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:01:04.500701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:06.477754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b508e26e0>]}
[0m21:01:06.616213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b37bb56f0>]}
[0m21:01:06.621385 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:01:06.658150 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:01:06.688987 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:01:06.693625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b50a8c1f0>]}
[0m21:01:09.034134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b51441150>]}
[0m21:01:09.129788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b37ae6350>]}
[0m21:01:09.134519 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m21:01:09.138294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b37ae7af0>]}
[0m21:01:09.143489 [info ] [MainThread]: 
[0m21:01:09.147553 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:01:09.152574 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m21:01:09.156384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:09.833072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m21:01:09.837750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:01:10.180530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b514438e0>]}
[0m21:01:10.185521 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:01:10.189051 [info ] [MainThread]: 
[0m21:01:10.195446 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m21:01:10.196206 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m21:01:10.199190 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m21:01:10.203139 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m21:01:10.206899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m21:01:10.217427 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m21:01:10.210905 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m21:01:10.226069 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:01:10.229174 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m21:01:10.243477 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m21:01:10.247885 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 21:01:10.220735 => 21:01:10.247437
[0m21:01:10.252542 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m21:01:10.255204 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 21:01:10.235768 => 21:01:10.254805
[0m21:01:10.275066 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m21:01:10.314447 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m21:01:10.316211 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:01:10.328182 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:01:10.330137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:01:10.382073 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m21:01:10.384253 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m21:01:11.031015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:5a475814-beda-46ab-8d32-47a174f677d7&page=queryresults
[0m21:01:11.060416 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:0a3a02ee-26ee-4bc5-97cb-34552927f9c4&page=queryresults
[0m21:01:11.349990 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 21:01:10.256019 => 21:01:11.349631
[0m21:01:11.354933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b36cd5e40>]}
[0m21:01:11.359099 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m21:01:11.363325 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m21:01:11.418109 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 21:01:10.289612 => 21:01:11.417757
[0m21:01:11.423280 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b36ce3e50>]}
[0m21:01:11.427295 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m21:01:11.431501 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m21:01:11.436494 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m21:01:11.440607 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m21:01:11.445251 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m21:01:11.449016 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m21:01:11.458048 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m21:01:11.470021 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 21:01:11.452422 => 21:01:11.469531
[0m21:01:11.474396 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m21:01:11.495846 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:01:11.932710 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m21:01:11.944147 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m21:01:12.304687 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:e82b9168-7d60-493a-8caa-a74741b39c4d&page=queryresults
[0m21:01:15.589540 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 21:01:11.479194 => 21:01:15.589167
[0m21:01:15.595665 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a3ef751-ac56-4ab0-b3b5-0789dacb981a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b379b4130>]}
[0m21:01:15.601189 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 156.5 MiB processed)[0m in 4.15s]
[0m21:01:15.612657 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m21:01:15.619104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:15.623093 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m21:01:15.626865 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m21:01:15.630462 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m21:01:15.634073 [info ] [MainThread]: 
[0m21:01:15.637769 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.49 seconds (6.49s).
[0m21:01:15.642267 [debug] [MainThread]: Command end result
[0m21:01:15.700923 [info ] [MainThread]: 
[0m21:01:15.704462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:15.708001 [info ] [MainThread]: 
[0m21:01:15.711642 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:01:15.715250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.304566, "process_user_time": 8.238463, "process_kernel_time": 0.701749, "process_mem_max_rss": "246148", "process_out_blocks": "4352", "process_in_blocks": "0"}
[0m21:01:15.718927 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:15.718663 after 11.31 seconds
[0m21:01:15.722207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b53291ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b36afdfc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b36d30d90>]}
[0m21:01:15.728960 [debug] [MainThread]: Flushing usage events
[0m21:02:07.799937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796f129ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796c78a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796c78a650>]}


============================== 21:02:07.804252 | af9335d9-9941-4dd4-9cfb-0cb81951a064 ==============================
[0m21:02:07.804252 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:02:07.817143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:02:09.921769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af9335d9-9941-4dd4-9cfb-0cb81951a064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7953924760>]}
[0m21:02:10.063746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af9335d9-9941-4dd4-9cfb-0cb81951a064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79539e2b60>]}
[0m21:02:10.069024 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:02:10.114652 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:02:10.403509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:02:10.407743 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m21:02:10.671489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af9335d9-9941-4dd4-9cfb-0cb81951a064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79531e22f0>]}
[0m21:02:10.736864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af9335d9-9941-4dd4-9cfb-0cb81951a064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79531658d0>]}
[0m21:02:10.740707 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m21:02:10.744272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9335d9-9941-4dd4-9cfb-0cb81951a064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7953165900>]}
[0m21:02:10.749636 [info ] [MainThread]: 
[0m21:02:10.753802 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:02:10.758606 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m21:02:10.762261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:11.403479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m21:02:11.407997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:11.796844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9335d9-9941-4dd4-9cfb-0cb81951a064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796d309de0>]}
[0m21:02:11.802578 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:02:11.808612 [info ] [MainThread]: 
[0m21:02:11.816722 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m21:02:11.817974 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m21:02:11.822261 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m21:02:11.826866 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m21:02:11.831619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m21:02:11.836978 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m21:02:11.841247 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m21:02:11.845604 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m21:02:11.855180 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:02:11.866054 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m21:02:11.875444 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 21:02:11.849409 => 21:02:11.874876
[0m21:02:11.879693 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m21:02:11.880794 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 21:02:11.858345 => 21:02:11.880339
[0m21:02:11.903599 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m21:02:11.961152 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:02:11.962338 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m21:02:11.976975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:11.984884 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:02:12.048235 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m21:02:12.054024 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null 
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m21:02:12.596734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:624e22e2-d5d6-4423-ace0-48a946d3ce38&page=queryresults
[0m21:02:12.780959 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:de01eb09-5049-4535-90dd-c628cd928f13&page=queryresults
[0m21:02:12.941926 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 21:02:11.883457 => 21:02:12.941575
[0m21:02:12.947696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9335d9-9941-4dd4-9cfb-0cb81951a064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796d2f6ce0>]}
[0m21:02:12.952708 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m21:02:12.957257 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m21:02:13.115659 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 21:02:11.920966 => 21:02:13.115173
[0m21:02:13.121113 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9335d9-9941-4dd4-9cfb-0cb81951a064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79530748e0>]}
[0m21:02:13.125776 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m21:02:13.129916 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m21:02:13.134803 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m21:02:13.139152 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m21:02:13.143831 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m21:02:13.148188 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m21:02:13.157851 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m21:02:13.170510 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 21:02:13.151770 => 21:02:13.169903
[0m21:02:13.174932 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m21:02:13.194723 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:02:13.572864 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m21:02:13.584206 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m21:02:14.269532 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:f5b3a7cf-9575-4145-b521-957e95629c0e&page=queryresults
[0m21:02:17.257672 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 21:02:13.178451 => 21:02:17.257325
[0m21:02:17.262719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9335d9-9941-4dd4-9cfb-0cb81951a064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79530c5270>]}
[0m21:02:17.266692 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 141.6 MiB processed)[0m in 4.12s]
[0m21:02:17.271557 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m21:02:17.277777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:17.281459 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m21:02:17.284934 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m21:02:17.288654 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m21:02:17.292293 [info ] [MainThread]: 
[0m21:02:17.295905 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.54 seconds (6.54s).
[0m21:02:17.300433 [debug] [MainThread]: Command end result
[0m21:02:17.381671 [info ] [MainThread]: 
[0m21:02:17.387091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:17.391338 [info ] [MainThread]: 
[0m21:02:17.394887 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:02:17.399038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.675182, "process_user_time": 6.726071, "process_kernel_time": 0.735156, "process_mem_max_rss": "244756", "process_out_blocks": "4360", "process_in_blocks": "0"}
[0m21:02:17.402966 [debug] [MainThread]: Command `dbt run` succeeded at 21:02:17.402654 after 9.68 seconds
[0m21:02:17.406521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f796f129ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f795317c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7952f0c490>]}
[0m21:02:17.410379 [debug] [MainThread]: Flushing usage events
[0m21:05:17.634830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a85d93910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a833e2620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a833e25c0>]}


============================== 21:05:17.638798 | c3d0688d-3feb-4324-98c8-76f0f3aaad28 ==============================
[0m21:05:17.638798 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:05:17.651199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:05:19.628081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3d0688d-3feb-4324-98c8-76f0f3aaad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8354bca0>]}
[0m21:05:19.779792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3d0688d-3feb-4324-98c8-76f0f3aaad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6a5e4970>]}
[0m21:05:19.791703 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:05:19.834369 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:05:20.046071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:05:20.050986 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m21:05:20.307583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3d0688d-3feb-4324-98c8-76f0f3aaad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a69f0a260>]}
[0m21:05:20.370538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3d0688d-3feb-4324-98c8-76f0f3aaad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a69e65870>]}
[0m21:05:20.375124 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m21:05:20.378847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3d0688d-3feb-4324-98c8-76f0f3aaad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a69e67670>]}
[0m21:05:20.384261 [info ] [MainThread]: 
[0m21:05:20.388554 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:05:20.393302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m21:05:20.396826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:20.882375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m21:05:20.886592 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:21.279478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3d0688d-3feb-4324-98c8-76f0f3aaad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a83f49d20>]}
[0m21:05:21.284884 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:05:21.289019 [info ] [MainThread]: 
[0m21:05:21.295443 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m21:05:21.296357 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m21:05:21.300730 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m21:05:21.306185 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m21:05:21.312321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m21:05:21.321545 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m21:05:21.329656 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m21:05:21.333667 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m21:05:21.343484 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:05:21.353217 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m21:05:21.362353 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 21:05:21.337285 => 21:05:21.361845
[0m21:05:21.365968 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m21:05:21.367478 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 21:05:21.345646 => 21:05:21.367053
[0m21:05:21.395447 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m21:05:21.443066 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:05:21.443671 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m21:05:21.455773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:05:21.457367 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:05:21.525800 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m21:05:21.529843 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m21:05:22.108396 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:c0f728f5-9974-40cc-879b-6a258b33c71d&page=queryresults
[0m21:05:22.157049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:f5decbbf-f734-4577-8b6b-bac6b0d297ed&page=queryresults
[0m21:05:22.473867 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 21:05:21.416269 => 21:05:22.473518
[0m21:05:22.479334 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3d0688d-3feb-4324-98c8-76f0f3aaad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a69f16f20>]}
[0m21:05:22.484017 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m21:05:22.489228 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 21:05:21.369680 => 21:05:22.488850
[0m21:05:22.491257 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m21:05:22.496183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3d0688d-3feb-4324-98c8-76f0f3aaad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a83f36b30>]}
[0m21:05:22.503892 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m21:05:22.508691 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m21:05:22.513440 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m21:05:22.517502 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m21:05:22.522411 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m21:05:22.526141 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m21:05:22.535189 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m21:05:22.545899 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 21:05:22.529341 => 21:05:22.545376
[0m21:05:22.549486 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m21:05:22.568927 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:05:23.034061 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m21:05:23.045932 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m21:05:23.822236 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:17d1e886-03ca-4680-9668-5356c36103a2&page=queryresults
[0m21:05:27.451834 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 21:05:22.552768 => 21:05:27.451383
[0m21:05:27.457334 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3d0688d-3feb-4324-98c8-76f0f3aaad28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a69f0b190>]}
[0m21:05:27.462634 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 156.5 MiB processed)[0m in 4.94s]
[0m21:05:27.467575 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m21:05:27.474535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:27.478944 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m21:05:27.483076 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m21:05:27.487350 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m21:05:27.494014 [info ] [MainThread]: 
[0m21:05:27.498832 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 7.11 seconds (7.11s).
[0m21:05:27.504543 [debug] [MainThread]: Command end result
[0m21:05:27.596356 [info ] [MainThread]: 
[0m21:05:27.600779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:05:27.612126 [info ] [MainThread]: 
[0m21:05:27.616161 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:05:27.619883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.056502, "process_user_time": 6.560267, "process_kernel_time": 0.678368, "process_mem_max_rss": "245348", "process_out_blocks": "4352", "process_in_blocks": "0"}
[0m21:05:27.623394 [debug] [MainThread]: Command `dbt run` succeeded at 21:05:27.623124 after 10.06 seconds
[0m21:05:27.627155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a85d93910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a83584ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6a5e4970>]}
[0m21:05:27.630431 [debug] [MainThread]: Flushing usage events
[0m21:06:34.540538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d58c9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d30ca6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d30ca680>]}


============================== 21:06:34.544454 | 9c0a6503-25e1-4fec-be3b-a04c15610f3d ==============================
[0m21:06:34.544454 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:06:34.559040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m21:06:36.542447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c0a6503-25e1-4fec-be3b-a04c15610f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d30339a0>]}
[0m21:06:36.681550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c0a6503-25e1-4fec-be3b-a04c15610f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ba2dfbe0>]}
[0m21:06:36.686844 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:06:36.723856 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:06:36.961672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:06:36.966218 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m21:06:37.182423 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_citi_bikes.stg_rides' (models/staging/stg_rides.sql) depends on a source named 'staging.ride' which was not found
[0m21:06:37.187024 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.7257175, "process_user_time": 5.491346, "process_kernel_time": 0.695159, "process_mem_max_rss": "227492", "process_out_blocks": "80", "command_success": false, "process_in_blocks": "0"}
[0m21:06:37.191640 [debug] [MainThread]: Command `dbt build` failed at 21:06:37.191356 after 2.73 seconds
[0m21:06:37.195788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d58c9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d3af3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ba115720>]}
[0m21:06:37.200348 [debug] [MainThread]: Flushing usage events
[0m21:12:41.036351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9073fb9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907161a6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f907161a680>]}


============================== 21:12:41.040765 | da853b03-0ce9-4ce4-8897-fc1e1960092b ==============================
[0m21:12:41.040765 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:12:41.083113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m21:12:43.148469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da853b03-0ce9-4ce4-8897-fc1e1960092b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90717839a0>]}
[0m21:12:43.292819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da853b03-0ce9-4ce4-8897-fc1e1960092b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905ca47be0>]}
[0m21:12:43.298049 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:12:43.337842 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:12:43.609161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:12:43.613010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:12:43.625779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da853b03-0ce9-4ce4-8897-fc1e1960092b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90721e00d0>]}
[0m21:12:43.751952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da853b03-0ce9-4ce4-8897-fc1e1960092b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90721a6410>]}
[0m21:12:43.755947 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m21:12:43.761298 [info ] [MainThread]: 
[0m21:12:43.765948 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:12:43.771046 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m21:12:43.775151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:44.290183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m21:12:44.294983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:12:44.657912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da853b03-0ce9-4ce4-8897-fc1e1960092b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90721a4070>]}
[0m21:12:44.663271 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:12:44.667164 [info ] [MainThread]: 
[0m21:12:44.673853 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m21:12:44.674941 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m21:12:44.678261 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m21:12:44.682590 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m21:12:44.686944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m21:12:44.691900 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m21:12:44.695997 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m21:12:44.700271 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m21:12:44.709887 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:12:44.727576 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m21:12:44.740971 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 21:12:44.704286 => 21:12:44.740428
[0m21:12:44.742288 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 21:12:44.712850 => 21:12:44.741876
[0m21:12:44.744261 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m21:12:44.747390 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m21:12:44.843362 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:12:44.846304 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m21:12:44.856489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:44.858251 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:12:44.910831 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m21:12:44.911928 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m21:12:45.584561 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:024598f9-7693-4aa2-8333-10e50979ade1&page=queryresults
[0m21:12:45.605480 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:fbbd5347-1d21-49d9-89c4-cc0035567e61&page=queryresults
[0m21:12:45.943143 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 21:12:44.750785 => 21:12:45.942799
[0m21:12:45.948848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da853b03-0ce9-4ce4-8897-fc1e1960092b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905c0bf850>]}
[0m21:12:45.953597 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m21:12:45.957862 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m21:12:46.181748 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 21:12:44.761189 => 21:12:46.181390
[0m21:12:46.189943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da853b03-0ce9-4ce4-8897-fc1e1960092b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9072187f70>]}
[0m21:12:46.194661 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m21:12:46.199643 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m21:12:46.204757 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m21:12:46.209199 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m21:12:46.213778 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m21:12:46.217645 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m21:12:46.226888 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m21:12:46.241012 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 21:12:46.221321 => 21:12:46.240441
[0m21:12:46.245158 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m21:12:46.265557 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:12:46.654683 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m21:12:46.666979 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m21:12:47.245180 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:c946430d-ce27-491a-a94a-70c60308b01f&page=queryresults
[0m21:12:50.272165 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 21:12:46.249053 => 21:12:50.271784
[0m21:12:50.284012 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da853b03-0ce9-4ce4-8897-fc1e1960092b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905c0b7d00>]}
[0m21:12:50.288681 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 156.5 MiB processed)[0m in 4.07s]
[0m21:12:50.293600 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m21:12:50.299829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:50.303842 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m21:12:50.308403 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m21:12:50.311824 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m21:12:50.315205 [info ] [MainThread]: 
[0m21:12:50.318757 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.55 seconds (6.55s).
[0m21:12:50.323141 [debug] [MainThread]: Command end result
[0m21:12:50.405307 [info ] [MainThread]: 
[0m21:12:50.409237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:12:50.412934 [info ] [MainThread]: 
[0m21:12:50.416713 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:12:50.425123 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.46241, "process_user_time": 6.228969, "process_kernel_time": 0.824303, "process_mem_max_rss": "242144", "process_out_blocks": "3128", "process_in_blocks": "0"}
[0m21:12:50.429607 [debug] [MainThread]: Command `dbt build` succeeded at 21:12:50.429249 after 9.47 seconds
[0m21:12:50.433413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9073fb9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905c084190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905ca47be0>]}
[0m21:12:50.437212 [debug] [MainThread]: Flushing usage events
[0m21:23:34.539071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a97355ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a949a65f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a949a6590>]}


============================== 21:23:34.543251 | df445877-b132-4b82-98d9-07aaa6f1d9e9 ==============================
[0m21:23:34.543251 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:23:34.583017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:23:34.613080 [info ] [MainThread]: dbt version: 1.7.4
[0m21:23:34.636058 [info ] [MainThread]: python version: 3.10.14
[0m21:23:34.644208 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:23:34.648782 [info ] [MainThread]: os info: Linux-5.15.60-x86_64-with-glibc2.36
[0m21:23:36.553302 [info ] [MainThread]: Using profiles dir at /home/src/default_repo/dbt/dbt_citi_bikes
[0m21:23:36.557934 [info ] [MainThread]: Using profiles.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/profiles.yml
[0m21:23:36.561943 [info ] [MainThread]: Using dbt_project.yml file at /home/src/default_repo/dbt/dbt_citi_bikes/dbt_project.yml
[0m21:23:36.566472 [info ] [MainThread]: adapter type: bigquery
[0m21:23:36.570462 [info ] [MainThread]: adapter version: 1.7.2
[0m21:23:36.696343 [info ] [MainThread]: Configuration:
[0m21:23:36.700743 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:23:36.704655 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:23:36.708436 [info ] [MainThread]: Required dependencies:
[0m21:23:36.712393 [debug] [MainThread]: Executing "git --help"
[0m21:23:36.722287 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:23:36.723022 [debug] [MainThread]: STDERR: "b''"
[0m21:23:36.727052 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:23:36.730967 [info ] [MainThread]: Connection:
[0m21:23:36.734848 [info ] [MainThread]:   method: service-account
[0m21:23:36.738542 [info ] [MainThread]:   database: virtual-aileron-412616
[0m21:23:36.741925 [info ] [MainThread]:   execution_project: virtual-aileron-412616
[0m21:23:36.745611 [info ] [MainThread]:   schema: nyc_citi_bike_rides
[0m21:23:36.749059 [info ] [MainThread]:   location: None
[0m21:23:36.752801 [info ] [MainThread]:   priority: None
[0m21:23:36.756418 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:23:36.760360 [info ] [MainThread]:   impersonate_service_account: None
[0m21:23:36.763875 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:23:36.767504 [info ] [MainThread]:   job_retries: 1
[0m21:23:36.770966 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:23:36.774806 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m21:23:36.778815 [info ] [MainThread]:   keyfile: /secrets/credentials/mage_credentials
[0m21:23:36.782356 [info ] [MainThread]:   timeout_seconds: None
[0m21:23:36.786067 [info ] [MainThread]:   refresh_token: None
[0m21:23:36.789860 [info ] [MainThread]:   client_id: None
[0m21:23:36.793585 [info ] [MainThread]:   token_uri: None
[0m21:23:36.797123 [info ] [MainThread]:   dataproc_region: None
[0m21:23:36.800686 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:23:36.804203 [info ] [MainThread]:   gcs_bucket: None
[0m21:23:36.807863 [info ] [MainThread]:   dataproc_batch: None
[0m21:23:36.814046 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:23:36.823546 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:23:36.828213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:37.002622 [debug] [MainThread]: On debug: select 1 as id
[0m21:23:37.559357 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:78a673f9-7504-4ede-9239-2fd0cf241791&page=queryresults
[0m21:23:37.948412 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:23:37.952774 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:23:37.957053 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.4932036, "process_user_time": 5.435341, "process_kernel_time": 0.632016, "process_mem_max_rss": "222260", "process_out_blocks": "408", "process_in_blocks": "0"}
[0m21:23:37.961322 [debug] [MainThread]: Command `dbt debug` succeeded at 21:23:37.960993 after 3.50 seconds
[0m21:23:37.965270 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:23:37.968973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a97355ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a949a6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a95a2c970>]}
[0m21:23:37.973196 [debug] [MainThread]: Flushing usage events
[0m21:27:03.567666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e05beb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e033e66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e033e6650>]}


============================== 21:27:03.572148 | 1b09d39f-691a-4552-8a55-a0bbc4f0d276 ==============================
[0m21:27:03.572148 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:27:03.586986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:27:05.639161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b09d39f-691a-4552-8a55-a0bbc4f0d276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dea6584c0>]}
[0m21:27:05.788439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b09d39f-691a-4552-8a55-a0bbc4f0d276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e033e6860>]}
[0m21:27:05.802516 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:27:05.843176 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:27:06.081068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:06.085541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:06.099388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b09d39f-691a-4552-8a55-a0bbc4f0d276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03dac0d0>]}
[0m21:27:06.178456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b09d39f-691a-4552-8a55-a0bbc4f0d276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03f6e3e0>]}
[0m21:27:06.182263 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m21:27:06.187178 [info ] [MainThread]: 
[0m21:27:06.191667 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:27:06.196821 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m21:27:06.200652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:06.720913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m21:27:06.725143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:07.097732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b09d39f-691a-4552-8a55-a0bbc4f0d276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03f6c040>]}
[0m21:27:07.103000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:07.106575 [info ] [MainThread]: 
[0m21:27:07.112650 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m21:27:07.113846 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m21:27:07.116729 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m21:27:07.120702 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m21:27:07.124758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m21:27:07.128959 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m21:27:07.132680 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m21:27:07.136547 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m21:27:07.145505 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:27:07.162586 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m21:27:07.174826 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 21:27:07.139697 => 21:27:07.174167
[0m21:27:07.176047 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 21:27:07.147792 => 21:27:07.175586
[0m21:27:07.178101 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m21:27:07.181586 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m21:27:07.278905 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:27:07.279557 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m21:27:07.296147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:07.297315 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:27:07.348597 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m21:27:07.352131 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m21:27:07.894461 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:5156145d-1794-4c15-bb8d-0b494bf847ee&page=queryresults
[0m21:27:07.926763 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:cbf0d93c-8fdf-494b-bec2-a3bf8d016ffb&page=queryresults
[0m21:27:08.278383 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 21:27:07.184771 => 21:27:08.278025
[0m21:27:08.283535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b09d39f-691a-4552-8a55-a0bbc4f0d276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03daee00>]}
[0m21:27:08.288082 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m21:27:08.292276 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m21:27:08.488085 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 21:27:07.198783 => 21:27:08.487744
[0m21:27:08.493541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b09d39f-691a-4552-8a55-a0bbc4f0d276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03daeb90>]}
[0m21:27:08.497942 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m21:27:08.502240 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m21:27:08.506927 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m21:27:08.511216 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m21:27:08.515961 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m21:27:08.520063 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m21:27:08.531352 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m21:27:08.544567 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 21:27:08.523696 => 21:27:08.543669
[0m21:27:08.548953 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m21:27:08.570211 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:27:08.977052 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m21:27:08.989875 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m21:27:09.552257 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:a32558ff-864d-4ab0-93fc-9092b1f90fe3&page=queryresults
[0m21:27:12.544631 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 21:27:08.552752 => 21:27:12.544253
[0m21:27:12.549919 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b09d39f-691a-4552-8a55-a0bbc4f0d276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03daf220>]}
[0m21:27:12.554668 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 156.5 MiB processed)[0m in 4.03s]
[0m21:27:12.559066 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m21:27:12.565165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:12.569296 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m21:27:12.573179 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m21:27:12.577297 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m21:27:12.581713 [info ] [MainThread]: 
[0m21:27:12.585778 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.39 seconds (6.39s).
[0m21:27:12.590627 [debug] [MainThread]: Command end result
[0m21:27:12.653671 [info ] [MainThread]: 
[0m21:27:12.662731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:12.667529 [info ] [MainThread]: 
[0m21:27:12.671892 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:27:12.676519 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.184593, "process_user_time": 6.43434, "process_kernel_time": 0.733281, "process_mem_max_rss": "241860", "process_out_blocks": "3120", "process_in_blocks": "0"}
[0m21:27:12.680933 [debug] [MainThread]: Command `dbt build` succeeded at 21:27:12.680619 after 9.19 seconds
[0m21:27:12.686192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e05beb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e03353700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e033e6860>]}
[0m21:27:12.690173 [debug] [MainThread]: Flushing usage events
[0m21:34:23.535483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa462679ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45fcce5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45fcce590>]}


============================== 21:34:23.539598 | c8652c34-64f3-403d-9bb6-f1c3e90549e9 ==============================
[0m21:34:23.539598 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:34:23.558252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:34:23.780155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8652c34-64f3-403d-9bb6-f1c3e90549e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45fcce860>]}
[0m21:34:25.046088 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1_fi5kl9'
[0m21:34:25.054240 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:34:25.130785 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:34:25.137179 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:34:25.193804 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:34:25.206470 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m21:34:25.302926 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m21:34:25.311307 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:34:29.311954 [info ] [MainThread]: Installed from version 1.1.1
[0m21:34:29.315600 [info ] [MainThread]: Up to date!
[0m21:34:29.319902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c8652c34-64f3-403d-9bb6-f1c3e90549e9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45fe2f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45fccc460>]}
[0m21:34:29.323564 [info ] [MainThread]: Installing dbt-labs/codegen
[0m21:34:30.896800 [info ] [MainThread]: Installed from version 0.12.1
[0m21:34:30.900464 [info ] [MainThread]: Up to date!
[0m21:34:30.904291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c8652c34-64f3-403d-9bb6-f1c3e90549e9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45fe2f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45fd79f60>]}
[0m21:34:30.909597 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.4497156, "process_user_time": 3.832219, "process_kernel_time": 0.399189, "process_mem_max_rss": "105732", "process_out_blocks": "2816", "process_in_blocks": "0"}
[0m21:34:30.917315 [debug] [MainThread]: Command `dbt deps` succeeded at 21:34:30.916990 after 7.46 seconds
[0m21:34:30.921533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa462679ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45fd3c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45fd3e320>]}
[0m21:34:30.929396 [debug] [MainThread]: Flushing usage events
[0m21:43:48.677221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c4131ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c17966b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c1796650>]}


============================== 21:43:48.681212 | 24feed98-f869-4ed2-92af-6f1e5b9ad378 ==============================
[0m21:43:48.681212 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:43:48.698952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:43:50.601101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24feed98-f869-4ed2-92af-6f1e5b9ad378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac9e4760>]}
[0m21:43:50.730985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24feed98-f869-4ed2-92af-6f1e5b9ad378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0acaa2b60>]}
[0m21:43:50.736551 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:43:50.783114 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:43:51.105109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:43:51.110473 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/schema.yml
[0m21:43:51.457080 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_citi_bikes.stg_dim_station' (models/staging/stg_dim_station.sql) depends on a source named 'staging.citi_bikes' which was not found
[0m21:43:51.462184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8584793, "process_user_time": 5.405031, "process_kernel_time": 0.708524, "process_mem_max_rss": "229568", "process_out_blocks": "88", "command_success": false, "process_in_blocks": "0"}
[0m21:43:51.466647 [debug] [MainThread]: Command `dbt run` failed at 21:43:51.466352 after 2.86 seconds
[0m21:43:51.470973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0c4131ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac173d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ac172b60>]}
[0m21:43:51.475146 [debug] [MainThread]: Flushing usage events
[0m21:48:07.642316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f691f1d1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f691c826740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f691c8266e0>]}


============================== 21:48:07.646109 | 842fe848-2449-44b9-b319-b24afb21518a ==============================
[0m21:48:07.646109 [info ] [MainThread]: Running with dbt=1.7.4
[0m21:48:07.678528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m21:48:09.626979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '842fe848-2449-44b9-b319-b24afb21518a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f691c9879a0>]}
[0m21:48:09.777170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '842fe848-2449-44b9-b319-b24afb21518a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6903bc7d90>]}
[0m21:48:09.782702 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m21:48:09.829933 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m21:48:10.128607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:48:10.133427 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/schema.yml
[0m21:48:10.137497 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m21:48:10.141982 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_dim_station.sql
[0m21:48:10.522316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '842fe848-2449-44b9-b319-b24afb21518a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69028563b0>]}
[0m21:48:10.583357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '842fe848-2449-44b9-b319-b24afb21518a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f691d396890>]}
[0m21:48:10.587209 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m21:48:10.592822 [info ] [MainThread]: 
[0m21:48:10.597364 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:48:10.602439 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m21:48:10.606961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:11.160620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m21:48:11.165483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:11.527296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '842fe848-2449-44b9-b319-b24afb21518a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f691d3941c0>]}
[0m21:48:11.532326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:48:11.536023 [info ] [MainThread]: 
[0m21:48:11.543017 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m21:48:11.543854 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m21:48:11.546965 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m21:48:11.551005 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m21:48:11.555721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m21:48:11.560437 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m21:48:11.564803 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m21:48:11.568948 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m21:48:11.586841 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m21:48:11.593194 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:48:11.606837 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 21:48:11.579099 => 21:48:11.606318
[0m21:48:11.608079 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 21:48:11.572744 => 21:48:11.607641
[0m21:48:11.610697 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m21:48:11.614845 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m21:48:11.678735 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m21:48:11.679816 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m21:48:11.698372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:11.699518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:48:11.752277 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`)
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m21:48:11.754401 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m21:48:12.413048 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:baab32ea-e1ac-4133-a9db-cb41d96ab4d2&page=queryresults
[0m21:48:12.471223 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:3720de13-0ef0-4f86-a1b4-c6ec44cc5c73&page=queryresults
[0m21:48:12.751752 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 21:48:11.642720 => 21:48:12.751388
[0m21:48:12.756659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '842fe848-2449-44b9-b319-b24afb21518a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6902857eb0>]}
[0m21:48:12.760936 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m21:48:12.765225 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m21:48:12.785102 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 21:48:11.618474 => 21:48:12.784763
[0m21:48:12.790412 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '842fe848-2449-44b9-b319-b24afb21518a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6902857550>]}
[0m21:48:12.794970 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m21:48:12.799422 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m21:48:12.804229 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m21:48:12.808823 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m21:48:12.813147 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m21:48:12.816608 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m21:48:12.826950 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m21:48:12.837941 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 21:48:12.819771 => 21:48:12.837440
[0m21:48:12.841356 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m21:48:12.999253 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:48:13.408255 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m21:48:13.420798 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m21:48:14.099080 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:213775c6-2ab0-4d6f-950b-a4feca05bf87&page=queryresults
[0m21:48:17.143462 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 21:48:12.844801 => 21:48:17.142963
[0m21:48:17.148851 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '842fe848-2449-44b9-b319-b24afb21518a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69029ef130>]}
[0m21:48:17.153358 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 141.6 MiB processed)[0m in 4.34s]
[0m21:48:17.157865 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m21:48:17.164199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:17.167753 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m21:48:17.172645 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m21:48:17.177007 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m21:48:17.181433 [info ] [MainThread]: 
[0m21:48:17.185343 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m21:48:17.191816 [debug] [MainThread]: Command end result
[0m21:48:17.247382 [info ] [MainThread]: 
[0m21:48:17.251382 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:48:17.255400 [info ] [MainThread]: 
[0m21:48:17.259443 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:48:17.263481 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.69302, "process_user_time": 6.713319, "process_kernel_time": 0.692514, "process_mem_max_rss": "245964", "process_out_blocks": "4368", "process_in_blocks": "0"}
[0m21:48:17.267812 [debug] [MainThread]: Command `dbt build` succeeded at 21:48:17.267569 after 9.70 seconds
[0m21:48:17.272237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f691f1d1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69028d8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69029efb80>]}
[0m21:48:17.276288 [debug] [MainThread]: Flushing usage events
[0m22:04:32.423051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee0045ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edd6a6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edd6a66b0>]}


============================== 22:04:32.429130 | da7f5007-15e2-4a75-934f-8bf63bf2b79c ==============================
[0m22:04:32.429130 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:04:32.444558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:34.446321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da7f5007-15e2-4a75-934f-8bf63bf2b79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edd80f9a0>]}
[0m22:04:34.584659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da7f5007-15e2-4a75-934f-8bf63bf2b79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec889baf0>]}
[0m22:04:34.590562 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m22:04:34.626924 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:04:34.827361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:04:34.831802 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_dim_station.sql
[0m22:04:35.070362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da7f5007-15e2-4a75-934f-8bf63bf2b79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec81c6980>]}
[0m22:04:35.132393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da7f5007-15e2-4a75-934f-8bf63bf2b79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ede22e650>]}
[0m22:04:35.136250 [info ] [MainThread]: Found 3 models, 2 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m22:04:35.141730 [info ] [MainThread]: 
[0m22:04:35.146166 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:04:35.151098 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m22:04:35.155072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:35.717946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m22:04:35.722933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:36.065439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da7f5007-15e2-4a75-934f-8bf63bf2b79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ede22d8d0>]}
[0m22:04:36.070752 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:36.075110 [info ] [MainThread]: 
[0m22:04:36.081859 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m22:04:36.082980 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m22:04:36.085990 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m22:04:36.090344 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m22:04:36.094846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m22:04:36.099463 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m22:04:36.104210 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m22:04:36.107961 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m22:04:36.116584 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:04:36.135419 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m22:04:36.142890 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 22:04:36.111448 => 22:04:36.142370
[0m22:04:36.146485 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m22:04:36.147870 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 22:04:36.120135 => 22:04:36.147423
[0m22:04:36.168583 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m22:04:36.209409 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m22:04:36.216070 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:04:36.224968 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:04:36.226113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:36.278684 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m22:04:36.281525 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null 
)

select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m22:04:36.915070 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:0e99693d-b99d-4c29-aac5-97f79b05098b&page=queryresults
[0m22:04:36.945099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:ce7e5cf9-798e-43f9-8bfe-d9990ac24690&page=queryresults
[0m22:04:37.243477 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 22:04:36.188084 => 22:04:37.243073
[0m22:04:37.247940 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 22:04:36.149585 => 22:04:37.247609
[0m22:04:37.249336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da7f5007-15e2-4a75-934f-8bf63bf2b79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec3998100>]}
[0m22:04:37.253994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da7f5007-15e2-4a75-934f-8bf63bf2b79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec3998820>]}
[0m22:04:37.258392 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m22:04:37.262590 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m22:04:37.265057 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m22:04:37.269284 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m22:04:37.282455 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m22:04:37.286898 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m22:04:37.291364 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m22:04:37.295127 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m22:04:37.304784 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m22:04:37.323170 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 22:04:37.298761 => 22:04:37.322626
[0m22:04:37.326653 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m22:04:37.346151 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:04:37.750561 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m22:04:37.762282 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m22:04:38.373456 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:57398205-2653-47e7-98fd-220e57d994e9&page=queryresults
[0m22:04:41.697008 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 22:04:37.329878 => 22:04:41.696652
[0m22:04:41.702356 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da7f5007-15e2-4a75-934f-8bf63bf2b79c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec39f63e0>]}
[0m22:04:41.707077 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 141.5 MiB processed)[0m in 4.41s]
[0m22:04:41.711787 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m22:04:41.717973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:41.721720 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m22:04:41.726008 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m22:04:41.730123 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m22:04:41.734372 [info ] [MainThread]: 
[0m22:04:41.738731 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.59 seconds (6.59s).
[0m22:04:41.744023 [debug] [MainThread]: Command end result
[0m22:04:41.848997 [info ] [MainThread]: 
[0m22:04:41.852961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:41.857059 [info ] [MainThread]: 
[0m22:04:41.860913 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:04:41.864860 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.517651, "process_user_time": 6.683241, "process_kernel_time": 0.6925, "process_mem_max_rss": "245724", "process_out_blocks": "4344", "process_in_blocks": "0"}
[0m22:04:41.869328 [debug] [MainThread]: Command `dbt build` succeeded at 22:04:41.868891 after 9.52 seconds
[0m22:04:41.873871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee0045ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec889baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec8708d00>]}
[0m22:04:41.878197 [debug] [MainThread]: Flushing usage events
[0m22:16:15.995332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ccd79ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ca3ce710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ca3ce6b0>]}


============================== 22:16:15.999280 | 90453c48-ca1e-4802-8b61-ef5984c2a294 ==============================
[0m22:16:15.999280 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:16:16.022809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'fail_fast': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models stg_rides', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:16:18.125749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90453c48-ca1e-4802-8b61-ef5984c2a294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b58204c0>]}
[0m22:16:18.264801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90453c48-ca1e-4802-8b61-ef5984c2a294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ca3ce8c0>]}
[0m22:16:18.269994 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m22:16:18.310806 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:16:18.568373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m22:16:18.573437 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/schema.yml
[0m22:16:18.577441 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_rides.sql
[0m22:16:18.581505 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_dim_station.sql
[0m22:16:18.961847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90453c48-ca1e-4802-8b61-ef5984c2a294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b4612470>]}
[0m22:16:19.073563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90453c48-ca1e-4802-8b61-ef5984c2a294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22caf3e5c0>]}
[0m22:16:19.077825 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m22:16:19.081940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90453c48-ca1e-4802-8b61-ef5984c2a294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22caf3e590>]}
[0m22:16:19.086898 [info ] [MainThread]: 
[0m22:16:19.091987 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:16:19.097256 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m22:16:19.100910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:19.817614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m22:16:19.822258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:20.208833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90453c48-ca1e-4802-8b61-ef5984c2a294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22caf3d600>]}
[0m22:16:20.214685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:20.218466 [info ] [MainThread]: 
[0m22:16:20.225882 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m22:16:20.229960 [info ] [Thread-1 (]: 1 of 1 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m22:16:20.234090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_rides)
[0m22:16:20.237510 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m22:16:20.254347 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m22:16:20.271731 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 22:16:20.240667 => 22:16:20.271179
[0m22:16:20.275327 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m22:16:20.332668 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m22:16:20.345903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:20.399253 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m22:16:21.082578 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:ef3b9401-d565-4a02-a7f5-0f410c059b08&page=queryresults
[0m22:16:21.425494 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 22:16:20.278737 => 22:16:21.425134
[0m22:16:21.430574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90453c48-ca1e-4802-8b61-ef5984c2a294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b4613610>]}
[0m22:16:21.435113 [info ] [Thread-1 (]: 1 of 1 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m22:16:21.439537 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m22:16:21.445741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:21.450036 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m22:16:21.454112 [info ] [MainThread]: 
[0m22:16:21.457714 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m22:16:21.462413 [debug] [MainThread]: Command end result
[0m22:16:21.523370 [info ] [MainThread]: 
[0m22:16:21.527429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:16:21.531105 [info ] [MainThread]: 
[0m22:16:21.535532 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:16:21.539388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.617932, "process_user_time": 6.152475, "process_kernel_time": 0.766497, "process_mem_max_rss": "241872", "process_out_blocks": "4064", "process_in_blocks": "0"}
[0m22:16:21.543462 [debug] [MainThread]: Command `dbt run` succeeded at 22:16:21.543189 after 5.62 seconds
[0m22:16:21.547483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ccd79ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b44c7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ca3ce8c0>]}
[0m22:16:21.551754 [debug] [MainThread]: Flushing usage events
[0m22:19:18.128643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f9a54f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f97d4e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f97d4e650>]}


============================== 22:19:18.132416 | 0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b ==============================
[0m22:19:18.132416 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:19:18.172327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:19:20.164250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f7ef784c0>]}
[0m22:19:20.302955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f97d4e860>]}
[0m22:19:20.307448 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m22:19:20.340097 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:19:20.369011 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:19:20.373700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f7ed041c0>]}
[0m22:19:22.638914 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.citi_bikes_trips.staging
- models.citi_bikes_trips.core
[0m22:19:22.650964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f987a1ea0>]}
[0m22:19:22.730930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f7ed07b50>]}
[0m22:19:22.735095 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m22:19:22.740647 [info ] [MainThread]: 
[0m22:19:22.745071 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:19:22.750580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m22:19:22.754397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:23.265832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m22:19:23.270742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:23.619871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f987a0340>]}
[0m22:19:23.625263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:19:23.629563 [info ] [MainThread]: 
[0m22:19:23.637151 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m22:19:23.638013 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m22:19:23.641603 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m22:19:23.653527 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m22:19:23.658579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m22:19:23.663633 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m22:19:23.668254 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m22:19:23.672979 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m22:19:23.688558 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:19:23.699770 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m22:19:23.717929 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 22:19:23.676863 => 22:19:23.717057
[0m22:19:23.722661 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 22:19:23.689095 => 22:19:23.722204
[0m22:19:23.723633 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m22:19:23.727771 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m22:19:23.811664 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:19:23.812776 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m22:19:23.843838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:19:23.848696 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:19:23.920098 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)


select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m22:19:23.926788 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m22:19:24.505094 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:b575914c-69af-4086-9522-17434d3ece6e&page=queryresults
[0m22:19:24.631142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:ff78dde8-6b17-450d-b170-c0694a0ed3e8&page=queryresults
[0m22:19:24.866510 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 22:19:23.750120 => 22:19:24.866171
[0m22:19:24.871537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f7de2fb80>]}
[0m22:19:24.875991 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m22:19:24.882114 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m22:19:24.935785 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 22:19:23.731255 => 22:19:24.935433
[0m22:19:24.941024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f7dd813c0>]}
[0m22:19:24.945468 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m22:19:24.950118 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m22:19:24.954986 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m22:19:24.958727 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m22:19:24.963018 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m22:19:24.970570 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m22:19:24.982864 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m22:19:24.997408 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 22:19:24.974603 => 22:19:24.996867
[0m22:19:25.001074 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m22:19:25.022368 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:19:25.440324 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m22:19:25.452923 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m22:19:26.083519 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:16b98473-8a63-4a90-8d3e-15d3a585b6d4&page=queryresults
[0m22:19:29.405961 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 22:19:25.005056 => 22:19:29.405617
[0m22:19:29.411674 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d84b86a-d5ec-4d44-bc7e-1e07a6e04e0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f7ec89540>]}
[0m22:19:29.416170 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 156.5 MiB processed)[0m in 4.45s]
[0m22:19:29.420828 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m22:19:29.428498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:29.432012 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m22:19:29.435282 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m22:19:29.438975 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m22:19:29.442808 [info ] [MainThread]: 
[0m22:19:29.446696 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m22:19:29.451742 [debug] [MainThread]: Command end result
[0m22:19:29.514704 [info ] [MainThread]: 
[0m22:19:29.519582 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:19:29.523751 [info ] [MainThread]: 
[0m22:19:29.527586 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:19:29.531597 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.477014, "process_user_time": 8.286652, "process_kernel_time": 0.798274, "process_mem_max_rss": "245616", "process_out_blocks": "4352", "process_in_blocks": "0"}
[0m22:19:29.535333 [debug] [MainThread]: Command `dbt build` succeeded at 22:19:29.535068 after 11.48 seconds
[0m22:19:29.539064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f9a54f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f7dd71720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f97d4e860>]}
[0m22:19:29.542754 [debug] [MainThread]: Flushing usage events
[0m22:28:32.781050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2706ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b246be710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b246be6b0>]}


============================== 22:28:32.785301 | 22eac461-86c3-4152-868a-3cf7dbf6daf4 ==============================
[0m22:28:32.785301 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:28:32.807698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:28:34.676576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22eac461-86c3-4152-868a-3cf7dbf6daf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b248279a0>]}
[0m22:28:34.807326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22eac461-86c3-4152-868a-3cf7dbf6daf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0b873af0>]}
[0m22:28:34.812861 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m22:28:34.846413 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:28:34.877074 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:28:34.881154 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:28:34.885662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22eac461-86c3-4152-868a-3cf7dbf6daf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0b8e04c0>]}
[0m22:28:37.123367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22eac461-86c3-4152-868a-3cf7dbf6daf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0b8714b0>]}
[0m22:28:37.186519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22eac461-86c3-4152-868a-3cf7dbf6daf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b252a6080>]}
[0m22:28:37.190550 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m22:28:37.195661 [info ] [MainThread]: 
[0m22:28:37.200099 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:28:37.205180 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m22:28:37.208731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:37.768571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m22:28:37.773161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:38.135027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22eac461-86c3-4152-868a-3cf7dbf6daf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0b8e0160>]}
[0m22:28:38.140246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:28:38.144458 [info ] [MainThread]: 
[0m22:28:38.150975 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m22:28:38.151946 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m22:28:38.155616 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m22:28:38.160005 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m22:28:38.164284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m22:28:38.168650 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m22:28:38.172728 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m22:28:38.176420 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m22:28:38.199019 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m22:28:38.199939 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:28:38.210599 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 22:28:38.186016 => 22:28:38.210121
[0m22:28:38.214257 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m22:28:38.215599 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 22:28:38.179912 => 22:28:38.215154
[0m22:28:38.241810 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m22:28:38.262343 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m22:28:38.267500 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:28:38.280253 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:28:38.281885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:38.334394 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)


select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m22:28:38.335620 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m22:28:38.912446 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:d663dfee-bd78-47e7-9f73-8a1cb583bd4e&page=queryresults
[0m22:28:39.048644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:8edae718-bf63-43e2-a7f1-d6f05af1143b&page=queryresults
[0m22:28:39.242476 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 22:28:38.217799 => 22:28:39.242134
[0m22:28:39.248305 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22eac461-86c3-4152-868a-3cf7dbf6daf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0a99baf0>]}
[0m22:28:39.252603 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m22:28:39.256611 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m22:28:39.346600 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 22:28:38.262838 => 22:28:39.346266
[0m22:28:39.351470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22eac461-86c3-4152-868a-3cf7dbf6daf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0a723df0>]}
[0m22:28:39.355788 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m22:28:39.359890 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m22:28:39.364366 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m22:28:39.368276 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m22:28:39.372760 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m22:28:39.376512 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m22:28:39.387243 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m22:28:39.401991 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 22:28:39.379675 => 22:28:39.398101
[0m22:28:39.406392 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m22:28:39.426998 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:28:39.792654 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m22:28:39.803770 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m22:28:40.467935 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:7e53bc49-e74f-4e1a-b26e-778d4edd9047&page=queryresults
[0m22:28:43.177703 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 22:28:39.409976 => 22:28:43.177347
[0m22:28:43.182478 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22eac461-86c3-4152-868a-3cf7dbf6daf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b253abd60>]}
[0m22:28:43.186749 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 156.5 MiB processed)[0m in 3.81s]
[0m22:28:43.190658 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m22:28:43.196225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:43.200066 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m22:28:43.203562 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m22:28:43.206813 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m22:28:43.210997 [info ] [MainThread]: 
[0m22:28:43.214587 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m22:28:43.219105 [debug] [MainThread]: Command end result
[0m22:28:43.274062 [info ] [MainThread]: 
[0m22:28:43.277531 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:28:43.280826 [info ] [MainThread]: 
[0m22:28:43.284279 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:28:43.287497 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.58026, "process_user_time": 8.052851, "process_kernel_time": 0.740862, "process_mem_max_rss": "246696", "process_out_blocks": "4360", "process_in_blocks": "0"}
[0m22:28:43.291155 [debug] [MainThread]: Command `dbt build` succeeded at 22:28:43.290902 after 10.58 seconds
[0m22:28:43.294306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b2706ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0a7746a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b0b873af0>]}
[0m22:28:43.297562 [debug] [MainThread]: Flushing usage events
[0m22:38:43.401782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd265e5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd23c3a740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd23c3a6e0>]}


============================== 22:38:43.405686 | dc01ca6b-699b-4e8b-860f-01221287aaa6 ==============================
[0m22:38:43.405686 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:38:43.413718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:38:45.486569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc01ca6b-699b-4e8b-860f-01221287aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd23d9f9a0>]}
[0m22:38:45.622999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc01ca6b-699b-4e8b-860f-01221287aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0b087d90>]}
[0m22:38:45.628059 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m22:38:45.665907 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:38:45.942767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:38:45.946792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:38:45.958927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc01ca6b-699b-4e8b-860f-01221287aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd248200d0>]}
[0m22:38:46.028827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc01ca6b-699b-4e8b-860f-01221287aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd247e6740>]}
[0m22:38:46.033232 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m22:38:46.038812 [info ] [MainThread]: 
[0m22:38:46.043572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:38:46.048638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m22:38:46.052583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:46.561254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m22:38:46.566091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:46.936775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc01ca6b-699b-4e8b-860f-01221287aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd247e4160>]}
[0m22:38:46.941920 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:38:46.945924 [info ] [MainThread]: 
[0m22:38:46.952779 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m22:38:46.953749 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m22:38:46.957176 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m22:38:46.961188 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m22:38:46.965608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m22:38:46.970054 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m22:38:46.974337 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m22:38:46.978474 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m22:38:46.988459 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:38:47.014610 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m22:38:47.034909 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 22:38:46.982570 => 22:38:47.034350
[0m22:38:47.036221 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 22:38:46.993327 => 22:38:47.035747
[0m22:38:47.038739 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m22:38:47.042633 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m22:38:47.126116 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m22:38:47.128338 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:38:47.141112 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:38:47.142668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:47.215454 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m22:38:47.220025 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)


select 
cast("station_id" as string) as station_id, 
cast("station_name" as string) as station_name,
cast("date_part" as date) as date_part

from stations;


[0m22:38:47.873272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:2a99a2b6-b026-46a2-ad42-a726072a1129&page=queryresults
[0m22:38:47.923041 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:f2605c43-b6c4-444f-8f84-90c109d7ac2d&page=queryresults
[0m22:38:48.223807 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 22:38:47.045728 => 22:38:48.223455
[0m22:38:48.228918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc01ca6b-699b-4e8b-860f-01221287aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd247e4370>]}
[0m22:38:48.233138 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m22:38:48.237093 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m22:38:48.256496 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 22:38:47.070374 => 22:38:48.256154
[0m22:38:48.261312 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc01ca6b-699b-4e8b-860f-01221287aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd247c6aa0>]}
[0m22:38:48.265750 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m22:38:48.269708 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m22:38:48.277126 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m22:38:48.281447 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m22:38:48.288007 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m22:38:48.292327 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m22:38:48.302061 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m22:38:48.333134 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 22:38:48.296179 => 22:38:48.332614
[0m22:38:48.343542 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m22:38:48.363515 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:38:48.773039 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m22:38:48.792017 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m22:38:49.275271 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:09193c3e-cf68-4d23-97b4-aae720d88ae2&page=queryresults
[0m22:38:52.313060 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 22:38:48.347253 => 22:38:52.312726
[0m22:38:52.318513 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc01ca6b-699b-4e8b-860f-01221287aaa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0a72ff40>]}
[0m22:38:52.322872 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (0.0 rows, 156.5 MiB processed)[0m in 4.03s]
[0m22:38:52.327366 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m22:38:52.333777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:52.338178 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m22:38:52.341954 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m22:38:52.345701 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m22:38:52.349594 [info ] [MainThread]: 
[0m22:38:52.353852 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m22:38:52.358625 [debug] [MainThread]: Command end result
[0m22:38:52.420215 [info ] [MainThread]: 
[0m22:38:52.424202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:38:52.428990 [info ] [MainThread]: 
[0m22:38:52.433059 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:38:52.437509 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 9.114349, "process_user_time": 6.278307, "process_kernel_time": 0.798089, "process_mem_max_rss": "241408", "process_out_blocks": "3120", "process_in_blocks": "0"}
[0m22:38:52.441254 [debug] [MainThread]: Command `dbt build` succeeded at 22:38:52.440963 after 9.12 seconds
[0m22:38:52.445263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd265e5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0b087d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0a72ff40>]}
[0m22:38:52.449414 [debug] [MainThread]: Flushing usage events
[0m22:41:11.812346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33adb2ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ab17e680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ab17e620>]}


============================== 22:41:11.816090 | 4c4f940b-0038-479e-82e3-2007b63e5558 ==============================
[0m22:41:11.816090 [info ] [MainThread]: Running with dbt=1.7.4
[0m22:41:11.820583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:41:13.675963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c4f940b-0038-479e-82e3-2007b63e5558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3392408760>]}
[0m22:41:13.806822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c4f940b-0038-479e-82e3-2007b63e5558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33925cb8b0>]}
[0m22:41:13.812612 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m22:41:13.846935 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m22:41:14.052994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:41:14.057282 [debug] [MainThread]: Partial parsing: updated file: nyc_citi_bikes://models/staging/stg_dim_station.sql
[0m22:41:14.295598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c4f940b-0038-479e-82e3-2007b63e5558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3391cb00d0>]}
[0m22:41:14.356350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c4f940b-0038-479e-82e3-2007b63e5558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33abd2a680>]}
[0m22:41:14.360098 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m22:41:14.365060 [info ] [MainThread]: 
[0m22:41:14.369095 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:41:14.373994 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m22:41:14.377560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:41:14.929988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m22:41:14.934068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:41:15.303929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c4f940b-0038-479e-82e3-2007b63e5558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33abd29a50>]}
[0m22:41:15.312279 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:41:15.316060 [info ] [MainThread]: 
[0m22:41:15.322204 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m22:41:15.323221 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m22:41:15.326570 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m22:41:15.330443 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m22:41:15.334614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m22:41:15.339155 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m22:41:15.342925 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m22:41:15.346694 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m22:41:15.355460 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:41:15.372808 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m22:41:15.382559 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 22:41:15.350213 => 22:41:15.382101
[0m22:41:15.387265 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 22:41:15.359024 => 22:41:15.386802
[0m22:41:15.388066 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m22:41:15.391975 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m22:41:15.454495 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m22:41:15.456354 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m22:41:15.467930 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:41:15.469325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:41:15.521086 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m22:41:15.526976 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)


select 
cast(station_id as string) as station_id, 
cast(station_name as string) as station_name,
cast(date_part as date) as date_part

from stations;


[0m22:41:16.174208 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:03cb6e62-99f4-4b8d-8bc8-c74eb51b25d6&page=queryresults
[0m22:41:16.212782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:14f9a672-a026-4ad2-80d4-ab5e85b42d5b&page=queryresults
[0m22:41:16.510336 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 22:41:15.419942 => 22:41:16.510007
[0m22:41:16.515423 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c4f940b-0038-479e-82e3-2007b63e5558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33abd29810>]}
[0m22:41:16.520147 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 22:41:15.395588 => 22:41:16.519798
[0m22:41:16.521171 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m22:41:16.525506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c4f940b-0038-479e-82e3-2007b63e5558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33abd28100>]}
[0m22:41:16.529462 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m22:41:16.533440 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m22:41:16.540478 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m22:41:16.545006 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m22:41:16.548691 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m22:41:16.553151 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m22:41:16.556965 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m22:41:16.565855 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m22:41:16.578633 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 22:41:16.560263 => 22:41:16.577754
[0m22:41:16.583205 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m22:41:16.602148 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:41:16.987398 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m22:41:17.006219 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m22:41:17.653363 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:70736532-8733-448a-aabb-e4a245b5be03&page=queryresults
[0m22:41:23.250421 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 22:41:16.586803 => 22:41:23.250079
[0m22:41:23.257122 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c4f940b-0038-479e-82e3-2007b63e5558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3391cb2d10>]}
[0m22:41:23.261340 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (1.9m rows, 156.5 MiB processed)[0m in 6.70s]
[0m22:41:23.265284 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m22:41:23.270666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:41:23.274069 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m22:41:23.277172 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m22:41:23.280874 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m22:41:23.283991 [info ] [MainThread]: 
[0m22:41:23.287239 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 8.92 seconds (8.92s).
[0m22:41:23.291365 [debug] [MainThread]: Command end result
[0m22:41:23.353557 [info ] [MainThread]: 
[0m22:41:23.357337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:41:23.360709 [info ] [MainThread]: 
[0m22:41:23.364308 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:41:23.367896 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.627927, "process_user_time": 6.316655, "process_kernel_time": 0.671551, "process_mem_max_rss": "245672", "process_out_blocks": "4352", "process_in_blocks": "0"}
[0m22:41:23.371615 [debug] [MainThread]: Command `dbt build` succeeded at 22:41:23.371368 after 11.63 seconds
[0m22:41:23.374941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33adb2ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33925cb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33913a48b0>]}
[0m22:41:23.378320 [debug] [MainThread]: Flushing usage events
[0m23:38:10.761811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1309d45ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13073aa710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13073aa6b0>]}


============================== 23:38:10.765822 | 8d9c2771-5391-4116-96a2-330020f641cd ==============================
[0m23:38:10.765822 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:38:10.785540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/src/default_repo/dbt/dbt_citi_bikes', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:38:12.795497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d9c2771-5391-4116-96a2-330020f641cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13075139a0>]}
[0m23:38:12.932856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d9c2771-5391-4116-96a2-330020f641cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ee587af0>]}
[0m23:38:12.938138 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m23:38:12.978802 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m23:38:13.011285 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:38:13.015864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d9c2771-5391-4116-96a2-330020f641cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ee3f8e50>]}
[0m23:38:15.384029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d9c2771-5391-4116-96a2-330020f641cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ee5854b0>]}
[0m23:38:15.443627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d9c2771-5391-4116-96a2-330020f641cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1307facca0>]}
[0m23:38:15.447676 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m23:38:15.453411 [info ] [MainThread]: 
[0m23:38:15.458146 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:38:15.463100 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m23:38:15.466706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:16.017677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m23:38:16.022287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:16.380783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d9c2771-5391-4116-96a2-330020f641cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ee3f8160>]}
[0m23:38:16.385860 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:16.390008 [info ] [MainThread]: 
[0m23:38:16.397046 [debug] [Thread-1 (]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m23:38:16.397859 [debug] [Thread-2 (]: Began running node model.nyc_citi_bikes.stg_rides
[0m23:38:16.401744 [info ] [Thread-1 (]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m23:38:16.405762 [info ] [Thread-2 (]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m23:38:16.409863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m23:38:16.414198 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m23:38:16.417958 [debug] [Thread-1 (]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m23:38:16.421862 [debug] [Thread-2 (]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m23:38:16.442138 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m23:38:16.445469 [debug] [Thread-2 (]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m23:38:16.458395 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 23:38:16.425331 => 23:38:16.457835
[0m23:38:16.459624 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 23:38:16.436398 => 23:38:16.459118
[0m23:38:16.461981 [debug] [Thread-1 (]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m23:38:16.465855 [debug] [Thread-2 (]: Began executing node model.nyc_citi_bikes.stg_rides
[0m23:38:16.536205 [debug] [Thread-2 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m23:38:16.537161 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m23:38:16.552142 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:38:16.553531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:16.621525 [debug] [Thread-2 (]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m23:38:16.624699 [debug] [Thread-1 (]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)


select 
cast(station_id as string) as station_id, 
cast(station_name as string) as station_name,
cast(date_part as date) as date_part

from stations;


[0m23:38:17.176318 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:53084cc9-6e82-4567-a792-1368b44c7260&page=queryresults
[0m23:38:17.268975 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:e44984a3-6b08-4d24-81aa-c2a3f7eeea09&page=queryresults
[0m23:38:17.525130 [debug] [Thread-2 (]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 23:38:16.493423 => 23:38:17.524724
[0m23:38:17.530561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d9c2771-5391-4116-96a2-330020f641cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f130802fdf0>]}
[0m23:38:17.534826 [info ] [Thread-2 (]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m23:38:17.538905 [debug] [Thread-2 (]: Finished running node model.nyc_citi_bikes.stg_rides
[0m23:38:17.596134 [debug] [Thread-1 (]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 23:38:16.469503 => 23:38:17.595765
[0m23:38:17.601109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d9c2771-5391-4116-96a2-330020f641cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ed3fdf30>]}
[0m23:38:17.605585 [info ] [Thread-1 (]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m23:38:17.609875 [debug] [Thread-1 (]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m23:38:17.614742 [debug] [Thread-4 (]: Began running node model.nyc_citi_bikes.fact_rides
[0m23:38:17.619300 [info ] [Thread-4 (]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m23:38:17.624026 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m23:38:17.627942 [debug] [Thread-4 (]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m23:38:17.637395 [debug] [Thread-4 (]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m23:38:17.650149 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 23:38:17.631511 => 23:38:17.649568
[0m23:38:17.654090 [debug] [Thread-4 (]: Began executing node model.nyc_citi_bikes.fact_rides
[0m23:38:17.674472 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:38:18.087049 [debug] [Thread-4 (]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m23:38:18.100419 [debug] [Thread-4 (]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "dbt_citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m23:38:18.561809 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:272e30ed-1152-4032-8655-9386a02bba8e&page=queryresults
[0m23:38:23.462019 [debug] [Thread-4 (]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 23:38:17.657638 => 23:38:23.461633
[0m23:38:23.466921 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d9c2771-5391-4116-96a2-330020f641cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ed405630>]}
[0m23:38:23.472147 [info ] [Thread-4 (]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (1.9m rows, 156.5 MiB processed)[0m in 5.84s]
[0m23:38:23.476815 [debug] [Thread-4 (]: Finished running node model.nyc_citi_bikes.fact_rides
[0m23:38:23.483151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:23.487044 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m23:38:23.490933 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m23:38:23.495039 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m23:38:23.498773 [info ] [MainThread]: 
[0m23:38:23.502911 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m23:38:23.507871 [debug] [MainThread]: Command end result
[0m23:38:23.580805 [info ] [MainThread]: 
[0m23:38:23.585176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:38:23.589746 [info ] [MainThread]: 
[0m23:38:23.593703 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:38:23.598375 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.917429, "process_user_time": 8.513437, "process_kernel_time": 0.745584, "process_mem_max_rss": "246284", "process_out_blocks": "4344", "process_in_blocks": "0"}
[0m23:38:23.602937 [debug] [MainThread]: Command `dbt build` succeeded at 23:38:23.602458 after 12.92 seconds
[0m23:38:23.609557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1309d45ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13080b7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ee587af0>]}
[0m23:38:23.613402 [debug] [MainThread]: Flushing usage events
[0m23:45:42.732285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97993c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9744eb1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9744eb370>]}


============================== 23:45:42.735944 | d056e480-8205-4149-99ca-52755eb62149 ==============================
[0m23:45:42.735944 [info ] [MainThread]: Running with dbt=1.7.4
[0m23:45:42.752539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_17e03253-258f-459d-9d6c-f4ff141a8c97', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:45:43.859632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd056e480-8205-4149-99ca-52755eb62149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc967174eb0>]}
[0m23:45:44.006360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd056e480-8205-4149-99ca-52755eb62149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966a497b0>]}
[0m23:45:44.013714 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m23:45:44.061070 [debug] [MainThread]: checksum: d7b2fd4a87f7d6bd7e9de8308909ee6e9b4efb9da4bf90e90d21b601e765db38, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-30T23:45:36.789362',
 'interval_end_datetime': '2024-03-31T23:45:36.789362',
 'interval_start_datetime': '2024-03-30T23:45:36.789362',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m23:45:44.090062 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:45:44.095913 [debug] [MainThread]: previous checksum: d7b2fd4a87f7d6bd7e9de8308909ee6e9b4efb9da4bf90e90d21b601e765db38, current checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc
[0m23:45:44.099847 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:45:44.104998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd056e480-8205-4149-99ca-52755eb62149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966b2a290>]}
[0m23:45:46.413024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd056e480-8205-4149-99ca-52755eb62149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9663a80d0>]}
[0m23:45:46.472437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd056e480-8205-4149-99ca-52755eb62149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966a4a1d0>]}
[0m23:45:46.476587 [info ] [MainThread]: Found 3 models, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m23:45:46.482533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd056e480-8205-4149-99ca-52755eb62149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966b94670>]}
[0m23:45:46.487875 [warn ] [MainThread]: The selection criterion 'dbt/dbt_citi_bikes/models' does not match any nodes
[0m23:45:46.493884 [info ] [MainThread]: 
[0m23:45:46.500338 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:45:46.506995 [debug] [MainThread]: Command end result
[0m23:45:46.560354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9327815, "process_user_time": 26.539204, "process_kernel_time": 13.642461, "process_mem_max_rss": "326000", "process_out_blocks": "3840", "process_in_blocks": "0"}
[0m23:45:46.564907 [debug] [MainThread]: Command `cli run` succeeded at 23:45:46.564575 after 3.94 seconds
[0m23:45:46.568801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97993c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975e37790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9667b62c0>]}
[0m23:45:46.572805 [debug] [MainThread]: Flushing usage events
[0m00:25:20.143887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966758f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9667596c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966759240>]}


============================== 00:25:20.145168 | e0c18f57-7b3d-4a34-8571-96e9b57b5f04 ==============================
[0m00:25:20.145168 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:25:20.161494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_d660cd12-b94b-44e2-8762-9b249ee8f477', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:20.319476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0c18f57-7b3d-4a34-8571-96e9b57b5f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966c86260>]}
[0m00:25:20.325901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0c18f57-7b3d-4a34-8571-96e9b57b5f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9667c4df0>]}
[0m00:25:20.330158 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:25:20.362925 [debug] [MainThread]: checksum: dc174e198cccd316128186c3061c6e12177ea0afa8222e420056f876b991ee3f, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:25:20.034717',
 'interval_end_datetime': '2024-04-01T00:25:20.034717',
 'interval_start_datetime': '2024-03-31T00:25:20.034717',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:25:20.392317 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:25:20.399691 [debug] [MainThread]: previous checksum: dc174e198cccd316128186c3061c6e12177ea0afa8222e420056f876b991ee3f, current checksum: d7b2fd4a87f7d6bd7e9de8308909ee6e9b4efb9da4bf90e90d21b601e765db38
[0m00:25:20.403805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0c18f57-7b3d-4a34-8571-96e9b57b5f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9667c5bd0>]}
[0m00:25:20.434939 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading nyc_citi_bikes: staging/schema.yml - Runtime Error
    Syntax error near line 22
    ------------------------------
    19 |       - name: ride_id
    20 |         description: >
    21 |         This is a primary key for this table
    22 |       tests:
    23 |         - unique:
    24 |             severity: warn
    25 |         - not_null:
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 21, column 9
    could not find expected ':'
      in "<unicode string>", line 22, column 7
[0m00:25:20.441352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3138243, "process_user_time": 29.271357, "process_kernel_time": 18.975765, "process_mem_max_rss": "329428", "process_out_blocks": "4016", "command_success": false, "process_in_blocks": "0"}
[0m00:25:20.445771 [debug] [MainThread]: Command `cli run` failed at 00:25:20.445485 after 0.32 seconds
[0m00:25:20.449335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9744eb4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975e37580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975e35b70>]}
[0m00:25:20.452965 [debug] [MainThread]: Flushing usage events
[0m00:28:52.660764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979a03bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966759990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966759090>]}


============================== 00:28:52.661701 | f5460776-16d9-40b0-b57d-731fa34a3629 ==============================
[0m00:28:52.661701 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:28:52.683551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_7a12a8d1-f67e-44a5-8f44-a335b9cccc56', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:52.821188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5460776-16d9-40b0-b57d-731fa34a3629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966759660>]}
[0m00:28:52.837005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5460776-16d9-40b0-b57d-731fa34a3629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966158820>]}
[0m00:28:52.841417 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:28:52.880789 [debug] [MainThread]: checksum: c203fe6e5be9a7710c6b3ada54db3c583fb8cbd5311f59154d9d6168c86fecb7, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:28:52.553577',
 'interval_end_datetime': '2024-04-01T00:28:52.553577',
 'interval_start_datetime': '2024-03-31T00:28:52.553577',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:28:52.909096 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:28:52.915833 [debug] [MainThread]: previous checksum: c203fe6e5be9a7710c6b3ada54db3c583fb8cbd5311f59154d9d6168c86fecb7, current checksum: d7b2fd4a87f7d6bd7e9de8308909ee6e9b4efb9da4bf90e90d21b601e765db38
[0m00:28:52.919910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5460776-16d9-40b0-b57d-731fa34a3629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957cd7f10>]}
[0m00:28:52.955846 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading nyc_citi_bikes: staging/schema.yml - Runtime Error
    Syntax error near line 22
    ------------------------------
    19 |       - name: ride_id
    20 |         description: This is a primary key for this table
    21 | 
    22 |       tests:
    23 |         - unique:
    24 |             severity: warn
    25 | 
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 19, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 22, column 7
[0m00:28:52.962054 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.31758258, "process_user_time": 30.433937, "process_kernel_time": 19.558224, "process_mem_max_rss": "344828", "process_out_blocks": "4184", "command_success": false, "process_in_blocks": "0"}
[0m00:28:52.966802 [debug] [MainThread]: Command `cli run` failed at 00:28:52.966335 after 0.32 seconds
[0m00:28:52.970647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979a03bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9667634c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966763c40>]}
[0m00:28:52.974269 [debug] [MainThread]: Flushing usage events
[0m00:30:58.912906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979a03700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9669825f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9669824d0>]}


============================== 00:30:58.913893 | 54b88bdd-2bfb-483a-b2ab-27251a5999c7 ==============================
[0m00:30:58.913893 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:30:58.926754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_0c20c7be-0c2d-4ee2-bcde-304e7d322ee4', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:30:59.040335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54b88bdd-2bfb-483a-b2ab-27251a5999c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979a03bb0>]}
[0m00:30:59.064574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54b88bdd-2bfb-483a-b2ab-27251a5999c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966983cd0>]}
[0m00:30:59.069276 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:30:59.099107 [debug] [MainThread]: checksum: 98fe11ed65bae02c1f70572b167aa35fc2ec9cd976f09e3ab7782c1cce80d3c0, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:30:58.580567',
 'interval_end_datetime': '2024-04-01T00:30:58.580567',
 'interval_start_datetime': '2024-03-31T00:30:58.580567',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:30:59.124093 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:30:59.130199 [debug] [MainThread]: previous checksum: 98fe11ed65bae02c1f70572b167aa35fc2ec9cd976f09e3ab7782c1cce80d3c0, current checksum: d7b2fd4a87f7d6bd7e9de8308909ee6e9b4efb9da4bf90e90d21b601e765db38
[0m00:30:59.134234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54b88bdd-2bfb-483a-b2ab-27251a5999c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966982650>]}
[0m00:31:00.964177 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/staging/schema.yml @ models: {'name': 'stg_rides', 'description': 'consists of all the trips that was made in a month\n', 'columns': [{'name': 'ride_id', 'description': 'This is a primary key for this table'}, {'tests': [{'unique': {'severity': 'warn'}}, {'not_null': {'severity': 'warn'}}]}, {'name': 'rideable_type_id', 'description': 'This is an integer that represents the type of bike that was used for a trip. 0 represents classic_bike, and 1 represents electric_bike'}, {'name': 'ride_type', 'description': 'The type of bike used for the trip'}, {'name': 'start_station_id', 'description': 'The station id where the trip started'}, {'name': 'end_station_id', 'description': 'The station id where the trip ended'}, {'name': 'started_at', 'description': 'The date and time when the trip started'}, {'name': 'ended_at', 'description': 'The date and time when the trip ended'}, {'name': 'member_casual_id', 'description': 'This is an integer that identifies if the user is a member or casual rider'}, {'name': 'date_part', 'description': 'partitioned date that contains the latest partition date from the source table'}, {'name': 'member_type', 'description': 'This is string that was generated based on the value of member_casual_id. if member_casual_id is 0 then user is a member, if it is 1 then it was a casual ride'}], 'original_file_path': 'models/staging/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_citi_bikes'} - at path ['columns'][1]: 'name' is a required property
[0m00:31:00.970778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0817974, "process_user_time": 32.956795, "process_kernel_time": 19.903708, "process_mem_max_rss": "344924", "process_out_blocks": "4352", "command_success": false, "process_in_blocks": "0"}
[0m00:31:00.983854 [debug] [MainThread]: Command `cli run` failed at 00:31:00.983542 after 2.09 seconds
[0m00:31:00.988056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979a03700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966855360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9668565c0>]}
[0m00:31:00.992564 [debug] [MainThread]: Flushing usage events
[0m00:33:34.501281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966957c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9669561d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966955f30>]}


============================== 00:33:34.502218 | 7f90a79e-4606-4bee-9fe0-3d944ebc3040 ==============================
[0m00:33:34.502218 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:33:34.517659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_592bcb91-1d25-42d7-9a11-00e508c9e312', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:33:34.654560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f90a79e-4606-4bee-9fe0-3d944ebc3040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957eb6e30>]}
[0m00:33:34.672348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f90a79e-4606-4bee-9fe0-3d944ebc3040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957c25600>]}
[0m00:33:34.686396 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:33:34.731053 [debug] [MainThread]: checksum: a85f472b726ded4cd1e3f2ab23c91d90b99b9f3f60fe1c07402f1fa3a8e68189, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:33:34.393404',
 'interval_end_datetime': '2024-04-01T00:33:34.393404',
 'interval_start_datetime': '2024-03-31T00:33:34.393404',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:33:34.755930 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:33:34.766087 [debug] [MainThread]: previous checksum: a85f472b726ded4cd1e3f2ab23c91d90b99b9f3f60fe1c07402f1fa3a8e68189, current checksum: d7b2fd4a87f7d6bd7e9de8308909ee6e9b4efb9da4bf90e90d21b601e765db38
[0m00:33:34.770295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f90a79e-4606-4bee-9fe0-3d944ebc3040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957c249d0>]}
[0m00:33:36.641306 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/staging/schema.yml @ models: {'name': 'stg_rides', 'description': 'consists of all the trips that was made in a month', 'columns': [{'name': 'ride_id', 'description': 'This is a primary key for this table'}, {'tests': [{'unique': {'severity': 'warn'}}, {'not_null': {'severity': 'warn'}}]}, {'name': 'rideable_type_id', 'description': 'This is an integer that represents the type of bike that was used for a trip. 0 represents classic_bike, and 1 represents electric_bike'}, {'name': 'ride_type', 'description': 'The type of bike used for the trip'}, {'name': 'start_station_id', 'description': 'The station id where the trip started'}, {'name': 'end_station_id', 'description': 'The station id where the trip ended'}, {'name': 'started_at', 'description': 'The date and time when the trip started'}, {'name': 'ended_at', 'description': 'The date and time when the trip ended'}, {'name': 'member_casual_id', 'description': 'This is an integer that identifies if the user is a member or casual rider'}, {'name': 'date_part', 'description': 'partitioned date that contains the latest partition date from the source table'}, {'name': 'member_type', 'description': 'This is string that was generated based on the value of member_casual_id. if member_casual_id is 0 then user is a member, if it is 1 then it was a casual ride'}], 'original_file_path': 'models/staging/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_citi_bikes'} - at path ['columns'][1]: 'name' is a required property
[0m00:33:36.647721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1677575, "process_user_time": 35.246265, "process_kernel_time": 20.288889, "process_mem_max_rss": "348056", "process_out_blocks": "4528", "command_success": false, "process_in_blocks": "0"}
[0m00:33:36.652762 [debug] [MainThread]: Command `cli run` failed at 00:33:36.652389 after 2.17 seconds
[0m00:33:36.656543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966957c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957947670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957946830>]}
[0m00:33:36.660155 [debug] [MainThread]: Flushing usage events
[0m00:35:34.742005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784a950>]}


============================== 00:35:34.742913 | 632403c4-0380-4724-ab8f-b986df566cb7 ==============================
[0m00:35:34.742913 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:35:34.769722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_8f964b2b-178c-47af-be23-da45633515b1', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:35:34.899855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '632403c4-0380-4724-ab8f-b986df566cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784a7d0>]}
[0m00:35:34.908620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '632403c4-0380-4724-ab8f-b986df566cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9578488b0>]}
[0m00:35:34.913017 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:35:34.943710 [debug] [MainThread]: checksum: 2531fb258967fa238410c8ab12615bc48d6115ed5a765bbff794ff6f01081785, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:35:34.637203',
 'interval_end_datetime': '2024-04-01T00:35:34.637203',
 'interval_start_datetime': '2024-03-31T00:35:34.637203',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:35:34.970363 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:35:34.977945 [debug] [MainThread]: previous checksum: 2531fb258967fa238410c8ab12615bc48d6115ed5a765bbff794ff6f01081785, current checksum: d7b2fd4a87f7d6bd7e9de8308909ee6e9b4efb9da4bf90e90d21b601e765db38
[0m00:35:34.982394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '632403c4-0380-4724-ab8f-b986df566cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9578482e0>]}
[0m00:35:36.808082 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_station' in the 'models' section of file 'models/staging/schema.yml'
[0m00:35:36.990711 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nyc_citi_bikes.unique_stg_station_station_id.c9c5a7d97d' (models/staging/schema.yml) depends on a node named 'stg_station' in package '' which was not found
[0m00:35:36.997472 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.nyc_citi_bikes.not_null_stg_station_station_id.76a9f2f4d7' (models/staging/schema.yml) depends on a node named 'stg_station' in package '' which was not found
[0m00:35:37.111730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '632403c4-0380-4724-ab8f-b986df566cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9574840d0>]}
[0m00:35:37.183585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '632403c4-0380-4724-ab8f-b986df566cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784b0d0>]}
[0m00:35:37.188185 [info ] [MainThread]: Found 3 models, 2 tests, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m00:35:37.194145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632403c4-0380-4724-ab8f-b986df566cb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784a980>]}
[0m00:35:37.200177 [warn ] [MainThread]: The selection criterion 'dbt_citi_bikes' does not match any nodes
[0m00:35:37.207311 [info ] [MainThread]: 
[0m00:35:37.212515 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:35:37.219469 [debug] [MainThread]: Command end result
[0m00:35:37.280848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5565, "process_user_time": 37.798428, "process_kernel_time": 20.665476, "process_mem_max_rss": "357400", "process_out_blocks": "8496", "process_in_blocks": "0"}
[0m00:35:37.285799 [debug] [MainThread]: Command `cli run` succeeded at 00:35:37.285101 after 2.56 seconds
[0m00:35:37.289767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95765c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9576caad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784aef0>]}
[0m00:35:37.293720 [debug] [MainThread]: Flushing usage events
[0m00:36:38.106408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957848a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784acb0>]}


============================== 00:36:38.107804 | 4acddcaf-877f-4816-8939-0d9c6904271d ==============================
[0m00:36:38.107804 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:36:38.124124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_4660c88e-3455-4162-8de7-e245301abc3a', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:36:38.251613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4acddcaf-877f-4816-8939-0d9c6904271d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957849660>]}
[0m00:36:38.267558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4acddcaf-877f-4816-8939-0d9c6904271d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784ac20>]}
[0m00:36:38.273111 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:36:38.306906 [debug] [MainThread]: checksum: 52bd09c3447c0202e83176ed96922f9dc3ceb4bb794597afed689ffdf03a281f, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:36:37.997568',
 'interval_end_datetime': '2024-04-01T00:36:37.997568',
 'interval_start_datetime': '2024-03-31T00:36:37.997568',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:36:38.334843 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:36:38.340886 [debug] [MainThread]: previous checksum: 52bd09c3447c0202e83176ed96922f9dc3ceb4bb794597afed689ffdf03a281f, current checksum: 2531fb258967fa238410c8ab12615bc48d6115ed5a765bbff794ff6f01081785
[0m00:36:38.344903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4acddcaf-877f-4816-8939-0d9c6904271d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9578497b0>]}
[0m00:36:40.518491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4acddcaf-877f-4816-8939-0d9c6904271d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96480c370>]}
[0m00:36:40.596347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4acddcaf-877f-4816-8939-0d9c6904271d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957849990>]}
[0m00:36:40.600397 [info ] [MainThread]: Found 3 models, 4 tests, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m00:36:40.606309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4acddcaf-877f-4816-8939-0d9c6904271d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784b520>]}
[0m00:36:40.611130 [warn ] [MainThread]: The selection criterion 'dbt_citi_bikes' does not match any nodes
[0m00:36:40.616823 [info ] [MainThread]: 
[0m00:36:40.622204 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:36:40.628092 [debug] [MainThread]: Command end result
[0m00:36:40.686211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.596377, "process_user_time": 40.22737, "process_kernel_time": 20.849474, "process_mem_max_rss": "357828", "process_out_blocks": "12448", "process_in_blocks": "0"}
[0m00:36:40.690860 [debug] [MainThread]: Command `cli run` succeeded at 00:36:40.690560 after 2.60 seconds
[0m00:36:40.695078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9578c8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957849660>]}
[0m00:36:40.699290 [debug] [MainThread]: Flushing usage events
[0m00:42:52.087528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784a6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784a800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784ba90>]}


============================== 00:42:52.088489 | 86efcf7a-25d0-4efd-b23d-40ca34bef519 ==============================
[0m00:42:52.088489 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:42:52.098518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_deba0085-4054-4941-90ff-95d353564af3', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:42:52.247971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86efcf7a-25d0-4efd-b23d-40ca34bef519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784a1d0>]}
[0m00:42:52.258130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86efcf7a-25d0-4efd-b23d-40ca34bef519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784b820>]}
[0m00:42:52.264919 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:42:52.307764 [debug] [MainThread]: checksum: 322731489f1eed94646901acc052b19882c1c8caa12d68159b5edf5ccf787d2c, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:42:51.968437',
 'interval_end_datetime': '2024-04-01T00:42:51.968437',
 'interval_start_datetime': '2024-03-31T00:42:51.968437',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:42:52.335896 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:42:52.341794 [debug] [MainThread]: previous checksum: 322731489f1eed94646901acc052b19882c1c8caa12d68159b5edf5ccf787d2c, current checksum: 52bd09c3447c0202e83176ed96922f9dc3ceb4bb794597afed689ffdf03a281f
[0m00:42:52.345494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86efcf7a-25d0-4efd-b23d-40ca34bef519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9668ff460>]}
[0m00:42:54.223222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86efcf7a-25d0-4efd-b23d-40ca34bef519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9574717e0>]}
[0m00:42:54.294285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86efcf7a-25d0-4efd-b23d-40ca34bef519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9668ff190>]}
[0m00:42:54.298292 [info ] [MainThread]: Found 3 models, 4 tests, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m00:42:54.303795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86efcf7a-25d0-4efd-b23d-40ca34bef519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9668fd1b0>]}
[0m00:42:54.307984 [warn ] [MainThread]: The selection criterion 'dbt/dbt_citi_bikes/models' does not match any nodes
[0m00:42:54.313252 [info ] [MainThread]: 
[0m00:42:54.318407 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:42:54.324264 [debug] [MainThread]: Command end result
[0m00:42:54.381961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3146017, "process_user_time": 42.63092, "process_kernel_time": 21.760197, "process_mem_max_rss": "357888", "process_out_blocks": "16392", "process_in_blocks": "0"}
[0m00:42:54.386011 [debug] [MainThread]: Command `cli run` succeeded at 00:42:54.385722 after 2.32 seconds
[0m00:42:54.390010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9579afee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957848eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784b820>]}
[0m00:42:54.393678 [debug] [MainThread]: Flushing usage events
[0m00:43:22.700755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957848a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966ac0550>]}


============================== 00:43:22.701696 | 0c8f3060-0d97-48c4-b094-725abc0de600 ==============================
[0m00:43:22.701696 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:43:22.707663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_8f96ec26-488f-433d-8b44-b39ea90d8ef3', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:43:22.800652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c8f3060-0d97-48c4-b094-725abc0de600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966ac2080>]}
[0m00:43:22.807150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c8f3060-0d97-48c4-b094-725abc0de600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966ac18a0>]}
[0m00:43:22.811628 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:43:22.843556 [debug] [MainThread]: checksum: 889a3cf2c31fe61483c8b4d90f7ae4473262b681c3f4fa06fa7ce973a0526055, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:43:22.596309',
 'interval_end_datetime': '2024-04-01T00:43:22.596309',
 'interval_start_datetime': '2024-03-31T00:43:22.596309',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:43:22.867456 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:43:22.873205 [debug] [MainThread]: previous checksum: 889a3cf2c31fe61483c8b4d90f7ae4473262b681c3f4fa06fa7ce973a0526055, current checksum: 322731489f1eed94646901acc052b19882c1c8caa12d68159b5edf5ccf787d2c
[0m00:43:22.876970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c8f3060-0d97-48c4-b094-725abc0de600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957440b50>]}
[0m00:43:24.741981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c8f3060-0d97-48c4-b094-725abc0de600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d6b5e0>]}
[0m00:43:24.807469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c8f3060-0d97-48c4-b094-725abc0de600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95765a470>]}
[0m00:43:24.811685 [info ] [MainThread]: Found 3 models, 4 tests, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m00:43:24.817164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c8f3060-0d97-48c4-b094-725abc0de600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957440a90>]}
[0m00:43:24.822729 [warn ] [MainThread]: The selection criterion 'dbt/dbt_citi_bikes/models' does not match any nodes
[0m00:43:24.829060 [info ] [MainThread]: 
[0m00:43:24.834541 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:43:24.840092 [debug] [MainThread]: Command end result
[0m00:43:24.900901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2192748, "process_user_time": 44.70192, "process_kernel_time": 21.838976, "process_mem_max_rss": "358728", "process_out_blocks": "20336", "process_in_blocks": "0"}
[0m00:43:24.905852 [debug] [MainThread]: Command `cli run` succeeded at 00:43:24.905408 after 2.22 seconds
[0m00:43:24.909915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95784c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966ac18a0>]}
[0m00:43:24.914224 [debug] [MainThread]: Flushing usage events
[0m00:46:18.714714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a8480d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957c913f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957c90d90>]}


============================== 00:46:18.715771 | 5849c680-c943-4d5e-a01a-d346591eeb33 ==============================
[0m00:46:18.715771 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:46:18.731622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_84a9b920-a6b2-4555-887c-69ae7850b351', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:46:18.837475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5849c680-c943-4d5e-a01a-d346591eeb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957c90a90>]}
[0m00:46:18.844206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5849c680-c943-4d5e-a01a-d346591eeb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957c91870>]}
[0m00:46:18.848442 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:46:18.878686 [debug] [MainThread]: checksum: 5ada4b2b5915626df04b63e929e38a9addf9f5c95bcc9fd414d220f582e0fed3, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:46:18.616660',
 'interval_end_datetime': '2024-04-01T00:46:18.616660',
 'interval_start_datetime': '2024-03-31T00:46:18.616660',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:46:18.906626 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:46:18.913564 [debug] [MainThread]: previous checksum: 5ada4b2b5915626df04b63e929e38a9addf9f5c95bcc9fd414d220f582e0fed3, current checksum: 889a3cf2c31fe61483c8b4d90f7ae4473262b681c3f4fa06fa7ce973a0526055
[0m00:46:18.917678 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:46:18.922658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5849c680-c943-4d5e-a01a-d346591eeb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957c91480>]}
[0m00:46:20.733434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_citi_bikes.core
- models.dbt_citi_bikes.staging
[0m00:46:20.747132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5849c680-c943-4d5e-a01a-d346591eeb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9571ec3d0>]}
[0m00:46:21.093600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5849c680-c943-4d5e-a01a-d346591eeb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957142710>]}
[0m00:46:21.097562 [info ] [MainThread]: Found 3 models, 4 tests, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m00:46:21.103128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5849c680-c943-4d5e-a01a-d346591eeb33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957141300>]}
[0m00:46:21.107424 [warn ] [MainThread]: The selection criterion 'dbt/dbt_citi_bikes/models' does not match any nodes
[0m00:46:21.112799 [info ] [MainThread]: 
[0m00:46:21.117339 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:46:21.122539 [debug] [MainThread]: Command end result
[0m00:46:21.173837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.472727, "process_user_time": 47.1106, "process_kernel_time": 22.252096, "process_mem_max_rss": "361556", "process_out_blocks": "24304", "process_in_blocks": "0"}
[0m00:46:21.177556 [debug] [MainThread]: Command `cli run` succeeded at 00:46:21.177291 after 2.48 seconds
[0m00:46:21.181142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a8480d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957141270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957141f00>]}
[0m00:46:21.184463 [debug] [MainThread]: Flushing usage events
[0m00:54:10.521770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d69390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d693c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d6b1c0>]}


============================== 00:54:10.522660 | a51d978b-2af0-40e4-95bc-d1ce4beb66ed ==============================
[0m00:54:10.522660 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:54:10.539233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_c28fcec7-6b17-4ea0-8246-7d1c3fe82a9c', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:54:10.646653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a51d978b-2af0-40e4-95bc-d1ce4beb66ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d6bc40>]}
[0m00:54:11.865979 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zb6_6mv8'
[0m00:54:11.871943 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:54:11.966420 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:54:11.974136 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:54:12.058782 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:54:12.071906 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m00:54:12.152421 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m00:54:12.162086 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:54:15.872146 [info ] [MainThread]: Installed from version 1.1.1
[0m00:54:15.877696 [info ] [MainThread]: Up to date!
[0m00:54:15.882609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a51d978b-2af0-40e4-95bc-d1ce4beb66ed', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96625f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96625e980>]}
[0m00:54:15.886197 [info ] [MainThread]: Installing dbt-labs/codegen
[0m00:54:17.317451 [info ] [MainThread]: Installed from version 0.12.1
[0m00:54:17.322275 [info ] [MainThread]: Up to date!
[0m00:54:17.326940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a51d978b-2af0-40e4-95bc-d1ce4beb66ed', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96625f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d684c0>]}
[0m00:54:17.330580 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.8246074, "process_user_time": 48.18651, "process_kernel_time": 23.573223, "process_mem_max_rss": "361624", "process_out_blocks": "27192", "process_in_blocks": "0"}
[0m00:54:17.333942 [debug] [MainThread]: Command `cli deps` succeeded at 00:54:17.333686 after 6.83 seconds
[0m00:54:17.336927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96625e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96625f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96625f940>]}
[0m00:54:17.340238 [debug] [MainThread]: Flushing usage events
[0m00:54:17.667633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d69e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d698d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d6b280>]}


============================== 00:54:17.668523 | 7e5367f0-a816-4a04-8d6b-78a3df885b0c ==============================
[0m00:54:17.668523 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:54:17.674047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_c28fcec7-6b17-4ea0-8246-7d1c3fe82a9c', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:54:17.755524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d689d0>]}
[0m00:54:17.762275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d69bd0>]}
[0m00:54:17.766707 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:54:17.804510 [debug] [MainThread]: checksum: df6a14604ae9ce7be57295a620e8416a335e164495e0278652f99055e933e309, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:54:10.427787',
 'interval_end_datetime': '2024-04-01T00:54:10.427787',
 'interval_start_datetime': '2024-03-31T00:54:10.427787',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:54:17.841549 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:54:17.847115 [debug] [MainThread]: previous checksum: df6a14604ae9ce7be57295a620e8416a335e164495e0278652f99055e933e309, current checksum: 5ada4b2b5915626df04b63e929e38a9addf9f5c95bcc9fd414d220f582e0fed3
[0m00:54:17.850739 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:54:17.856267 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:54:17.861321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9573e7fd0>]}
[0m00:54:19.782557 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_citi_bikes.core
- models.dbt_citi_bikes.staging
[0m00:54:19.796952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966730b50>]}
[0m00:54:19.864581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9578c93f0>]}
[0m00:54:19.868738 [info ] [MainThread]: Found 3 models, 4 tests, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m00:54:19.874981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9573e6440>]}
[0m00:54:19.880129 [info ] [MainThread]: 
[0m00:54:19.885973 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:54:19.891390 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m00:54:19.895472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:20.428631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m00:54:20.432646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:20.786124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc964474b20>]}
[0m00:54:20.791400 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:54:20.797063 [info ] [MainThread]: 
[0m00:54:20.804743 [debug] [Thread-16 ]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m00:54:20.805545 [debug] [Thread-17 ]: Began running node model.nyc_citi_bikes.stg_rides
[0m00:54:20.809373 [info ] [Thread-16 ]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m00:54:20.813812 [info ] [Thread-17 ]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m00:54:20.819499 [debug] [Thread-16 ]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m00:54:20.822271 [debug] [Thread-17 ]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m00:54:20.823820 [debug] [Thread-16 ]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m00:54:20.827180 [debug] [Thread-17 ]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m00:54:20.835997 [debug] [Thread-16 ]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m00:54:20.846382 [debug] [Thread-17 ]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m00:54:20.884614 [debug] [Thread-16 ]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 00:54:20.830318 => 00:54:20.884053
[0m00:54:20.885834 [debug] [Thread-17 ]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 00:54:20.838682 => 00:54:20.885421
[0m00:54:20.888618 [debug] [Thread-16 ]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m00:54:20.892587 [debug] [Thread-17 ]: Began executing node model.nyc_citi_bikes.stg_rides
[0m00:54:20.955458 [debug] [Thread-16 ]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m00:54:20.958296 [debug] [Thread-17 ]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m00:54:20.970841 [debug] [Thread-16 ]: Opening a new connection, currently in state closed
[0m00:54:20.972417 [debug] [Thread-17 ]: Opening a new connection, currently in state init
[0m00:54:21.039813 [debug] [Thread-16 ]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)


select 
cast(station_id as string) as station_id, 
cast(station_name as string) as station_name,
cast(date_part as date) as date_part

from stations;


[0m00:54:21.043823 [debug] [Thread-17 ]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m00:54:21.667484 [debug] [Thread-16 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:f8044f1a-fb1a-4062-9436-96ba862c41ec&page=queryresults
[0m00:54:21.732385 [debug] [Thread-17 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:e8afc2ad-154f-46b4-ac76-51ac471a0527&page=queryresults
[0m00:54:22.010508 [debug] [Thread-16 ]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 00:54:20.897135 => 00:54:22.010147
[0m00:54:22.016076 [debug] [Thread-16 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95732c880>]}
[0m00:54:22.020585 [info ] [Thread-16 ]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m00:54:22.026760 [debug] [Thread-16 ]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m00:54:22.065710 [debug] [Thread-17 ]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 00:54:20.920822 => 00:54:22.065375
[0m00:54:22.071185 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957af8fd0>]}
[0m00:54:22.075736 [info ] [Thread-17 ]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m00:54:22.082379 [debug] [Thread-17 ]: Finished running node model.nyc_citi_bikes.stg_rides
[0m00:54:22.087151 [debug] [Thread-19 ]: Began running node model.nyc_citi_bikes.fact_rides
[0m00:54:22.091369 [info ] [Thread-19 ]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m00:54:22.098624 [debug] [Thread-19 ]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m00:54:22.103099 [debug] [Thread-19 ]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m00:54:22.112251 [debug] [Thread-19 ]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m00:54:22.124620 [debug] [Thread-19 ]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 00:54:22.106355 => 00:54:22.124044
[0m00:54:22.128667 [debug] [Thread-19 ]: Began executing node model.nyc_citi_bikes.fact_rides
[0m00:54:22.149781 [debug] [Thread-19 ]: Opening a new connection, currently in state init
[0m00:54:22.545427 [debug] [Thread-19 ]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m00:54:22.558084 [debug] [Thread-19 ]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m00:54:23.082723 [debug] [Thread-19 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:90f03a82-3f96-46a9-8718-f248218ea66b&page=queryresults
[0m00:55:48.151022 [debug] [Thread-19 ]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 00:54:22.132359 => 00:55:48.150665
[0m00:55:48.155146 [debug] [Thread-19 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e5367f0-a816-4a04-8d6b-78a3df885b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966ac1690>]}
[0m00:55:48.187618 [info ] [Thread-19 ]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (1.9m rows, 156.5 MiB processed)[0m in 86.06s]
[0m00:55:48.218266 [debug] [Thread-19 ]: Finished running node model.nyc_citi_bikes.fact_rides
[0m00:55:48.227302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:48.231010 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m00:55:48.234609 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m00:55:48.238254 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m00:55:48.241952 [info ] [MainThread]: 
[0m00:55:48.246992 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 1 minutes and 28.36 seconds (88.36s).
[0m00:55:48.252899 [debug] [MainThread]: Command end result
[0m00:55:48.357239 [info ] [MainThread]: 
[0m00:55:48.362547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:55:48.367436 [info ] [MainThread]: 
[0m00:55:48.382246 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:55:48.388034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 90.73358, "process_user_time": 51.395138, "process_kernel_time": 23.862934, "process_mem_max_rss": "372076", "process_out_blocks": "31696", "process_in_blocks": "0"}
[0m00:55:48.396849 [debug] [MainThread]: Command `cli run` succeeded at 00:55:48.396536 after 90.74 seconds
[0m00:55:48.400881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96469f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d689d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966b28640>]}
[0m00:55:48.404587 [debug] [MainThread]: Flushing usage events
[0m00:56:11.604003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783ba30>]}


============================== 00:56:11.604926 | f4d40f49-04eb-4734-8586-60d963d638ee ==============================
[0m00:56:11.604926 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:56:11.610381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_ac13cc53-64f7-4f0e-aa50-eab2c391874e', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:11.710449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4d40f49-04eb-4734-8586-60d963d638ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783bcd0>]}
[0m00:56:12.880906 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-29scqf4w'
[0m00:56:12.891911 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:56:16.663964 [info ] [MainThread]: Installed from version 1.1.1
[0m00:56:16.669277 [info ] [MainThread]: Up to date!
[0m00:56:16.674928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f4d40f49-04eb-4734-8586-60d963d638ee', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783ba00>]}
[0m00:56:16.678736 [info ] [MainThread]: Installing dbt-labs/codegen
[0m00:56:18.102086 [info ] [MainThread]: Installed from version 0.12.1
[0m00:56:18.107919 [info ] [MainThread]: Up to date!
[0m00:56:18.113627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f4d40f49-04eb-4734-8586-60d963d638ee', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9573d1570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783b3d0>]}
[0m00:56:18.117834 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 6.5287695, "process_user_time": 51.92852, "process_kernel_time": 24.142948, "process_mem_max_rss": "372076", "process_out_blocks": "34536", "process_in_blocks": "0"}
[0m00:56:18.121627 [debug] [MainThread]: Command `cli deps` succeeded at 00:56:18.121380 after 6.53 seconds
[0m00:56:18.125078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783bcd0>]}
[0m00:56:18.128705 [debug] [MainThread]: Flushing usage events
[0m00:56:18.452984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783b9d0>]}


============================== 00:56:18.453869 | 13873ef6-ea09-45e4-bcea-312357d99c98 ==============================
[0m00:56:18.453869 [info ] [MainThread]: Running with dbt=1.7.4
[0m00:56:18.459271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_ac13cc53-64f7-4f0e-aa50-eab2c391874e', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:56:18.547881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783af20>]}
[0m00:56:18.555021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783b010>]}
[0m00:56:18.559096 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m00:56:18.599544 [debug] [MainThread]: checksum: c77cb961484757799289af042604ee118fa46ec1bdd6bc5b98447d1797e20d3f, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T00:56:11.503088',
 'interval_end_datetime': '2024-04-01T00:56:11.503088',
 'interval_start_datetime': '2024-03-31T00:56:11.503088',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m00:56:18.627118 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:56:18.633026 [debug] [MainThread]: previous checksum: c77cb961484757799289af042604ee118fa46ec1bdd6bc5b98447d1797e20d3f, current checksum: df6a14604ae9ce7be57295a620e8416a335e164495e0278652f99055e933e309
[0m00:56:18.636885 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:56:18.641419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957ce4880>]}
[0m00:56:20.552223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9577e9ed0>]}
[0m00:56:20.614621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9577336a0>]}
[0m00:56:20.618759 [info ] [MainThread]: Found 3 models, 4 tests, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m00:56:20.624154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957ce4b20>]}
[0m00:56:20.628909 [info ] [MainThread]: 
[0m00:56:20.634226 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:56:20.638627 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m00:56:20.642026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:56:21.167702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m00:56:21.172559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:56:21.549770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957c35600>]}
[0m00:56:21.555109 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:56:21.560439 [info ] [MainThread]: 
[0m00:56:21.567973 [debug] [Thread-24 ]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m00:56:21.568795 [debug] [Thread-25 ]: Began running node model.nyc_citi_bikes.stg_rides
[0m00:56:21.572347 [info ] [Thread-24 ]: 1 of 3 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m00:56:21.576361 [info ] [Thread-25 ]: 2 of 3 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m00:56:21.581034 [debug] [Thread-24 ]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m00:56:21.584193 [debug] [Thread-25 ]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m00:56:21.585781 [debug] [Thread-24 ]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m00:56:21.590010 [debug] [Thread-25 ]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m00:56:21.598754 [debug] [Thread-24 ]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m00:56:21.608904 [debug] [Thread-25 ]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m00:56:21.616258 [debug] [Thread-24 ]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 00:56:21.593149 => 00:56:21.615750
[0m00:56:21.619650 [debug] [Thread-24 ]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m00:56:21.620681 [debug] [Thread-25 ]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 00:56:21.601244 => 00:56:21.620286
[0m00:56:21.627451 [debug] [Thread-24 ]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m00:56:21.630584 [debug] [Thread-25 ]: Began executing node model.nyc_citi_bikes.stg_rides
[0m00:56:21.646993 [debug] [Thread-25 ]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m00:56:21.647889 [debug] [Thread-24 ]: Opening a new connection, currently in state closed
[0m00:56:21.657881 [debug] [Thread-25 ]: Opening a new connection, currently in state init
[0m00:56:21.704759 [debug] [Thread-24 ]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 

with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)


select 
cast(station_id as string) as station_id, 
cast(station_name as string) as station_name,
cast(date_part as date) as date_part

from stations;


[0m00:56:21.711243 [debug] [Thread-25 ]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`citi_bikes`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m00:56:22.252466 [debug] [Thread-24 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:138517d0-55b3-426a-b13c-91867fe11c4b&page=queryresults
[0m00:56:22.367917 [debug] [Thread-25 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:9927eff0-4ead-4e57-be2b-04d4d641dcc5&page=queryresults
[0m00:56:22.549103 [debug] [Thread-24 ]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 00:56:21.622516 => 00:56:22.548731
[0m00:56:22.554091 [debug] [Thread-24 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957628cd0>]}
[0m00:56:22.558149 [info ] [Thread-24 ]: 1 of 3 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m00:56:22.563982 [debug] [Thread-24 ]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m00:56:22.689231 [debug] [Thread-25 ]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 00:56:21.636253 => 00:56:22.688685
[0m00:56:22.694320 [debug] [Thread-25 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957628490>]}
[0m00:56:22.698404 [info ] [Thread-25 ]: 2 of 3 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m00:56:22.704717 [debug] [Thread-25 ]: Finished running node model.nyc_citi_bikes.stg_rides
[0m00:56:22.709625 [debug] [Thread-27 ]: Began running node model.nyc_citi_bikes.fact_rides
[0m00:56:22.714084 [info ] [Thread-27 ]: 3 of 3 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m00:56:22.720223 [debug] [Thread-27 ]: Acquiring new bigquery connection 'model.nyc_citi_bikes.fact_rides'
[0m00:56:22.724266 [debug] [Thread-27 ]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m00:56:22.733212 [debug] [Thread-27 ]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m00:56:22.744094 [debug] [Thread-27 ]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 00:56:22.727421 => 00:56:22.743593
[0m00:56:22.747937 [debug] [Thread-27 ]: Began executing node model.nyc_citi_bikes.fact_rides
[0m00:56:22.755226 [debug] [Thread-27 ]: Opening a new connection, currently in state init
[0m00:56:23.116994 [debug] [Thread-27 ]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m00:56:23.128784 [debug] [Thread-27 ]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m00:56:23.648001 [debug] [Thread-27 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:e2e055bd-e023-4629-8e30-ea24df13c0b6&page=queryresults
[0m00:56:29.696905 [debug] [Thread-27 ]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 00:56:22.751192 => 00:56:29.696554
[0m00:56:29.702032 [debug] [Thread-27 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13873ef6-ea09-45e4-bcea-312357d99c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9577e59c0>]}
[0m00:56:29.706138 [info ] [Thread-27 ]: 3 of 3 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (1.9m rows, 156.5 MiB processed)[0m in 6.98s]
[0m00:56:29.711838 [debug] [Thread-27 ]: Finished running node model.nyc_citi_bikes.fact_rides
[0m00:56:29.717957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:29.721758 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m00:56:29.725483 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m00:56:29.728651 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m00:56:29.732012 [info ] [MainThread]: 
[0m00:56:29.737777 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m00:56:29.743588 [debug] [MainThread]: Command end result
[0m00:56:29.817750 [info ] [MainThread]: 
[0m00:56:29.823706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:56:29.829020 [info ] [MainThread]: 
[0m00:56:29.834576 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:56:29.839779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.399883, "process_user_time": 54.838, "process_kernel_time": 24.235268, "process_mem_max_rss": "374444", "process_out_blocks": "39024", "process_in_blocks": "0"}
[0m00:56:29.844038 [debug] [MainThread]: Command `cli run` succeeded at 00:56:29.843784 after 11.40 seconds
[0m00:56:29.847839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95774e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc95783b010>]}
[0m00:56:29.851802 [debug] [MainThread]: Flushing usage events
[0m06:44:54.397167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957731f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d6f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957d6fa90>]}


============================== 06:44:54.398105 | 15d6bae7-18c2-4161-bc8d-2b3e8e3debb4 ==============================
[0m06:44:54.398105 [info ] [MainThread]: Running with dbt=1.7.4
[0m06:44:54.408479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_18622212-f46e-4571-98f1-9621f90c31a2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:44:54.523203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15d6bae7-18c2-4161-bc8d-2b3e8e3debb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957c62a70>]}
[0m06:44:55.770988 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rv5jzc9b'
[0m06:44:55.794482 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:44:59.739471 [error] [MainThread]: Encountered an error:

[0m06:44:59.765227 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 151, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 492, in deps
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/deps.py", line 255, in run
    package.install(self.project, renderer)
  File "/usr/local/lib/python3.10/site-packages/dbt/deps/registry.py", line 66, in install
    self._install(project, renderer)
  File "/usr/local/lib/python3.10/site-packages/dbt/deps/base.py", line 121, in _install
    connection_exception_retry(download_untar_fn, 5)
  File "/usr/local/lib/python3.10/site-packages/dbt/utils.py", line 607, in _connection_exception_retry
    return fn()
  File "/usr/local/lib/python3.10/site-packages/dbt/deps/base.py", line 133, in download_and_untar
    system.untar_package(tar_path, deps_path, package_name)
  File "/usr/local/lib/python3.10/site-packages/dbt/clients/system.py", line 500, in untar_package
    tarball.extractall(dest_dir)
  File "/usr/local/lib/python3.10/tarfile.py", line 2264, in extractall
    self._extract_one(tarinfo, path, set_attrs=not tarinfo.isdir(),
  File "/usr/local/lib/python3.10/tarfile.py", line 2327, in _extract_one
    self._extract_member(tarinfo, os.path.join(path, tarinfo.name),
  File "/usr/local/lib/python3.10/tarfile.py", line 2410, in _extract_member
    self.makefile(tarinfo, targetpath)
  File "/usr/local/lib/python3.10/tarfile.py", line 2456, in makefile
    if tarinfo.sparse is not None:
KeyboardInterrupt

[0m06:44:59.772816 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 5.3997746, "process_user_time": 131.50883, "process_kernel_time": 69.411545, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "42944", "command_success": false}
[0m06:44:59.777783 [debug] [MainThread]: Command `cli deps` failed at 06:44:59.777490 after 5.40 seconds
[0m06:44:59.782813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957731f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966a59d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957766500>]}
[0m06:44:59.787131 [debug] [MainThread]: Flushing usage events
[0m06:45:00.162928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979beb400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957733c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957732d10>]}


============================== 06:45:00.163906 | 48c2d2ea-5c9a-483a-af18-8f6c419cbb6f ==============================
[0m06:45:00.163906 [info ] [MainThread]: Running with dbt=1.7.4
[0m06:45:00.169539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_18622212-f46e-4571-98f1-9621f90c31a2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:45:00.339967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48c2d2ea-5c9a-483a-af18-8f6c419cbb6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966a58040>]}
[0m06:45:00.347287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48c2d2ea-5c9a-483a-af18-8f6c419cbb6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc966a59960>]}
[0m06:45:00.352070 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m06:45:00.359809 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 1 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m06:45:00.365381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.21662249, "process_user_time": 131.67728, "process_kernel_time": 69.48579, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "43040", "command_success": false}
[0m06:45:00.369491 [debug] [MainThread]: Command `cli run` failed at 06:45:00.369066 after 0.22 seconds
[0m06:45:00.378915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc979beb400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913f0f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913f0f5b0>]}
[0m06:45:00.383409 [debug] [MainThread]: Flushing usage events
[0m07:02:13.693013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957732e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957732710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b5cbd60>]}


============================== 07:02:13.695342 | af7504d8-ade6-4aa7-9a43-f8d85bad2b6f ==============================
[0m07:02:13.695342 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:02:13.712588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_e73e009d-8106-45cf-9a0c-8128621a6c6e', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:02:13.852923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af7504d8-ade6-4aa7-9a43-f8d85bad2b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b5caf50>]}
[0m07:02:14.865808 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rv5jzc9b'
[0m07:02:14.877456 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:02:19.351033 [info ] [MainThread]: Installed from version 1.1.1
[0m07:02:19.357227 [info ] [MainThread]: Up to date!
[0m07:02:19.363001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'af7504d8-ade6-4aa7-9a43-f8d85bad2b6f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92052e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92052ceb0>]}
[0m07:02:19.367101 [info ] [MainThread]: Installing dbt-labs/codegen
[0m07:02:21.041650 [info ] [MainThread]: Installed from version 0.12.1
[0m07:02:21.047435 [info ] [MainThread]: Up to date!
[0m07:02:21.053614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'af7504d8-ade6-4aa7-9a43-f8d85bad2b6f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957766500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b5cb520>]}
[0m07:02:21.058340 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.3874803, "process_user_time": 133.52913, "process_kernel_time": 73.248566, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "45880"}
[0m07:02:21.062904 [debug] [MainThread]: Command `cli deps` succeeded at 07:02:21.062637 after 7.39 seconds
[0m07:02:21.067206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957732e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b5c9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b5caf50>]}
[0m07:02:21.071413 [debug] [MainThread]: Flushing usage events
[0m07:02:21.437080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957733d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92052cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92052ceb0>]}


============================== 07:02:21.438185 | 57d88ab8-ca5c-4c1a-86c0-c6266704d25a ==============================
[0m07:02:21.438185 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:02:21.444190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_e73e009d-8106-45cf-9a0c-8128621a6c6e', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:02:21.629133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57d88ab8-ca5c-4c1a-86c0-c6266704d25a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b5cb8b0>]}
[0m07:02:21.636201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57d88ab8-ca5c-4c1a-86c0-c6266704d25a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92052d300>]}
[0m07:02:21.640496 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m07:02:21.682029 [debug] [MainThread]: checksum: ed5a988cbd2027531ef43ceb26d4ddf1f88e87de8002bd741522daf27fa3ffc8, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T07:02:13.566011',
 'interval_end_datetime': '2024-04-01T07:02:13.566011',
 'interval_start_datetime': '2024-03-31T07:02:13.566011',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m07:02:21.715577 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:02:21.724326 [debug] [MainThread]: previous checksum: ed5a988cbd2027531ef43ceb26d4ddf1f88e87de8002bd741522daf27fa3ffc8, current checksum: c77cb961484757799289af042604ee118fa46ec1bdd6bc5b98447d1797e20d3f
[0m07:02:21.728737 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:02:21.734440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57d88ab8-ca5c-4c1a-86c0-c6266704d25a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9381c9fc0>]}
[0m07:02:23.644278 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_get_partition_date (models/staging/stg_get_partition_date.sql)
  No filter named 'dateadd'.
    line 4
      {% set previous_month_date = execution_date | dateadd(-1, 'month') %}
[0m07:02:23.651776 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2293184, "process_user_time": 135.41364, "process_kernel_time": 73.30135, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "46016", "command_success": false}
[0m07:02:23.656275 [debug] [MainThread]: Command `cli run` failed at 07:02:23.655972 after 2.23 seconds
[0m07:02:23.660348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc957733d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b91a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b9192d0>]}
[0m07:02:23.664424 [debug] [MainThread]: Flushing usage events
[0m07:12:03.043963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a8480d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92052e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92052e3b0>]}


============================== 07:12:03.045096 | b7e2eaac-1d0e-41ae-9a5e-22906e7a77d8 ==============================
[0m07:12:03.045096 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:12:03.056267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_d91da298-045f-45ee-8906-7ad5c86696ca', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:12:03.246173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7e2eaac-1d0e-41ae-9a5e-22906e7a77d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b5cbdc0>]}
[0m07:12:04.420874 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rv5jzc9b'
[0m07:12:04.431684 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:12:08.423994 [info ] [MainThread]: Installed from version 1.1.1
[0m07:12:08.430264 [info ] [MainThread]: Up to date!
[0m07:12:08.435947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7e2eaac-1d0e-41ae-9a5e-22906e7a77d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9119b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bd21660>]}
[0m07:12:08.439920 [info ] [MainThread]: Installing dbt-labs/codegen
[0m07:12:10.065687 [info ] [MainThread]: Installed from version 0.12.1
[0m07:12:10.073750 [info ] [MainThread]: Up to date!
[0m07:12:10.080876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7e2eaac-1d0e-41ae-9a5e-22906e7a77d8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9119b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bd21a50>]}
[0m07:12:10.085290 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.05642, "process_user_time": 136.78607, "process_kernel_time": 75.63244, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "48856"}
[0m07:12:10.092868 [debug] [MainThread]: Command `cli deps` succeeded at 07:12:10.092554 after 7.06 seconds
[0m07:12:10.097470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97a8480d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b5cab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bd21d20>]}
[0m07:12:10.101732 [debug] [MainThread]: Flushing usage events
[0m07:12:10.476088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bd228f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bd22da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bd223e0>]}


============================== 07:12:10.477012 | be2d6c04-6257-47ed-a418-a2c539b6537b ==============================
[0m07:12:10.477012 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:12:10.483076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_d91da298-045f-45ee-8906-7ad5c86696ca', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:12:10.590677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be2d6c04-6257-47ed-a418-a2c539b6537b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bd22080>]}
[0m07:12:10.597819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be2d6c04-6257-47ed-a418-a2c539b6537b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bd227a0>]}
[0m07:12:10.603707 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m07:12:10.651980 [debug] [MainThread]: checksum: 1013e9c1acc4e473ff3ab73ea4614dfc3597d326f3e7eaae8bb94728853f29ea, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'run'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T07:12:02.923480',
 'interval_end_datetime': '2024-04-01T07:12:02.923480',
 'interval_start_datetime': '2024-03-31T07:12:02.923480',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m07:12:10.680578 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:12:10.689366 [debug] [MainThread]: previous checksum: 1013e9c1acc4e473ff3ab73ea4614dfc3597d326f3e7eaae8bb94728853f29ea, current checksum: c77cb961484757799289af042604ee118fa46ec1bdd6bc5b98447d1797e20d3f
[0m07:12:10.693892 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:12:10.699912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be2d6c04-6257-47ed-a418-a2c539b6537b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92052c9d0>]}
[0m07:12:12.703770 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_citi_bikes.stg_dim_station' (models/staging/stg_dim_station.sql) depends on a node named 'partition_date' which was not found
[0m07:12:12.711309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2788374, "process_user_time": 138.71217, "process_kernel_time": 75.691574, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "48992", "command_success": false}
[0m07:12:12.716098 [debug] [MainThread]: Command `cli run` failed at 07:12:12.715787 after 2.28 seconds
[0m07:12:12.719923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bd228f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91be33070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913475ed0>]}
[0m07:12:12.723860 [debug] [MainThread]: Flushing usage events
[0m07:14:31.925065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913925b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9139257b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913926830>]}


============================== 07:14:31.925901 | 8256bcd5-7978-4f02-93d1-07b957e77d88 ==============================
[0m07:14:31.925901 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:14:31.931207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_a0fe7081-e45b-47c8-82a0-a7aa2ac42353', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:14:32.054044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8256bcd5-7978-4f02-93d1-07b957e77d88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913925ab0>]}
[0m07:14:33.335830 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rv5jzc9b'
[0m07:14:33.346375 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:14:37.437137 [info ] [MainThread]: Installed from version 1.1.1
[0m07:14:37.443366 [info ] [MainThread]: Up to date!
[0m07:14:37.449262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8256bcd5-7978-4f02-93d1-07b957e77d88', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913925660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913925720>]}
[0m07:14:37.453528 [info ] [MainThread]: Installing dbt-labs/codegen
[0m07:14:39.093144 [info ] [MainThread]: Installed from version 0.12.1
[0m07:14:39.099023 [info ] [MainThread]: Up to date!
[0m07:14:39.104696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8256bcd5-7978-4f02-93d1-07b957e77d88', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc955e2eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9139265c0>]}
[0m07:14:39.109164 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.198064, "process_user_time": 139.63712, "process_kernel_time": 76.5187, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "51832"}
[0m07:14:39.113177 [debug] [MainThread]: Command `cli deps` succeeded at 07:14:39.112870 after 7.20 seconds
[0m07:14:39.117855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913925b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913925cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913925ab0>]}
[0m07:14:39.121785 [debug] [MainThread]: Flushing usage events
[0m07:14:39.450927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9139258d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913925f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc913925f90>]}


============================== 07:14:39.451781 | 1386d60b-ab3f-429a-bf3e-f9ab74cac50b ==============================
[0m07:14:39.451781 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:14:39.457696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_a0fe7081-e45b-47c8-82a0-a7aa2ac42353', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:14:39.574679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1386d60b-ab3f-429a-bf3e-f9ab74cac50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9139262f0>]}
[0m07:14:39.587967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1386d60b-ab3f-429a-bf3e-f9ab74cac50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9139265f0>]}
[0m07:14:39.592896 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m07:14:39.636221 [debug] [MainThread]: checksum: 718f6deb113fb93957e25d2f9adb4a6620c7a41248621a648aecfc8b0d7ca3c2, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'build'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T07:14:31.801723',
 'interval_end_datetime': '2024-04-01T07:14:31.801723',
 'interval_start_datetime': '2024-03-31T07:14:31.801723',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m07:14:39.664009 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:14:39.670002 [debug] [MainThread]: previous checksum: 718f6deb113fb93957e25d2f9adb4a6620c7a41248621a648aecfc8b0d7ca3c2, current checksum: c77cb961484757799289af042604ee118fa46ec1bdd6bc5b98447d1797e20d3f
[0m07:14:39.674111 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:14:39.680875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1386d60b-ab3f-429a-bf3e-f9ab74cac50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bea91b0>]}
[0m07:14:41.690704 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_citi_bikes.stg_dim_station' (models/staging/stg_dim_station.sql) depends on a node named 'partition_date' which was not found
[0m07:14:41.697905 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.2592685, "process_user_time": 141.5966, "process_kernel_time": 76.561295, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "51968", "command_success": false}
[0m07:14:41.705108 [debug] [MainThread]: Command `cli build` failed at 07:14:41.704776 after 2.27 seconds
[0m07:14:41.710657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9139258d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b116f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1166e0>]}
[0m07:14:41.715753 [debug] [MainThread]: Flushing usage events
[0m07:18:19.298012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8b50>]}


============================== 07:18:19.298918 | e764f6c8-ae61-44ef-b20a-8a94be0ff8e4 ==============================
[0m07:18:19.298918 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:18:19.311630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_6931273a-3f86-45e4-ad97-b143342a469b', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:18:19.449448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e764f6c8-ae61-44ef-b20a-8a94be0ff8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bea83d0>]}
[0m07:18:20.801980 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rv5jzc9b'
[0m07:18:20.813299 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:18:24.906265 [info ] [MainThread]: Installed from version 1.1.1
[0m07:18:24.913134 [info ] [MainThread]: Up to date!
[0m07:18:24.919575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e764f6c8-ae61-44ef-b20a-8a94be0ff8e4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b642d10>]}
[0m07:18:24.923830 [info ] [MainThread]: Installing dbt-labs/codegen
[0m07:18:26.367229 [info ] [MainThread]: Installed from version 0.12.1
[0m07:18:26.374388 [info ] [MainThread]: Up to date!
[0m07:18:26.385337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e764f6c8-ae61-44ef-b20a-8a94be0ff8e4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b9b5a80>]}
[0m07:18:26.389950 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.109048, "process_user_time": 142.58376, "process_kernel_time": 77.600044, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "54808"}
[0m07:18:26.394197 [debug] [MainThread]: Command `cli deps` succeeded at 07:18:26.393904 after 7.11 seconds
[0m07:18:26.398164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b642d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91beabaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8bb0>]}
[0m07:18:26.402209 [debug] [MainThread]: Flushing usage events
[0m07:18:26.772647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b080100>]}


============================== 07:18:26.773524 | d6dfbab3-b747-4217-805d-37f0eb3a0360 ==============================
[0m07:18:26.773524 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:18:26.779374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_6931273a-3f86-45e4-ad97-b143342a469b', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:18:26.895429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6dfbab3-b747-4217-805d-37f0eb3a0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8970>]}
[0m07:18:26.903076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6dfbab3-b747-4217-805d-37f0eb3a0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1d7700>]}
[0m07:18:26.907956 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m07:18:26.957858 [debug] [MainThread]: checksum: c8a08478c64f013ea94a36ff36457b86a0f5e8407d2ce88b5643271bfa7f1b75, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'build'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T07:18:19.186809',
 'interval_end_datetime': '2024-04-01T07:18:19.186809',
 'interval_start_datetime': '2024-03-31T07:18:19.186809',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m07:18:26.988867 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:18:26.996513 [debug] [MainThread]: previous checksum: c8a08478c64f013ea94a36ff36457b86a0f5e8407d2ce88b5643271bfa7f1b75, current checksum: c77cb961484757799289af042604ee118fa46ec1bdd6bc5b98447d1797e20d3f
[0m07:18:27.000694 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:18:27.006211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6dfbab3-b747-4217-805d-37f0eb3a0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b0803a0>]}
[0m07:18:28.947956 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_dim_station (models/staging/stg_dim_station.sql)
  No filter named 'parse_date'.
    line 6
      {% set previous_month_date = execution_date | parse_date('%Y-%m-%d') - timedelta(days=execution_date | parse_date('%d') + 1) %}
[0m07:18:28.954516 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 2.196628, "process_user_time": 144.47652, "process_kernel_time": 77.65088, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "54944", "command_success": false}
[0m07:18:28.958915 [debug] [MainThread]: Command `cli build` failed at 07:18:28.958632 after 2.20 seconds
[0m07:18:28.962679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91af47070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91af459f0>]}
[0m07:18:28.966359 [debug] [MainThread]: Flushing usage events
[0m07:22:39.326331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4e560>]}


============================== 07:22:39.327257 | a2718255-e466-418c-a09a-727745ad7b65 ==============================
[0m07:22:39.327257 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:22:39.332642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_8335f436-f1d2-4abc-bc2e-7430ebd68698', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:22:39.438446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2718255-e466-418c-a09a-727745ad7b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1d7f40>]}
[0m07:22:40.676994 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rv5jzc9b'
[0m07:22:40.691300 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:22:44.950434 [info ] [MainThread]: Installed from version 1.1.1
[0m07:22:44.956060 [info ] [MainThread]: Up to date!
[0m07:22:44.961931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a2718255-e466-418c-a09a-727745ad7b65', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4dff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4e470>]}
[0m07:22:44.965921 [info ] [MainThread]: Installing dbt-labs/codegen
[0m07:22:46.563419 [info ] [MainThread]: Installed from version 0.12.1
[0m07:22:46.569360 [info ] [MainThread]: Up to date!
[0m07:22:46.577286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a2718255-e466-418c-a09a-727745ad7b65', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4d840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4df00>]}
[0m07:22:46.583191 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.2733436, "process_user_time": 145.48067, "process_kernel_time": 78.75324, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "57784"}
[0m07:22:46.587666 [debug] [MainThread]: Command `cli deps` succeeded at 07:22:46.587302 after 7.28 seconds
[0m07:22:46.592143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4db70>]}
[0m07:22:46.596174 [debug] [MainThread]: Flushing usage events
[0m07:22:46.959799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4ec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4eb90>]}


============================== 07:22:46.960714 | 77a14632-5d14-48fd-814b-adfd9111840a ==============================
[0m07:22:46.960714 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:22:46.966507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_8335f436-f1d2-4abc-bc2e-7430ebd68698', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:22:47.098092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77a14632-5d14-48fd-814b-adfd9111840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4eaa0>]}
[0m07:22:47.104951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77a14632-5d14-48fd-814b-adfd9111840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4e560>]}
[0m07:22:47.109399 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m07:22:47.158906 [debug] [MainThread]: checksum: 7d65d887a117d7b647cb6ffd6153e688c13abfd20260a895fd3c5cce9d60ddc7, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'build'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T07:22:39.222416',
 'interval_end_datetime': '2024-04-01T07:22:39.222416',
 'interval_start_datetime': '2024-03-31T07:22:39.222416',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m07:22:47.205825 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:22:47.215280 [debug] [MainThread]: previous checksum: 7d65d887a117d7b647cb6ffd6153e688c13abfd20260a895fd3c5cce9d60ddc7, current checksum: c77cb961484757799289af042604ee118fa46ec1bdd6bc5b98447d1797e20d3f
[0m07:22:47.219936 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:22:47.225487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77a14632-5d14-48fd-814b-adfd9111840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4dde0>]}
[0m07:22:49.803592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77a14632-5d14-48fd-814b-adfd9111840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac03cd0>]}
[0m07:22:49.875776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77a14632-5d14-48fd-814b-adfd9111840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae4ec20>]}
[0m07:22:49.880405 [info ] [MainThread]: Found 3 models, 4 tests, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m07:22:49.888657 [info ] [MainThread]: 
[0m07:22:49.895649 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:22:49.901547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m07:22:49.905564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:50.462909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m07:22:50.467315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:22:50.826554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77a14632-5d14-48fd-814b-adfd9111840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac01630>]}
[0m07:22:50.831506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:22:50.836814 [info ] [MainThread]: 
[0m07:22:50.844017 [debug] [Thread-41 ]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m07:22:50.844797 [debug] [Thread-42 ]: Began running node model.nyc_citi_bikes.stg_rides
[0m07:22:50.848196 [info ] [Thread-41 ]: 1 of 7 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m07:22:50.852293 [info ] [Thread-42 ]: 2 of 7 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m07:22:50.857353 [debug] [Thread-41 ]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m07:22:50.860877 [debug] [Thread-42 ]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m07:22:50.862750 [debug] [Thread-41 ]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m07:22:50.866441 [debug] [Thread-42 ]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m07:22:50.876205 [debug] [Thread-41 ]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m07:22:50.886908 [debug] [Thread-42 ]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m07:22:50.901434 [debug] [Thread-41 ]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 07:22:50.870235 => 07:22:50.900904
[0m07:22:50.903169 [debug] [Thread-42 ]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 07:22:50.879037 => 07:22:50.902710
[0m07:22:50.904897 [debug] [Thread-41 ]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m07:22:50.908254 [debug] [Thread-42 ]: Began executing node model.nyc_citi_bikes.stg_rides
[0m07:22:50.916926 [debug] [Thread-41 ]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m07:22:50.930137 [debug] [Thread-42 ]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m07:22:50.942647 [debug] [Thread-41 ]: Opening a new connection, currently in state closed
[0m07:22:50.944204 [debug] [Thread-42 ]: Opening a new connection, currently in state init
[0m07:22:50.996414 [debug] [Thread-41 ]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 






with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`)


select 
cast(station_id as string) as station_id, 
cast(station_name as string) as station_name,
cast(date_part as date) as date_part

from stations;


[0m07:22:51.001897 [debug] [Thread-42 ]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m07:22:51.406167 [debug] [Thread-41 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:73f65aba-0662-40bc-b0f5-a8600f1e19de&page=queryresults
[0m07:22:51.410796 [debug] [Thread-41 ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword SELECT at [20:1]')
[0m07:22:51.413378 [debug] [Thread-42 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:4f64c499-c718-45e2-a424-de96d03b3980&page=queryresults
[0m07:22:51.418299 [debug] [Thread-42 ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword SELECT at [16:1]')
[0m07:22:51.664918 [debug] [Thread-41 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:eae65dd5-5aa5-480b-9a76-ec2d7f2ccc57&page=queryresults
[0m07:22:51.670620 [error] [Thread-41 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:eae65dd5-5aa5-480b-9a76-ec2d7f2ccc57&page=queryresults
[0m07:22:51.676503 [debug] [Thread-41 ]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 07:22:50.911886 => 07:22:51.676021
[0m07:22:51.685090 [debug] [Thread-41 ]: Database Error in model stg_dim_station (models/staging/stg_dim_station.sql)
  Syntax error: Expected ")" but got keyword SELECT at [20:1]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_dim_station.sql
[0m07:22:51.689607 [debug] [Thread-41 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77a14632-5d14-48fd-814b-adfd9111840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ade0850>]}
[0m07:22:51.693864 [error] [Thread-41 ]: 1 of 7 ERROR creating sql view model nyc_citi_bike_rides.stg_dim_station ....... [[31mERROR[0m in 0.83s]
[0m07:22:51.699130 [debug] [Thread-41 ]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m07:22:51.703280 [debug] [Thread-44 ]: Began running node test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a
[0m07:22:51.704052 [debug] [Thread-43 ]: Began running node test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421
[0m07:22:51.706880 [info ] [Thread-44 ]: 3 of 7 SKIP test not_null_stg_dim_station_station_id ........................... [[33mSKIP[0m]
[0m07:22:51.711490 [info ] [Thread-43 ]: 4 of 7 SKIP test unique_stg_dim_station_station_id ............................. [[33mSKIP[0m]
[0m07:22:51.717672 [debug] [Thread-44 ]: Finished running node test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a
[0m07:22:51.721050 [debug] [Thread-43 ]: Finished running node test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421
[0m07:22:52.149729 [debug] [Thread-42 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:08f167fe-0eae-413a-982f-a3bb8aaac682&page=queryresults
[0m07:22:52.154606 [error] [Thread-42 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:08f167fe-0eae-413a-982f-a3bb8aaac682&page=queryresults
[0m07:22:52.161406 [debug] [Thread-42 ]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 07:22:50.920498 => 07:22:52.160929
[0m07:22:52.167689 [debug] [Thread-42 ]: Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected ")" but got keyword SELECT at [16:1]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m07:22:52.172508 [debug] [Thread-42 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77a14632-5d14-48fd-814b-adfd9111840a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91add9d20>]}
[0m07:22:52.176905 [error] [Thread-42 ]: 2 of 7 ERROR creating sql view model nyc_citi_bike_rides.stg_rides ............. [[31mERROR[0m in 1.31s]
[0m07:22:52.183617 [debug] [Thread-42 ]: Finished running node model.nyc_citi_bikes.stg_rides
[0m07:22:52.188512 [debug] [Thread-41 ]: Began running node test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04
[0m07:22:52.189271 [debug] [Thread-44 ]: Began running node test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4
[0m07:22:52.192628 [info ] [Thread-41 ]: 5 of 7 SKIP test not_null_stg_rides_ride_id .................................... [[33mSKIP[0m]
[0m07:22:52.196566 [info ] [Thread-44 ]: 6 of 7 SKIP test unique_stg_rides_ride_id ...................................... [[33mSKIP[0m]
[0m07:22:52.201778 [debug] [Thread-41 ]: Finished running node test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04
[0m07:22:52.204854 [debug] [Thread-44 ]: Finished running node test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4
[0m07:22:52.211063 [debug] [Thread-42 ]: Began running node model.nyc_citi_bikes.fact_rides
[0m07:22:52.215247 [info ] [Thread-42 ]: 7 of 7 SKIP relation nyc_citi_bike_rides.fact_rides ............................ [[33mSKIP[0m]
[0m07:22:52.220709 [debug] [Thread-42 ]: Finished running node model.nyc_citi_bikes.fact_rides
[0m07:22:52.226881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:52.231042 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_dim_station' was properly closed.
[0m07:22:52.235108 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.stg_rides' was properly closed.
[0m07:22:52.238852 [info ] [MainThread]: 
[0m07:22:52.244521 [info ] [MainThread]: Finished running 2 view models, 4 tests, 1 table model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m07:22:52.250784 [debug] [MainThread]: Command end result
[0m07:22:52.316814 [info ] [MainThread]: 
[0m07:22:52.322544 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:22:52.328228 [info ] [MainThread]: 
[0m07:22:52.333568 [error] [MainThread]:   Database Error in model stg_dim_station (models/staging/stg_dim_station.sql)
  Syntax error: Expected ")" but got keyword SELECT at [20:1]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_dim_station.sql
[0m07:22:52.338783 [info ] [MainThread]: 
[0m07:22:52.344382 [error] [MainThread]:   Database Error in model stg_rides (models/staging/stg_rides.sql)
  Syntax error: Expected ")" but got keyword SELECT at [16:1]
  compiled Code at target/run/nyc_citi_bikes/models/staging/stg_rides.sql
[0m07:22:52.349389 [info ] [MainThread]: 
[0m07:22:52.354741 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=5 TOTAL=7
[0m07:22:52.360294 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 5.414344, "process_user_time": 148.96234, "process_kernel_time": 78.86094, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "62336", "command_success": false}
[0m07:22:52.364228 [debug] [MainThread]: Command `cli build` failed at 07:22:52.363911 after 5.42 seconds
[0m07:22:52.367862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b1e8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae88760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae89660>]}
[0m07:22:52.371901 [debug] [MainThread]: Flushing usage events
[0m07:24:18.023355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac41810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac41510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac41690>]}


============================== 07:24:18.024543 | 28711d52-3b65-4d42-8c25-15d672c65b88 ==============================
[0m07:24:18.024543 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:24:18.031260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_2d03b13d-3e14-4128-abec-aa6932f6457c', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:24:18.182822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28711d52-3b65-4d42-8c25-15d672c65b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac42440>]}
[0m07:24:19.423994 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rv5jzc9b'
[0m07:24:19.434723 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:24:23.495004 [info ] [MainThread]: Installed from version 1.1.1
[0m07:24:23.501167 [info ] [MainThread]: Up to date!
[0m07:24:23.508985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '28711d52-3b65-4d42-8c25-15d672c65b88', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae70220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac40d60>]}
[0m07:24:23.513745 [info ] [MainThread]: Installing dbt-labs/codegen
[0m07:24:25.072698 [info ] [MainThread]: Installed from version 0.12.1
[0m07:24:25.079418 [info ] [MainThread]: Up to date!
[0m07:24:25.086536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '28711d52-3b65-4d42-8c25-15d672c65b88', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae70130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac435e0>]}
[0m07:24:25.093151 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.0965915, "process_user_time": 149.86226, "process_kernel_time": 79.40622, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "65176"}
[0m07:24:25.097708 [debug] [MainThread]: Command `cli deps` succeeded at 07:24:25.097338 after 7.10 seconds
[0m07:24:25.101707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae70160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ae705e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac405e0>]}
[0m07:24:25.106001 [debug] [MainThread]: Flushing usage events
[0m07:24:25.444807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac41c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac42380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac436a0>]}


============================== 07:24:25.445730 | cf7fcd74-aefc-4e68-acd1-82639a0cc653 ==============================
[0m07:24:25.445730 [info ] [MainThread]: Running with dbt=1.7.4
[0m07:24:25.451485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/src/default_repo/.profiles_interpolated_temp_2d03b13d-3e14-4128-abec-aa6932f6457c', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/src/default_repo/dbt/dbt_citi_bikes/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt -f /tmp/tmpa5zji3_6.json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:24:25.559346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf7fcd74-aefc-4e68-acd1-82639a0cc653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac40c70>]}
[0m07:24:25.566329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf7fcd74-aefc-4e68-acd1-82639a0cc653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac405b0>]}
[0m07:24:25.570869 [info ] [MainThread]: Registered adapter: bigquery=1.7.2
[0m07:24:25.624247 [debug] [MainThread]: checksum: 9bae961a97b267244e71531db4147c30c3d99313955ece4a59f614be849b8a0d, vars: {'block_uuid': 'transform_data',
 'configuration': {'data_provider': 'bigquery',
                   'data_provider_profile': 'default',
                   'dbt': {'command': 'build'},
                   'dbt_profile_target': '',
                   'dbt_project_name': 'dbt/dbt_citi_bikes',
                   'disable_query_preprocessing': False,
                   'export_write_policy': 'append',
                   'file_source': {'path': 'dbts/transform_data.yaml'},
                   'use_raw_sql': False},
 'context': {},
 'env': 'dev',
 'event': {},
 'execution_date': '2024-03-31T07:24:17.900876',
 'interval_end_datetime': '2024-04-01T07:24:17.900876',
 'interval_start_datetime': '2024-03-31T07:24:17.900876',
 'pipeline_uuid': 'citi_bike_ride'}, profile: , target: , version: 1.7.4
[0m07:24:25.655255 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:24:25.661606 [debug] [MainThread]: previous checksum: 9bae961a97b267244e71531db4147c30c3d99313955ece4a59f614be849b8a0d, current checksum: 7d65d887a117d7b647cb6ffd6153e688c13abfd20260a895fd3c5cce9d60ddc7
[0m07:24:25.665319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf7fcd74-aefc-4e68-acd1-82639a0cc653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac40c10>]}
[0m07:24:27.834227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf7fcd74-aefc-4e68-acd1-82639a0cc653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bb1dd20>]}
[0m07:24:27.930529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf7fcd74-aefc-4e68-acd1-82639a0cc653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91ac43370>]}
[0m07:24:27.934231 [info ] [MainThread]: Found 3 models, 4 tests, 4 sources, 0 exposures, 0 metrics, 585 macros, 0 groups, 0 semantic models
[0m07:24:27.941276 [info ] [MainThread]: 
[0m07:24:27.948053 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:24:27.953778 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_virtual-aileron-412616'
[0m07:24:27.958044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:28.465835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616, now list_virtual-aileron-412616_nyc_citi_bike_rides)
[0m07:24:28.470929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:24:28.839846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf7fcd74-aefc-4e68-acd1-82639a0cc653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bb1f730>]}
[0m07:24:28.845469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:24:28.851409 [info ] [MainThread]: 
[0m07:24:28.859968 [debug] [Thread-49 ]: Began running node model.nyc_citi_bikes.stg_dim_station
[0m07:24:28.860840 [debug] [Thread-50 ]: Began running node model.nyc_citi_bikes.stg_rides
[0m07:24:28.864664 [info ] [Thread-49 ]: 1 of 7 START sql view model nyc_citi_bike_rides.stg_dim_station ................ [RUN]
[0m07:24:28.870788 [info ] [Thread-50 ]: 2 of 7 START sql view model nyc_citi_bike_rides.stg_rides ...................... [RUN]
[0m07:24:28.882750 [debug] [Thread-49 ]: Re-using an available connection from the pool (formerly list_virtual-aileron-412616_nyc_citi_bike_rides, now model.nyc_citi_bikes.stg_dim_station)
[0m07:24:28.886294 [debug] [Thread-50 ]: Acquiring new bigquery connection 'model.nyc_citi_bikes.stg_rides'
[0m07:24:28.888392 [debug] [Thread-49 ]: Began compiling node model.nyc_citi_bikes.stg_dim_station
[0m07:24:28.893210 [debug] [Thread-50 ]: Began compiling node model.nyc_citi_bikes.stg_rides
[0m07:24:28.903820 [debug] [Thread-49 ]: Writing injected SQL for node "model.nyc_citi_bikes.stg_dim_station"
[0m07:24:28.916452 [debug] [Thread-50 ]: Writing injected SQL for node "model.nyc_citi_bikes.stg_rides"
[0m07:24:28.927196 [debug] [Thread-49 ]: Timing info for model.nyc_citi_bikes.stg_dim_station (compile): 07:24:28.897568 => 07:24:28.926585
[0m07:24:28.928506 [debug] [Thread-50 ]: Timing info for model.nyc_citi_bikes.stg_rides (compile): 07:24:28.906542 => 07:24:28.927942
[0m07:24:28.931131 [debug] [Thread-49 ]: Began executing node model.nyc_citi_bikes.stg_dim_station
[0m07:24:28.935106 [debug] [Thread-50 ]: Began executing node model.nyc_citi_bikes.stg_rides
[0m07:24:28.944566 [debug] [Thread-49 ]: Writing runtime sql for node "model.nyc_citi_bikes.stg_dim_station"
[0m07:24:28.957736 [debug] [Thread-50 ]: Writing runtime sql for node "model.nyc_citi_bikes.stg_rides"
[0m07:24:28.965894 [debug] [Thread-49 ]: Opening a new connection, currently in state closed
[0m07:24:28.970317 [debug] [Thread-50 ]: Opening a new connection, currently in state init
[0m07:24:29.049701 [debug] [Thread-49 ]: On model.nyc_citi_bikes.stg_dim_station: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_dim_station"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  OPTIONS()
  as 






with stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`dim_station`
    where station_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`)
)


select 
cast(station_id as string) as station_id, 
cast(station_name as string) as station_name,
cast(date_part as date) as date_part

from stations;


[0m07:24:29.052396 [debug] [Thread-50 ]: On model.nyc_citi_bikes.stg_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.stg_rides"} */


  create or replace view `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  OPTIONS()
  as 

with bike_rides as 
(
    select *,
    row_number() over(partition by ride_id, started_at) as id
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`
    where ride_id is not null and date_part = (SELECT MAX(date_part) FROM `virtual-aileron-412616`.`nyc_citi_bike_rides`.`rides`)
)

select
  
    safe_cast(ride_id as string)
 as ride_id,
  cast(rideable_type_id as integer) as rideable_type_id,
  case 
    safe_cast(rideable_type_id as INT64)
  
        when 0 then 'Classic' 
        when 1 then 'Electric'
        else 'EMPTY'
    end as ride_type,
  cast(start_station_id as string) as start_station_id,
  cast(end_station_id as string) as end_station_id,
  cast(started_at as timestamp) as started_at,
  cast(ended_at as timestamp) as ended_at,
  cast(member_casual_id as integer) as member_casual_id,
  cast(date_part as date) as date_part,
  case 
    safe_cast(member_casual_id as INT64)
  
        when 0 then 'Member'
        when 1 then 'Casual'
        else 'EMPTY'
    end as member_type
  


from bike_rides

where id = 1;


[0m07:24:29.614070 [debug] [Thread-49 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:776f2f64-1f7e-4af3-b3ac-574b1256063e&page=queryresults
[0m07:24:29.746703 [debug] [Thread-50 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:7563625f-5bbb-4ba9-aac2-f9503d0af57d&page=queryresults
[0m07:24:29.921646 [debug] [Thread-49 ]: Timing info for model.nyc_citi_bikes.stg_dim_station (execute): 07:24:28.938864 => 07:24:29.921149
[0m07:24:29.927856 [debug] [Thread-49 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf7fcd74-aefc-4e68-acd1-82639a0cc653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9133e7bb0>]}
[0m07:24:29.933223 [info ] [Thread-49 ]: 1 of 7 OK created sql view model nyc_citi_bike_rides.stg_dim_station ........... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m07:24:29.941891 [debug] [Thread-49 ]: Finished running node model.nyc_citi_bikes.stg_dim_station
[0m07:24:29.947183 [debug] [Thread-52 ]: Began running node test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a
[0m07:24:29.948083 [debug] [Thread-51 ]: Began running node test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421
[0m07:24:29.951827 [info ] [Thread-52 ]: 3 of 7 START test not_null_stg_dim_station_station_id .......................... [RUN]
[0m07:24:29.956474 [info ] [Thread-51 ]: 4 of 7 START test unique_stg_dim_station_station_id ............................ [RUN]
[0m07:24:29.962557 [debug] [Thread-52 ]: Acquiring new bigquery connection 'test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a'
[0m07:24:29.966103 [debug] [Thread-51 ]: Acquiring new bigquery connection 'test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421'
[0m07:24:29.968391 [debug] [Thread-52 ]: Began compiling node test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a
[0m07:24:29.972759 [debug] [Thread-51 ]: Began compiling node test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421
[0m07:24:30.003973 [debug] [Thread-52 ]: Writing injected SQL for node "test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a"
[0m07:24:30.013973 [debug] [Thread-51 ]: Writing injected SQL for node "test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421"
[0m07:24:30.030700 [debug] [Thread-52 ]: Timing info for test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a (compile): 07:24:29.977254 => 07:24:30.030114
[0m07:24:30.033986 [debug] [Thread-51 ]: Timing info for test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421 (compile): 07:24:29.996760 => 07:24:30.033427
[0m07:24:30.035043 [debug] [Thread-52 ]: Began executing node test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a
[0m07:24:30.040665 [debug] [Thread-51 ]: Began executing node test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421
[0m07:24:30.085618 [debug] [Thread-52 ]: Writing runtime sql for node "test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a"
[0m07:24:30.094657 [debug] [Thread-51 ]: Writing runtime sql for node "test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421"
[0m07:24:30.100363 [debug] [Thread-50 ]: Timing info for model.nyc_citi_bikes.stg_rides (execute): 07:24:28.947326 => 07:24:30.099887
[0m07:24:30.106535 [debug] [Thread-50 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf7fcd74-aefc-4e68-acd1-82639a0cc653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bb1fc70>]}
[0m07:24:30.113190 [debug] [Thread-52 ]: Opening a new connection, currently in state init
[0m07:24:30.111347 [info ] [Thread-50 ]: 2 of 7 OK created sql view model nyc_citi_bike_rides.stg_rides ................. [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m07:24:30.116460 [debug] [Thread-51 ]: Opening a new connection, currently in state init
[0m07:24:30.122696 [debug] [Thread-50 ]: Finished running node model.nyc_citi_bikes.stg_rides
[0m07:24:30.133275 [debug] [Thread-49 ]: Began running node test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04
[0m07:24:30.134296 [debug] [Thread-50 ]: Began running node test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4
[0m07:24:30.138882 [info ] [Thread-49 ]: 5 of 7 START test not_null_stg_rides_ride_id ................................... [RUN]
[0m07:24:30.144538 [info ] [Thread-50 ]: 6 of 7 START test unique_stg_rides_ride_id ..................................... [RUN]
[0m07:24:30.150533 [debug] [Thread-49 ]: Re-using an available connection from the pool (formerly model.nyc_citi_bikes.stg_dim_station, now test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04)
[0m07:24:30.157109 [debug] [Thread-50 ]: Re-using an available connection from the pool (formerly model.nyc_citi_bikes.stg_rides, now test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4)
[0m07:24:30.159362 [debug] [Thread-49 ]: Began compiling node test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04
[0m07:24:30.163606 [debug] [Thread-50 ]: Began compiling node test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4
[0m07:24:30.185528 [debug] [Thread-49 ]: Writing injected SQL for node "test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04"
[0m07:24:30.193995 [debug] [Thread-50 ]: Writing injected SQL for node "test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4"
[0m07:24:30.195385 [debug] [Thread-52 ]: On test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select station_id
from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
where station_id is null



      
    ) dbt_internal_test
[0m07:24:30.205831 [debug] [Thread-49 ]: Timing info for test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04 (compile): 07:24:30.167618 => 07:24:30.205255
[0m07:24:30.207316 [debug] [Thread-51 ]: On test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select station_id as unique_field
  from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
  where station_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:24:30.210801 [debug] [Thread-50 ]: Timing info for test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4 (compile): 07:24:30.186417 => 07:24:30.208910
[0m07:24:30.212765 [debug] [Thread-49 ]: Began executing node test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04
[0m07:24:30.222057 [debug] [Thread-50 ]: Began executing node test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4
[0m07:24:30.230318 [debug] [Thread-49 ]: Writing runtime sql for node "test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04"
[0m07:24:30.238315 [debug] [Thread-50 ]: Writing runtime sql for node "test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4"
[0m07:24:30.250526 [debug] [Thread-49 ]: Opening a new connection, currently in state closed
[0m07:24:30.252940 [debug] [Thread-50 ]: Opening a new connection, currently in state closed
[0m07:24:30.321445 [debug] [Thread-50 ]: On test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select ride_id as unique_field
  from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
  where ride_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:24:30.330931 [debug] [Thread-49 ]: On test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ride_id
from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
where ride_id is null



      
    ) dbt_internal_test
[0m07:24:31.101887 [debug] [Thread-52 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:a4d85e74-aba1-472e-8eaf-457f4ea1dbe7&page=queryresults
[0m07:24:31.408419 [debug] [Thread-51 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:2758116b-ab1d-4f14-93bf-6e1ce532645b&page=queryresults
[0m07:24:31.578005 [debug] [Thread-49 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:46c953bb-2f6c-4984-8556-8ec85f85a0a7&page=queryresults
[0m07:24:31.656276 [debug] [Thread-52 ]: Timing info for test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a (execute): 07:24:30.044695 => 07:24:31.655726
[0m07:24:31.661714 [info ] [Thread-52 ]: 3 of 7 PASS not_null_stg_dim_station_station_id ................................ [[32mPASS[0m in 1.70s]
[0m07:24:31.668004 [debug] [Thread-52 ]: Finished running node test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a
[0m07:24:31.966776 [debug] [Thread-51 ]: Timing info for test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421 (execute): 07:24:30.058359 => 07:24:31.966274
[0m07:24:31.972126 [info ] [Thread-51 ]: 4 of 7 PASS unique_stg_dim_station_station_id .................................. [[32mPASS[0m in 2.01s]
[0m07:24:31.978372 [debug] [Thread-51 ]: Finished running node test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421
[0m07:24:32.141702 [debug] [Thread-49 ]: Timing info for test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04 (execute): 07:24:30.225630 => 07:24:32.141216
[0m07:24:32.147019 [info ] [Thread-49 ]: 5 of 7 PASS not_null_stg_rides_ride_id ......................................... [[32mPASS[0m in 2.00s]
[0m07:24:32.153334 [debug] [Thread-49 ]: Finished running node test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04
[0m07:24:32.189954 [debug] [Thread-50 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:afd10527-9505-4302-b339-c438b37c79bb&page=queryresults
[0m07:24:33.651438 [debug] [Thread-50 ]: Timing info for test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4 (execute): 07:24:30.234070 => 07:24:33.650962
[0m07:24:33.657237 [info ] [Thread-50 ]: 6 of 7 PASS unique_stg_rides_ride_id ........................................... [[32mPASS[0m in 3.50s]
[0m07:24:33.663251 [debug] [Thread-50 ]: Finished running node test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4
[0m07:24:33.668156 [debug] [Thread-52 ]: Began running node model.nyc_citi_bikes.fact_rides
[0m07:24:33.672467 [info ] [Thread-52 ]: 7 of 7 START sql table model nyc_citi_bike_rides.fact_rides .................... [RUN]
[0m07:24:33.679330 [debug] [Thread-52 ]: Re-using an available connection from the pool (formerly test.nyc_citi_bikes.not_null_stg_dim_station_station_id.a4534d8e6a, now model.nyc_citi_bikes.fact_rides)
[0m07:24:33.683764 [debug] [Thread-52 ]: Began compiling node model.nyc_citi_bikes.fact_rides
[0m07:24:33.699221 [debug] [Thread-52 ]: Writing injected SQL for node "model.nyc_citi_bikes.fact_rides"
[0m07:24:33.711564 [debug] [Thread-52 ]: Timing info for model.nyc_citi_bikes.fact_rides (compile): 07:24:33.687347 => 07:24:33.710997
[0m07:24:33.715698 [debug] [Thread-52 ]: Began executing node model.nyc_citi_bikes.fact_rides
[0m07:24:33.724371 [debug] [Thread-52 ]: Writing runtime sql for node "model.nyc_citi_bikes.fact_rides"
[0m07:24:33.735567 [debug] [Thread-52 ]: Opening a new connection, currently in state closed
[0m07:24:33.910923 [debug] [Thread-52 ]: On model.nyc_citi_bikes.fact_rides: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "citi_bikes", "target_name": "dev", "node_id": "model.nyc_citi_bikes.fact_rides"} */

  
    

    create or replace table `virtual-aileron-412616`.`nyc_citi_bike_rides`.`fact_rides`
      
    
    

    OPTIONS()
    as (
      


with rides as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_rides`
),

stations as 
(
    select *
    from `virtual-aileron-412616`.`nyc_citi_bike_rides`.`stg_dim_station`
)

select rides.ride_id,
rides.ride_type,
rides.start_station_id,
rides.end_station_id,
rides.started_at,
rides.ended_at,
rides.member_type,
start_station.station_name as start_station_name,
end_station.station_name as end_station_name,

FROM rides 
INNER JOIN stations start_station ON rides.start_station_id = start_station.station_id
INNER JOIN stations end_station ON rides.end_station_id = end_station.station_id
    );
  
[0m07:24:34.552902 [debug] [Thread-52 ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=virtual-aileron-412616&j=bq:US:2ecb4981-3d31-4491-a9d6-5005c14799df&page=queryresults
[0m07:24:42.356653 [debug] [Thread-52 ]: Timing info for model.nyc_citi_bikes.fact_rides (execute): 07:24:33.719185 => 07:24:42.356307
[0m07:24:42.361792 [debug] [Thread-52 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf7fcd74-aefc-4e68-acd1-82639a0cc653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91be9ee90>]}
[0m07:24:42.366481 [info ] [Thread-52 ]: 7 of 7 OK created sql table model nyc_citi_bike_rides.fact_rides ............... [[32mCREATE TABLE (2.2m rows, 157.8 MiB processed)[0m in 8.68s]
[0m07:24:42.372623 [debug] [Thread-52 ]: Finished running node model.nyc_citi_bikes.fact_rides
[0m07:24:42.380246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:42.383931 [debug] [MainThread]: Connection 'test.nyc_citi_bikes.not_null_stg_rides_ride_id.17434acf04' was properly closed.
[0m07:24:42.387724 [debug] [MainThread]: Connection 'test.nyc_citi_bikes.unique_stg_rides_ride_id.ad00947fa4' was properly closed.
[0m07:24:42.391344 [debug] [MainThread]: Connection 'model.nyc_citi_bikes.fact_rides' was properly closed.
[0m07:24:42.395238 [debug] [MainThread]: Connection 'test.nyc_citi_bikes.unique_stg_dim_station_station_id.742317b421' was properly closed.
[0m07:24:42.399084 [info ] [MainThread]: 
[0m07:24:42.404987 [info ] [MainThread]: Finished running 2 view models, 4 tests, 1 table model in 0 hours 0 minutes and 14.45 seconds (14.45s).
[0m07:24:42.413616 [debug] [MainThread]: Command end result
[0m07:24:42.478631 [info ] [MainThread]: 
[0m07:24:42.485185 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:24:42.490782 [info ] [MainThread]: 
[0m07:24:42.495890 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m07:24:42.501432 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 17.071146, "process_user_time": 154.46945, "process_kernel_time": 79.5634, "process_mem_max_rss": "2387952", "process_in_blocks": "128", "process_out_blocks": "70200"}
[0m07:24:42.505412 [debug] [MainThread]: Command `cli build` succeeded at 07:24:42.505112 after 17.08 seconds
[0m07:24:42.509349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91b919240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91bfb90f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc91be9f6a0>]}
[0m07:24:42.513485 [debug] [MainThread]: Flushing usage events
